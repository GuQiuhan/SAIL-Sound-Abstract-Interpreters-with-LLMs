transformer deeppoly{
    HardTanh ->
        ((prev[u]) <= -1) ?
            (-1, -1, -1, -1)
        : (((prev[l]) >= 1) ?
            (1, 1, 1, 1)
        : (
            (max(-1, prev[l]), min(1, prev[u]),
                ((prev[l]) >= -1) ?
                    (((prev[u]) <= 1) ? prev :
                        (prev * ((1 - prev[l]) / (prev[u] - prev[l])) + (prev[u] - 1) * (1 - prev[l]) / (prev[u] - prev[l])))
                :
                    (((prev[u]) <= 1) ?
                        (prev * ((prev[u] + 1) / (prev[u] - prev[l])) - (prev[l] + 1) * (prev[u] + 1) / (prev[u] - prev[l]))
                    :
                        (((prev * ((1 - prev[l]) / (prev[u] - prev[l])) + (prev[u] - 1) * (1 - prev[l]) / (prev[u] - prev[l]))) *
                         ((prev[u] + 1) / (prev[u] - prev[l])) - (prev[l] + 1) * (prev[u] + 1) / (prev[u] - prev[l]))
                    ),
                ((prev[u]) <= 1) ? prev : 1
            )
        )
    );
}
