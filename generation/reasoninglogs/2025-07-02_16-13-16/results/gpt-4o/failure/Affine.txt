transformer deeppoly{
    Affine -> (
        prev.LSQR WEIGHT RSQR.DOT MAPLIST(LAMBDA i. (sum(prev.LSQR VAR i RSQR.DOT MAPLIST(LAMBDA j. simplify_lower(prev.LSQR VAR i RSQR.LSQR VAR j RSQR, WEIGHT.LSQR VAR i RSQR.LSQR VAR j RSQR)))) + BIAS.LSQR VAR i RSQR)),
        prev.LSQR WEIGHT RSQR.DOT MAPLIST(LAMBDA i. (sum(prev.LSQR VAR i RSQR.DOT MAPLIST(LAMBDA j. simplify_upper(prev.LSQR VAR i RSQR.LSQR VAR j RSQR, WEIGHT.LSQR VAR i RSQR.LSQR VAR j RSQR)))) + BIAS.LSQR VAR i RSQR)),
        prev.LSQR WEIGHT RSQR.DOT MAPLIST(LAMBDA i. (sum(prev.LSQR VAR i RSQR.DOT MAPLIST(LAMBDA j. replace_lower(prev.LSQR VAR i RSQR.LSQR VAR j RSQR, WEIGHT.LSQR VAR i RSQR.LSQR VAR j RSQR)))) + BIAS.LSQR VAR i RSQR)),
        prev.LSQR WEIGHT RSQR.DOT MAPLIST(LAMBDA i. (sum(prev.LSQR VAR i RSQR.DOT MAPLIST(LAMBDA j. replace_upper(prev.LSQR VAR i RSQR.LSQR VAR j RSQR, WEIGHT.LSQR VAR i RSQR.LSQR VAR j RSQR)))) + BIAS.LSQR VAR i RSQR))
    );
}
