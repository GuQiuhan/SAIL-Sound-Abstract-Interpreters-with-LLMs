transformer deeppoly{
    HardTanh -> ((prev[u] <= -1)) ? (-1, -1, -1, -1) : (((prev[l] >= 1)) ? (1, 1, 1, 1) : (((prev[l] >= -1) and (prev[u] <= 1)) ? (prev[l], prev[u], prev, prev) : (((prev[l] < -1) and (prev[u] > -1)) ? (-1, prev[u], -1, ((prev[u] / (prev[u] - prev[l])) * prev) - ((prev[u] * prev[l]) / (prev[u] - prev[l]))) : (((prev[l] < 1) and (prev[u] > 1)) ? (prev[l], 1, ((1-prev[l])/(prev[u]-prev[l]))*(prev-prev[l])+prev[l], 1) : (((prev[l] < -1) and (prev[u] > 1)) ? (-1, 1, -1, 1) : (0, 0, 0, 0)))))
);}
