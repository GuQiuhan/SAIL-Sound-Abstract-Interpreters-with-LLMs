transformer deeppoly{
    HardSwish ->
        ((prev[l] >= 3)
            ? (prev[l], prev[u], prev, prev)
        : ((prev[u] <= -3)
            ? (0, 0, 0, 0)
        : 
            (
                simplify_lower(prev, (prev[l] >= 0) ? ((prev[l] + 3) / 6) : 0),
                simplify_upper(prev, (prev[u] <= 0) ? 0 : ((prev[u] + 3) / 6)),
                prev * max(0, min(1, (prev + 3) / 6)),
                prev * min(1, max(0, (prev + 3) / 6))
            )
        )
        );
}