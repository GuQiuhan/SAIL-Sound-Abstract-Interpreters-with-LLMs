2025-07-02 16:51:47,149 - INFO - 2025-07-02 16:51:47.148969 - Extracting Abs
2025-07-02 16:51:47,149 - INFO -
API: Abs -> Model: gpt-4o @ http://ggnds-serv-01.cs.illinois.edu:8084
2025-07-02 16:51:47,149 - INFO - [STEP 1] Starting step 1/1
2025-07-02 16:51:58,587 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Abs ->
        ((prev[l] >= 0) ?
            (prev[l], prev[u], prev, prev)
        : (prev[u] <= 0) ?
            (0 - prev[u], 0 - prev[l], 0 - prev, 0 - prev)
        :
            (0, max_op(prev[u], 0 - prev[l]), prev * (prev[u] + prev[l]) / (prev[u] - prev[l]) - ((2 * prev[u]) * prev[l]) / (prev[u] - prev[l]), prev * (prev[u] + prev[l]) / (prev[u] - prev[l]) - ((2 * prev[u]) * prev[l]) / (prev[u] - prev[l]))
        );
}

2025-07-02 16:51:58,587 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:51:58,878 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Abs ->
        (prev[l] >= 0) ?
            (prev[l], prev[u], prev, prev)
        :
            (prev[u] <= 0) ?
                (-prev[u], -prev[l], -prev, -prev)
            :
                (0, max_op(prev[u], -prev[l]), prev, prev * ((prev[u] + prev[l]) / (prev[u] - prev[l])) - ((2 * prev[u] * prev[l]) / (prev[u] - prev[l])))
    ;
}

2025-07-02 16:51:58,878 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:51:59,206 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Abs -> ((prev[l] >= 0) ? (prev[l], prev[u], prev, prev)
         : (prev[u] <= 0) ? (-prev[u], -prev[l], -prev, -prev)
         : (0, max_op(prev[u], -prev[l]), prev, ((prev[u])/(prev[u] - prev[l])) * prev - ((prev[u]*prev[l])/(prev[u]-prev[l]))));
}

2025-07-02 16:51:59,206 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:51:59,206 - INFO - [STEP 1] All 3 samples failed validation. Retrying 1/10...
2025-07-02 16:52:09,855 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Abs ->
        (prev[l] >= 0) ?
            (prev[l], prev[u], prev, prev)
        : ((prev[u] <= 0) ?
            ((-prev[u]), (-prev[l]), (-prev), (-prev))
        : (
            0,
            max_op(prev[u], -prev[l]),
            prev,
            ((prev[u])/(prev[u]-prev[l]))*prev - ((prev[u]*prev[l])/(prev[u]-prev[l]))
        )
    );
}

2025-07-02 16:52:09,856 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:52:10,120 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Abs ->
        (prev[l] >= 0) ?
            (prev[l], prev[u], prev, prev)
        :
        (prev[u] <= 0) ?
            (-(prev[u]), -(prev[l]), -(prev), -(prev))
        :
            (0, max_op(prev[u], -(prev[l])), prev * ((prev[u] + prev[l]) / (prev[u] - prev[l])) - ((2 * prev[u] * prev[l]) / (prev[u] - prev[l])), max_op(prev, -prev))
    ;
}

2025-07-02 16:52:10,121 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:52:10,370 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Abs ->
        (prev[l] >= 0)
            ? (prev[l], prev[u], prev, prev)
            : ((prev[u] <= 0)
                ? (0 - prev[u], 0 - prev[l], 0 - prev, 0 - prev)
                : (0,
                   max_op(prev[u], 0 - prev[l]),
                   prev,
                   ((prev[u] / (prev[u] - prev[l])) * prev) - ((prev[u] * prev[l]) / (prev[u] - prev[l]))
                  )
              );
}

2025-07-02 16:52:10,370 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:52:10,370 - INFO - [STEP 1] All 3 samples failed validation. Retrying 2/10...
2025-07-02 16:52:17,654 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Abs -> ((prev[l] >= 0) ? (prev[l], prev[u], prev, prev)
      : ((prev[u] <= 0) ? (-(prev[u]), -(prev[l]), -(prev), -(prev))
      : (0, max_op(prev[u], -prev[l]), prev * ((prev[u] + prev[l]) / (prev[u] - prev[l])) - ((2 * prev[u]) * prev[l]) / (prev[u] - prev[l]), max_op(prev, -prev))));
}

2025-07-02 16:52:17,654 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:52:18,228 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:52:18,485 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Abs -> ((prev[l] >= 0) ? (prev[l], prev[u], prev, prev)
        : ((prev[u] <= 0) ? (0 - prev[u], 0 - prev[l], 0 - prev, 0 - prev)
        : (0, max_op(prev[u], 0 - prev[l]), prev, prev * ((prev[u] + prev[l]) / (prev[u] - prev[l])) - (((2 * prev[u]) * prev[l]) / (prev[u] - prev[l])))));
}

2025-07-02 16:52:18,485 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:52:18,485 - INFO - [STEP 1] All 3 samples failed validation. Retrying 3/10...
2025-07-02 16:52:26,902 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Abs ->
        (prev[l] >= 0) ? (prev[l], prev[u], prev, prev) :
        (prev[u] <= 0) ? (-prev[u], -prev[l], -prev, -prev) :
        (0, max_op(prev[u], -prev[l]), prev,
            (prev[u] + prev[l] == 0) ? (0) :
            (
                prev * (prev[u]) / (prev[u] - prev[l]) - prev * (prev[l]) / (prev[u] - prev[l])
            )
        );
}

2025-07-02 16:52:26,903 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:52:27,471 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:52:28,093 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:52:28,093 - INFO - [STEP 1] All 3 samples failed validation. Retrying 4/10...
2025-07-02 16:52:42,788 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:52:43,031 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Abs -> ((prev[l] >= 0) ?
        (prev[l], prev[u], prev, prev)
        : ((prev[u] <= 0) ?
            (-(prev[u]), -(prev[l]), -(prev), -(prev))
            : (0, max_op(prev[u], -prev[l]), prev*(prev[u]+prev[l])/(prev[u]-prev[l]) - ((2*prev[u]*prev[l])/(prev[u]-prev[l])), max_op(prev, -prev)) )
    );
}

2025-07-02 16:52:43,032 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:52:43,573 - INFO - [STEP 1] Sample 3: Validation passed.
2025-07-02 16:52:43,573 - INFO - [Abs] Runtime: 56.42 seconds
2025-07-02 16:52:43,573 - INFO - Succeed. Saved to logs/2025-07-02_16-51-47/results/gpt-4o/success/Abs.txt

2025-07-02 16:52:43,573 - INFO - 2025-07-02 16:52:43.573833 - Extracting Affine
2025-07-02 16:52:43,573 - INFO -
API: Affine -> Model: gpt-4o @ http://ggnds-serv-01.cs.illinois.edu:8084
2025-07-02 16:52:43,574 - INFO - [STEP 1] Starting step 1/1
2025-07-02 16:52:49,508 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (
        backsubs_lower(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr),
        backsubs_upper(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr),
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS],
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS]
    );
}

2025-07-02 16:52:49,508 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:52:49,733 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (
        backsubs_lower(prev.DOT(curr[WEIGHT]).ADD(curr[BIAS]), curr),
        backsubs_upper(prev.DOT(curr[WEIGHT]).ADD(curr[BIAS]), curr),
        prev.DOT(curr[WEIGHT]).ADD(curr[BIAS]),
        prev.DOT(curr[WEIGHT]).ADD(curr[BIAS])
    );
}

2025-07-02 16:52:49,733 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:52:49,959 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (
        backsubs_lower(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr),
        backsubs_upper(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr),
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS],
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS]
    );
}

2025-07-02 16:52:49,960 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:52:49,960 - INFO - [STEP 1] All 3 samples failed validation. Retrying 1/10...
2025-07-02 16:52:56,911 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (
        backsubs_lower(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr),
        backsubs_upper(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr),
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS],
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS]
    );
}

2025-07-02 16:52:56,911 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:52:57,135 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (backsubs_lower(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr),
               backsubs_upper(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr),
               prev DOT DOTT(curr[WEIGHT]) + curr[BIAS],
               prev DOT DOTT(curr[WEIGHT]) + curr[BIAS]);
}

2025-07-02 16:52:57,138 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:52:57,423 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 682, in visitFuncCall
    exprstype = self.visit(node.arglist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 249, in visitBinOp
    ltype = self.visit(node.left)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 57, in visit
    return self.visitDot(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 638, in visitDot
    tright = self.visit(node.right)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 47, in visit
    return self.visitGetElement(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 474, in visitGetElement
    raise UndefinedVarException(node.elem.name + " is undefined")
constraintflow.core.astTC.UndefinedVarException: WEIGHT is undefined

Code:
transformer deeppoly{
    Affine -> (backsubs_lower(prev.dot(curr[WEIGHT]) + curr[BIAS], curr), backsubs_upper(prev.dot(curr[WEIGHT]) + curr[BIAS], curr), prev.dot(curr[WEIGHT]) + curr[BIAS], prev.dot(curr[WEIGHT]) + curr[BIAS]);
}

2025-07-02 16:52:57,423 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:52:57,423 - INFO - [STEP 1] All 3 samples failed validation. Retrying 2/10...
2025-07-02 16:53:04,714 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 53, in visit
    return self.visitMap(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 590, in visitMap
    exptype = self.visit(node.expr)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 249, in visitBinOp
    ltype = self.visit(node.left)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 57, in visit
    return self.visitDot(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 638, in visitDot
    tright = self.visit(node.right)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 47, in visit
    return self.visitGetElement(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 474, in visitGetElement
    raise UndefinedVarException(node.elem.name + " is undefined")
constraintflow.core.astTC.UndefinedVarException: WEIGHT is undefined

Code:
transformer deeppoly{
    Affine -> (
        (prev.dot(curr[WEIGHT]) + curr[BIAS]).map(simplify_lower),
        (prev.dot(curr[WEIGHT]) + curr[BIAS]).map(simplify_upper),
        prev.dot(curr[WEIGHT]) + curr[BIAS],
        prev.dot(curr[WEIGHT]) + curr[BIAS]
    );
}

2025-07-02 16:53:04,715 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:53:04,944 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (
        backsubs_lower(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr),
        backsubs_upper(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr),
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS],
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS]
    );
}

2025-07-02 16:53:04,944 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:53:05,177 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (backsubs_lower(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr), backsubs_upper(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr), prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], prev DOT DOTT(curr[WEIGHT]) + curr[BIAS]);
}

2025-07-02 16:53:05,178 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:53:05,178 - INFO - [STEP 1] All 3 samples failed validation. Retrying 3/10...
2025-07-02 16:53:13,013 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (backsubs_lower(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr), backsubs_upper(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr), prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], prev DOT DOTT(curr[WEIGHT]) + curr[BIAS]);
}

2025-07-02 16:53:13,014 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:53:13,313 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (backsubs_lower(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr),
               backsubs_upper(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr),
               prev DOT DOTT(curr[WEIGHT]) + curr[BIAS],
               prev DOT DOTT(curr[WEIGHT]) + curr[BIAS]);
}

2025-07-02 16:53:13,314 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:53:13,542 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS],
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS],
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS],
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS]
    );
}

2025-07-02 16:53:13,543 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:53:13,543 - INFO - [STEP 1] All 3 samples failed validation. Retrying 4/10...
2025-07-02 16:53:20,727 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (
        backsubs_lower((prev DOT DOTT(curr[WEIGHT])) + curr[BIAS], curr),
        backsubs_upper((prev DOT DOTT(curr[WEIGHT])) + curr[BIAS], curr),
        (prev DOT DOTT(curr[WEIGHT])) + curr[BIAS],
        (prev DOT DOTT(curr[WEIGHT])) + curr[BIAS]
    );
}

2025-07-02 16:53:20,727 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:53:20,958 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine ->
        (
            backsubs_lower(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr),
            backsubs_upper(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr),
            prev DOT DOTT(curr[WEIGHT]) + curr[BIAS],
            prev DOT DOTT(curr[WEIGHT]) + curr[BIAS]
        );
}

2025-07-02 16:53:20,958 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:53:21,182 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 682, in visitFuncCall
    exprstype = self.visit(node.arglist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 249, in visitBinOp
    ltype = self.visit(node.left)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 57, in visit
    return self.visitDot(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 638, in visitDot
    tright = self.visit(node.right)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 47, in visit
    return self.visitGetElement(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 474, in visitGetElement
    raise UndefinedVarException(node.elem.name + " is undefined")
constraintflow.core.astTC.UndefinedVarException: WEIGHT is undefined

Code:
transformer deeppoly{
    Affine -> (backsubs_lower(prev.dot(curr[WEIGHT]) + curr[BIAS], curr),
               backsubs_upper(prev.dot(curr[WEIGHT]) + curr[BIAS], curr),
               prev.dot(curr[WEIGHT]) + curr[BIAS],
               prev.dot(curr[WEIGHT]) + curr[BIAS]);
}

2025-07-02 16:53:21,183 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:53:21,183 - INFO - [STEP 1] All 3 samples failed validation. Retrying 5/10...
2025-07-02 16:53:27,916 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (
        backsubs_lower(prev.DOT(curr[WEIGHT]) + curr[BIAS], curr),
        backsubs_upper(prev.DOT(curr[WEIGHT]) + curr[BIAS], curr),
        prev.DOT(curr[WEIGHT]) + curr[BIAS],
        prev.DOT(curr[WEIGHT]) + curr[BIAS]
    );
}

2025-07-02 16:53:27,916 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:53:28,138 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (backsubs_lower(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr), backsubs_upper(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr), prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], prev DOT DOTT(curr[WEIGHT]) + curr[BIAS]);
}

2025-07-02 16:53:28,138 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:53:28,361 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (
        backsubs_lower(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr),
        backsubs_upper(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr),
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS],
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS]
    );
}

2025-07-02 16:53:28,361 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:53:28,361 - INFO - [STEP 1] All 3 samples failed validation. Retrying 6/10...
2025-07-02 16:53:42,971 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS],
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS],
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS],
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS]
    );
}

2025-07-02 16:53:42,971 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:53:43,275 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (
        backsubs_lower(prev.DOTT(curr[WEIGHT]) + curr[BIAS], curr),
        backsubs_upper(prev.DOTT(curr[WEIGHT]) + curr[BIAS], curr),
        prev.DOTT(curr[WEIGHT]) + curr[BIAS],
        prev.DOTT(curr[WEIGHT]) + curr[BIAS]
    );
}

2025-07-02 16:53:43,275 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:53:43,500 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (
        backsubs_lower(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr),
        backsubs_upper(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr),
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS],
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS]
    );
}

2025-07-02 16:53:43,500 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:53:43,500 - INFO - [STEP 1] All 3 samples failed validation. Retrying 7/10...
2025-07-02 16:53:52,202 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (backsubs_lower(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr), backsubs_upper(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr), prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], prev DOT DOTT(curr[WEIGHT]) + curr[BIAS]);
}

2025-07-02 16:53:52,202 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:53:52,429 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (
        backsubs_lower(prev.DOT(curr[WEIGHT]) + curr[BIAS], curr),
        backsubs_upper(prev.DOT(curr[WEIGHT]) + curr[BIAS], curr),
        prev.DOT(curr[WEIGHT]) + curr[BIAS],
        prev.DOT(curr[WEIGHT]) + curr[BIAS]
    );
}

2025-07-02 16:53:52,429 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:53:52,660 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (backsubs_lower(prev DOT DOT(curr[WEIGHT]) + curr[BIAS], curr), backsubs_upper(prev DOT DOT(curr[WEIGHT]) + curr[BIAS], curr), prev DOT DOT(curr[WEIGHT]) + curr[BIAS], prev DOT DOT(curr[WEIGHT]) + curr[BIAS]);
}

2025-07-02 16:53:52,660 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:53:52,660 - INFO - [STEP 1] All 3 samples failed validation. Retrying 8/10...
2025-07-02 16:54:02,788 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (
        backsubs_lower(prev.DOT(curr[WEIGHT]) + curr[BIAS], curr),
        backsubs_upper(prev.DOT(curr[WEIGHT]) + curr[BIAS], curr),
        prev.DOT(curr[WEIGHT]) + curr[BIAS],
        prev.DOT(curr[WEIGHT]) + curr[BIAS]
    );
}

2025-07-02 16:54:02,788 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:54:03,023 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (backsubs_lower(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr), backsubs_upper(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr), prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], prev DOT DOTT(curr[WEIGHT]) + curr[BIAS]);
}

2025-07-02 16:54:03,024 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:54:03,251 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (backsubs_lower(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr), backsubs_upper(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr), prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], prev DOT DOTT(curr[WEIGHT]) + curr[BIAS]);
}

2025-07-02 16:54:03,251 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:54:03,252 - INFO - [STEP 1] All 3 samples failed validation. Retrying 9/10...
2025-07-02 16:54:11,241 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (
        backsubs_lower(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr),
        backsubs_upper(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr),
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS],
        prev DOT DOTT(curr[WEIGHT]) + curr[BIAS]
    );
}

2025-07-02 16:54:11,241 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:54:11,585 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (
        prev.dot[curr WEIGHT].map(simplify_lower) + curr[BIAS],
        prev.dot[curr WEIGHT].map(simplify_upper) + curr[BIAS],
        prev.dot[curr WEIGHT] + curr[BIAS],
        prev.dot[curr WEIGHT] + curr[BIAS]
    );
}

2025-07-02 16:54:11,586 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:54:11,819 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Affine -> (backsubs_lower(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr), backsubs_upper(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr), prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], prev DOT DOTT(curr[WEIGHT]) + curr[BIAS]);
}

2025-07-02 16:54:11,820 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:54:11,820 - INFO - [STEP 1] All 3 samples failed validation. Retrying 10/10...
2025-07-02 16:54:11,820 - INFO - [Affine] Runtime: 88.25 seconds
2025-07-02 16:54:11,820 - ERROR - Failed with Error:[STEP 1] Failed after 10 retries.
 during generating code:
transformer deeppoly{
    Affine -> (backsubs_lower(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr), backsubs_upper(prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], curr), prev DOT DOTT(curr[WEIGHT]) + curr[BIAS], prev DOT DOTT(curr[WEIGHT]) + curr[BIAS]);
}

2025-07-02 16:54:11,820 - INFO - 2025-07-02 16:54:11.820359 - Extracting Avgpool
2025-07-02 16:54:11,820 - INFO -
API: Avgpool -> Model: gpt-4o @ http://ggnds-serv-01.cs.illinois.edu:8084
2025-07-02 16:54:11,820 - INFO - [STEP 1] Starting step 1/1
2025-07-02 16:54:19,894 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (
        (1.0 / curr[weight].sum()) * prev[l].sum(),
        (1.0 / curr[weight].sum()) * prev[u].sum(),
        (1.0 / curr[weight].sum()) * prev[L].sum(),
        (1.0 / curr[weight].sum()) * prev[U].sum()
    );
}

2025-07-02 16:54:19,897 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:54:20,137 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (prev[l].listOp(sumOp) / curr[weight], prev[u].listOp(sumOp) / curr[weight], prev.listOp(sumOp) / curr[weight], prev.listOp(sumOp) / curr[weight]);
}

2025-07-02 16:54:20,137 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:54:20,354 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool ->
        (prev[l].listOp(sum) / FloatConst(pool_size),
         prev[u].listOp(sum) / FloatConst(pool_size),
         prev.listOp(sum) / FloatConst(pool_size),
         prev.listOp(sum) / FloatConst(pool_size));
}

2025-07-02 16:54:20,354 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:54:20,354 - INFO - [STEP 1] All 3 samples failed validation. Retrying 1/10...
2025-07-02 16:54:31,961 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (
        (1.0 / curr[weight].sum()) * prev[l].dot(curr[weight]),
        (1.0 / curr[weight].sum()) * prev[u].dot(curr[weight]),
        (1.0 / curr[weight].sum()) * prev.dot(curr[weight]),
        (1.0 / curr[weight].sum()) * prev.dot(curr[weight])
    );
}

2025-07-02 16:54:31,962 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:54:32,184 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly {
    Avgpool -> (
        (1.0 / curr[size]) * prev[l].listOp(sum),
        (1.0 / curr[size]) * prev[u].listOp(sum),
        (1.0 / curr[size]) * prev.listOp(sum),
        (1.0 / curr[size]) * prev.listOp(sum)
    );
}

2025-07-02 16:54:32,184 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:54:32,407 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (
        prev[l].listOp(sum) / curr[weight],
        prev[u].listOp(sum) / curr[weight],
        prev.listOp(sum) / curr[weight],
        prev.listOp(sum) / curr[weight]
    );
}

2025-07-02 16:54:32,408 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:54:32,408 - INFO - [STEP 1] All 3 samples failed validation. Retrying 2/10...
2025-07-02 16:54:39,102 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> ((prev[l].listOp(sum)) / (curr[equations].listOp(sum)),
                (prev[u].listOp(sum)) / (curr[equations].listOp(sum)),
                (prev.listOp(sum)) / (curr[equations].listOp(sum)),
                (prev.listOp(sum)) / (curr[equations].listOp(sum)));
}

2025-07-02 16:54:39,102 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:54:39,447 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (prev[l].map_list(x -> x).sum / len(prev[l]), prev[u].map_list(x -> x).sum / len(prev[u]), (prev[L].map_list(x -> x).sum / len(prev[L])), (prev[U].map_list(x -> x).sum / len(prev[U])));
}

2025-07-02 16:54:39,447 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:54:39,672 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (prev[l].listOp(mean), prev[u].listOp(mean), prev.listOp(mean), prev.listOp(mean));
}

2025-07-02 16:54:39,672 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:54:39,672 - INFO - [STEP 1] All 3 samples failed validation. Retrying 3/10...
2025-07-02 16:55:02,740 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (
        (1.0 / curr[weight].size()) * prev[l].listOp(sum),
        (1.0 / curr[weight].size()) * prev[u].listOp(sum),
        (1.0 / curr[weight].size()) * prev.listOp(sum),
        (1.0 / curr[weight].size()) * prev.listOp(sum)
    );
}

2025-07-02 16:55:02,740 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:55:02,968 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool ->
        (prev[l].maplist(FLOATCONST(1.0) / FLOATCONST(prev[l].length)).listOp(SUM),
         prev[u].maplist(FLOATCONST(1.0) / FLOATCONST(prev[u].length)).listOp(SUM),
         prev[L].maplist(FLOATCONST(1.0) / FLOATCONST(prev[L].length)).listOp(SUM),
         prev[U].maplist(FLOATCONST(1.0) / FLOATCONST(prev[U].length)).listOp(SUM)
        );
}

2025-07-02 16:55:02,968 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:55:03,198 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (
        (1.0 / curr[size]) * (prev[l].listOp(sum)),
        (1.0 / curr[size]) * (prev[u].listOp(sum)),
        (1.0 / curr[size]) * (prev.listOp(sum)),
        (1.0 / curr[size]) * (prev.listOp(sum))
    );
}

2025-07-02 16:55:03,198 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:55:03,198 - INFO - [STEP 1] All 3 samples failed validation. Retrying 4/10...
2025-07-02 16:55:09,651 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (prev[l].maplist((x) -> x).sum / curr[weight], prev[u].maplist((x) -> x).sum / curr[weight], (prev.maplist((x) -> x).sum / curr[weight]), (prev.maplist((x) -> x).sum / curr[weight]));
}

2025-07-02 16:55:09,651 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:55:09,880 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (
        (1 / curr[size]) * prev[l].sum,
        (1 / curr[size]) * prev[u].sum,
        (1 / curr[size]) * prev.sum,
        (1 / curr[size]) * prev.sum
    );
}

2025-07-02 16:55:09,881 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:55:10,108 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (
        (prev[l].listOp(sum) / prev[l].listOp(length)),
        (prev[u].listOp(sum) / prev[u].listOp(length)),
        (prev[L].listOp(sum) / prev[L].listOp(length)),
        (prev[U].listOp(sum) / prev[U].listOp(length))
    );
}

2025-07-02 16:55:10,108 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:55:10,108 - INFO - [STEP 1] All 3 samples failed validation. Retrying 5/10...
2025-07-02 16:55:17,244 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (
        (1.0/size(prev))[ * ]prev[l],
        (1.0/size(prev))[ * ]prev[u],
        (1.0/size(prev))[ * ]prev,
        (1.0/size(prev))[ * ]prev
    );
}

2025-07-02 16:55:17,244 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:55:17,467 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (
        prev[l].listOp(sum) / curr[pool_size],
        prev[u].listOp(sum) / curr[pool_size],
        (prev.listOp(sum) / curr[pool_size]),
        (prev.listOp(sum) / curr[pool_size])
    );
}

2025-07-02 16:55:17,467 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:55:17,689 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (
        (1.0 / curr[weight].length) * prev[l].listOp(sum),
        (1.0 / curr[weight].length) * prev[u].listOp(sum),
        (1.0 / curr[weight].length) * prev.listOp(sum),
        (1.0 / curr[weight].length) * prev.listOp(sum)
    );
}

2025-07-02 16:55:17,689 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:55:17,689 - INFO - [STEP 1] All 3 samples failed validation. Retrying 6/10...
2025-07-02 16:55:26,496 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (
        prev[l].listOp(sum) / curr[equations],                // lower bound
        prev[u].listOp(sum) / curr[equations],                // upper bound
        prev.listOp(sum) / curr[equations],                   // lower poly
        prev.listOp(sum) / curr[equations]                    // upper poly
    );
}

2025-07-02 16:55:26,497 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:55:26,735 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (
        (prev[l].maplist(id).sum) / len(prev[l]),
        (prev[u].maplist(id).sum) / len(prev[u]),
        (prev[L].maplist(id).sum) / len(prev[L]),
        (prev[U].maplist(id).sum) / len(prev[U])
    );
}

2025-07-02 16:55:26,735 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:55:26,972 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool ->
        (prev[l].listOp(sum) / prev[l].listOp(size),
         prev[u].listOp(sum) / prev[u].listOp(size),
         prev[L].listOp(sum) / prev[L].listOp(size),
         prev[U].listOp(sum) / prev[U].listOp(size));
}

2025-07-02 16:55:26,972 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:55:26,972 - INFO - [STEP 1] All 3 samples failed validation. Retrying 7/10...
2025-07-02 16:55:35,339 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (
        (1.0 / curr[equations].length) * sum(prev[curr[equations]]),
        (1.0 / curr[equations].length) * sum(prev[curr[equations]]),
        (1.0 / curr[equations].length) * sum(prev[curr[equations]]),
        (1.0 / curr[equations].length) * sum(prev[curr[equations]])
    );
}

2025-07-02 16:55:35,339 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:55:35,565 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (
        prev[l].map_list(x -> x).sum() / prev[l].length,
        prev[u].map_list(x -> x).sum() / prev[u].length,
        prev.map_list(x -> x).sum() / prev.length,
        prev.map_list(x -> x).sum() / prev.length
    );
}

2025-07-02 16:55:35,566 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:55:35,797 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (
        (prev[l].listOp(sum) / FloatConst(pool_size)),
        (prev[u].listOp(sum) / FloatConst(pool_size)),
        (prev.listOp(sum) / FloatConst(pool_size)),
        (prev.listOp(sum) / FloatConst(pool_size))
    );
}

2025-07-02 16:55:35,798 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:55:35,798 - INFO - [STEP 1] All 3 samples failed validation. Retrying 8/10...
2025-07-02 16:55:41,563 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (
        (prev[l].listOp(sum) / curr[size]),
        (prev[u].listOp(sum) / curr[size]),
        (prev.listOp(sum) / curr[size]),
        (prev.listOp(sum) / curr[size])
    );
}

2025-07-02 16:55:41,563 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:55:41,845 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:55:42,099 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 250, in visitBinOp
    rtype = self.visit(node.right)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 27, in visit
    return self.visitVar(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 403, in visitVar
    raise UndefinedVarException(node.name + " is undefined")
constraintflow.core.astTC.UndefinedVarException: N is undefined

Code:
transformer deeppoly{
    Avgpool -> (sum(prev[l]) / N, sum(prev[u]) / N, sum(prev) / N, sum(prev) / N);
}

2025-07-02 16:55:42,099 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:55:42,099 - INFO - [STEP 1] All 3 samples failed validation. Retrying 9/10...
2025-07-02 16:55:53,703 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (
        (1.0 / curr[weight].length) * prev[l].maplist(sum),
        (1.0 / curr[weight].length) * prev[u].maplist(sum),
        (1.0 / curr[weight].length) * prev[L].maplist(sum),
        (1.0 / curr[weight].length) * prev[U].maplist(sum)
    );
}

2025-07-02 16:55:53,703 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:55:53,938 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (
        (prev[l].map_list(x -> x).sum() / prev[l].map_list(x -> 1).sum()),
        (prev[u].map_list(x -> x).sum() / prev[u].map_list(x -> 1).sum()),
        (prev.map_list(x -> x).sum() / prev.map_list(x -> 1).sum()),
        (prev.map_list(x -> x).sum() / prev.map_list(x -> 1).sum())
    );
}

2025-07-02 16:55:53,938 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:55:54,164 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Avgpool -> (prev[l].map_list(x -> x).listOp(sum) / FloatConst(size(prev)), prev[u].map_list(x -> x).listOp(sum) / FloatConst(size(prev)), prev.map_list(x -> x).listOp(sum) / FloatConst(size(prev)), prev.map_list(x -> x).listOp(sum) / FloatConst(size(prev)));
}

2025-07-02 16:55:54,164 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:55:54,164 - INFO - [STEP 1] All 3 samples failed validation. Retrying 10/10...
2025-07-02 16:55:54,164 - INFO - [Avgpool] Runtime: 102.34 seconds
2025-07-02 16:55:54,164 - ERROR - Failed with Error:[STEP 1] Failed after 10 retries.
 during generating code:
transformer deeppoly{
    Avgpool -> (prev[l].map_list(x -> x).listOp(sum) / FloatConst(size(prev)), prev[u].map_list(x -> x).listOp(sum) / FloatConst(size(prev)), prev.map_list(x -> x).listOp(sum) / FloatConst(size(prev)), prev.map_list(x -> x).listOp(sum) / FloatConst(size(prev)));
}

2025-07-02 16:55:54,164 - INFO - 2025-07-02 16:55:54.164761 - Extracting HardSigmoid
2025-07-02 16:55:54,164 - INFO -
API: HardSigmoid -> Model: gpt-4o @ http://ggnds-serv-01.cs.illinois.edu:8084
2025-07-02 16:55:54,164 - INFO - [STEP 1] Starting step 1/1
2025-07-02 16:56:07,563 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 385, in visitMaxOp
    exp2type = self.visit(node.expr2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 389, in visitMaxOp
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: min is not defined on Int and PolyExp

Code:
transformer deeppoly{
    HardSigmoid ->
        ((prev[l]) >= 2) ? (1, 1, 1, 1) :
        (((prev[u]) <= -2) ? (0, 0, 0, 0) :
            (
                (max(0, min(1, 0.25 * (prev[l]) + 0.5))),
                (max(0, min(1, 0.25 * (prev[u]) + 0.5))),
                (max(0, min(1, 0.25 * (prev) + 0.5))),
                (max(0, min(1, 0.25 * (prev) + 0.5)))
            )
        );
}

2025-07-02 16:56:07,564 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:56:07,865 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
        (prev[u] <= -2.5) ? (0, 0, 0, 0) :
        (prev[l] >= 2.5) ? (1, 1, 1, 1) :
        (0.2 * (prev[l]) + 0.5 <= 0) ? (0, 0.2 * (prev[u]) + 0.5, 0, 0.2 * (prev) + 0.5) :
        (0.2 * (prev[u]) + 0.5 >= 1) ? (0.2 * (prev[l]) + 0.5, 1, 0.2 * (prev) + 0.5, 1) :
        (0.2 * (prev[l]) + 0.5, 0.2 * (prev[u]) + 0.5, 0.2 * (prev) + 0.5, 0.2 * (prev) + 0.5);
}

2025-07-02 16:56:07,865 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:56:08,111 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
        ((prev[l]) >= 2)
            ? (1, 1, 1, 1)
        : ((prev[u]) <= -2)
            ? (0, 0, 0, 0)
        : ( ((prev[l]) <= -2) & ((prev[u]) >= 2) )
            ? (0, 1, 0, 1)
        : ( ((prev[l]) >= -2) & ((prev[u]) <= 2) )
            ? (0.25*(prev[l])+0.5, 0.25*(prev[u])+0.5, 0.25*(prev)+0.5, 0.25*(prev)+0.5)
        : ((prev[l]) <= -2)
            ? (0, 0.25*(prev[u])+0.5, 0, 0.25*(prev)+0.5)
        : (0.25*(prev[l])+0.5, 1, 0.25*(prev)+0.5, 1);
}

2025-07-02 16:56:08,111 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:56:08,111 - INFO - [STEP 1] All 3 samples failed validation. Retrying 1/10...
2025-07-02 16:56:29,583 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
    ((prev[u]) <= -3) ?
        (0, 0, 0, 0) :
    (((prev[l]) >= 3) ?
        (1, 1, 1, 1) :
    ((prev[l]) >= -3 && (prev[u]) <= 3) ?
        ((0.1666667 * prev[l] + 0.5), (0.1666667 * prev[u] + 0.5), (0.1666667 * prev + 0.5), (0.1666667 * prev + 0.5)) :
    ((prev[l]) < -3 && (prev[u]) > -3 && (prev[u]) <= 3) ?
        (0, (0.1666667 * prev[u] + 0.5), 0, (0.1666667 * prev + 0.5)) :
    ((prev[l]) >= -3 && (prev[l]) < 3 && (prev[u]) > 3) ?
        ((0.1666667 * prev[l] + 0.5), 1, (0.1666667 * prev + 0.5), 1) :
        (0, 1, 0, 1)));
}

2025-07-02 16:56:29,583 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:56:29,818 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
        ((prev[l]) >= 2)                           ? (1, 1, 1, 1)
    :   ((prev[u]) <= -2)                          ? (0, 0, 0, 0)
    :   (
            (prev[l] >= -2) & (prev[u] <= 2)
            ?   ((0.25 * prev[l] + 0.5), (0.25 * prev[u] + 0.5), (0.25 * prev + 0.5), (0.25 * prev + 0.5))
            :   ((prev[l] < -2) & (prev[u] <= 2)
                ? (0, (0.25 * prev[u] + 0.5), 0, (0.25 * prev + 0.5))
                : ((prev[l] >= -2) & (prev[u] > 2)
                    ? (0.25 * prev[l] + 0.5, 1, (0.25 * prev + 0.5), 1)
                    : (0, 1, 0, 1)
                  )
              )
        );
}

2025-07-02 16:56:29,818 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:56:30,065 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
      ((prev[l] >= 2) ? 1 : (
         (prev[u] <= -2) ? 0 : (
            (prev[l] >= -2 && prev[u] <= 2) ? (
                (0.25 * prev[l] + 0.5),
                (0.25 * prev[u] + 0.5),
                (0.25 * prev + 0.5),
                (0.25 * prev + 0.5)
            ) : (
                0,
                1,
                (0.25 * prev + 0.5).traverse(backward, priority2, true, replace_lower){(0.25 * prev + 0.5) <= curr},
                (0.25 * prev + 0.5).traverse(backward, priority2, true, replace_upper){(0.25 * prev + 0.5) >= curr}
            )
         )
      ));
}

2025-07-02 16:56:30,065 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:56:30,065 - INFO - [STEP 1] All 3 samples failed validation. Retrying 2/10...
2025-07-02 16:57:28,281 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
        (prev[u] <= -2.5) ? (0, 0, 0, 0) :
        (prev[l] >= 2.5) ? (1, 1, 1, 1) :
        (
            max(0, min(1, 0.2 * prev[l] + 0.5)),
            max(0, min(1, 0.2 * prev[u] + 0.5)),
            max(0, min(1, 0.2 * prev + 0.5)),
            max(0, min(1, (prev[u] - prev) / (prev[u] - prev[l]) * (0.2 * prev[l] + 0.5) + (prev - prev[l]) / (prev[u] - prev[l]) * (0.2 * prev[u] + 0.5) ))
        );
}

2025-07-02 16:57:28,281 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:57:28,523 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
        (prev[u] <= -2.5) ? (0, 0, 0, 0) :
        (prev[l] >= 2.5) ? (1, 1, 1, 1) :
        (prev[l] >= -2.5 && prev[u] <= 2.5) ?
            (0.2 * prev[l] + 0.5, 0.2 * prev[u] + 0.5, 0.2 * prev + 0.5, 0.2 * prev + 0.5) :
        (prev[l] < -2.5 && prev[u] > -2.5 && prev[u] <= 2.5) ?
            (0, 0.2 * prev[u] + 0.5, 0, (0.2 * (prev - prev[l]) / (prev[u] - prev[l])) + ((0.5 + 0.2 * prev[u]) * (prev[l] - prev) / (prev[u] - prev[l]))) :
        (prev[l] >= -2.5 && prev[l] < 2.5 && prev[u] > 2.5) ?
            (0.2 * prev[l] + 0.5, 1, (0.2 * (prev - prev[u]) / (prev[l] - prev[u])) + ((0.5 + 0.2 * prev[l]) * (prev[u] - prev) / (prev[l] - prev[u])), 1) :
        (prev[l] < -2.5 && prev[u] > 2.5) ?
            (0, 1, 0, 1) :
        (0, 1, 0, 1);
}

2025-07-02 16:57:28,523 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:57:28,877 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid -> (
        // lower bound
        ((prev[l] >= 1) ? 1 :
            (prev[u] <= -1) ? 0 :
            (prev[l] >= -1) ? (0.5 * prev[l] + 0.5) :
            ((-0.5 * prev[u]) / (prev[u] - prev[l]) * prev[l] + (prev[u] / (prev[u] - prev[l])) * (0.5 + 0.5 * prev[l]))
        ),
        // upper bound
        ((prev[u] <= -1) ? 0 :
            (prev[l] >= 1) ? 1 :
            (prev[u] <= 1) ? (0.5 * prev[u] + 0.5) :
            ((-0.5 * prev[l]) / (prev[u] - prev[l]) * prev[u] + (prev[l] / (prev[u] - prev[l])) * (0.5 + 0.5 * prev[u]))
        ),
        // lower poly
        ((prev[l] >= 1) ? 1 :
            (prev[u] <= -1) ? 0 :
            (prev[l] >= -1) ? (0.5 * prev + 0.5) :
            ((-0.5 * prev[u]) / (prev[u] - prev[l]) * prev + (prev[u] / (prev[u] - prev[l])) * (0.5 + 0.5 * prev))
        ),
        // upper poly
        ((prev[u] <= -1) ? 0 :
            (prev[l] >= 1) ? 1 :
            (prev[u] <= 1) ? (0.5 * prev + 0.5) :
            ((-0.5 * prev[l]) / (prev[u] - prev[l]) * prev + (prev[l] / (prev[u] - prev[l])) * (0.5 + 0.5 * prev))
        )
    );
}

2025-07-02 16:57:28,877 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:57:28,877 - INFO - [STEP 1] All 3 samples failed validation. Retrying 3/10...
2025-07-02 16:57:46,404 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 385, in visitMaxOp
    exp2type = self.visit(node.expr2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 389, in visitMaxOp
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: min is not defined on Int and PolyExp

Code:
transformer deeppoly{
    HardSigmoid ->
        ((prev[l]) >= 2) ? (1, 1, 1, 1) :
        ((prev[u]) <= -2) ? (0, 0, 0, 0) :
        (
            max(0, min(1, 0.25 * (prev[l]) + 0.5)),
            max(0, min(1, 0.25 * (prev[u]) + 0.5)),
            max(0, min(1, 0.25 * (prev) + 0.5)),
            max(0, min(1, 0.25 * (prev) + 0.5))
        );
}

2025-07-02 16:57:46,405 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:57:46,635 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
        ((prev[u]) <= -1.0) ? (0.0, 0.0, 0.0, 0.0)
        : (((prev[l]) >= 1.0) ? (1.0, 1.0, 1.0, 1.0)
        : (
            (0.5 * prev[l] + 0.5 < 0.0 ? 0.0 : 0.5 * prev[l] + 0.5),
            (0.5 * prev[u] + 0.5 > 1.0 ? 1.0 : 0.5 * prev[u] + 0.5),
            (prev[l] >= 0.0 ?
                0.5 * prev + 0.5
             : prev[u] <= 0.0 ?
                0.5 * prev + 0.5
             :
                (0.5 * prev + 0.5)
            ),
            (prev[l] >= 0.0 ?
                0.5 * prev + 0.5
             : prev[u] <= 0.0 ?
                0.5 * prev + 0.5
             :
                (max(0.0, 0.5 * prev + 0.5) + min(1.0, 0.5 * prev + 0.5))
            )
        ));
}

2025-07-02 16:57:46,636 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:57:46,869 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
        ((prev[u]) <= -3) ?
            (0, 0, 0, 0)
        : (((prev[l]) >= 3) ?
            (1, 1, 1, 1)
        : (((prev[l]) >= -3) & ((prev[u]) <= 3)) ?
            ((0.1666666667 * prev[l] + 0.5), (0.1666666667 * prev[u] + 0.5), (0.1666666667 * prev + 0.5), (0.1666666667 * prev + 0.5))
        :
            (0, 1, 0, 1)
        ));
}

2025-07-02 16:57:46,870 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:57:46,870 - INFO - [STEP 1] All 3 samples failed validation. Retrying 4/10...
2025-07-02 16:58:07,523 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly {
    HardSigmoid ->
        ((prev[u]) <= -3.0) ?
            (0, 0, 0, 0) :
        ((prev[l]) >= 3.0) ?
            (1, 1, 1, 1) :
        ((prev[l]) >= -3.0 & (prev[u]) <= 3.0) ?
            (((0.16666667 * prev[l]) + 0.5), ((0.16666667 * prev[u]) + 0.5), (0.16666667 * prev + 0.5), (0.16666667 * prev + 0.5)):
        ((prev[l]) < -3.0 & (prev[u]) <= 3.0) ?
            (0, ((0.16666667 * prev[u]) + 0.5), 0, (0.16666667 * prev + 0.5)) :
        ((prev[l]) >= -3.0 & (prev[u]) > 3.0) ?
            (((0.16666667 * prev[l]) + 0.5), 1, (0.16666667 * prev + 0.5), 1):
        (0, 1, 0, 1);
}

2025-07-02 16:58:07,523 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:58:08,046 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:58:08,282 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
        ((prev[u] <= -3)
            ? (0, 0, 0, 0)
            : ((prev[l] >= 3)
                ? (1, 1, 1, 1)
                : (
                    (prev[l] >= -3) & (prev[u] <= 3)
                        ? ( (0.16666667 * prev[l] + 0.5), (0.16666667 * prev[u] + 0.5), (0.16666667 * prev + 0.5), (0.16666667 * prev + 0.5) )
                        : (
                            (prev[l] < -3) & (prev[u] <= 3)
                                ? (0, (0.16666667 * prev[u] + 0.5), 0, (0.16666667 * prev + 0.5))
                                : ( (0.16666667 * prev[l] + 0.5), 1, (0.16666667 * prev + 0.5), 1 )
                          )
                  )
              )
        );
}

2025-07-02 16:58:08,282 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:58:08,282 - INFO - [STEP 1] All 3 samples failed validation. Retrying 5/10...
2025-07-02 16:58:20,807 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:58:21,114 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
        ((prev[u]) <= -2.5) ? (0, 0, 0, 0)
        : (((prev[l]) >= 2.5) ? (1, 1, 1, 1)
        : ((0.2 * prev[l] + 0.5 <= 0) ? (0, 0.2 * prev[u] + 0.5, 0, 0.2 * prev + 0.5)
        : ((0.2 * prev[u] + 0.5 >= 1) ? (0.2 * prev[l] + 0.5, 1, 0.2 * prev + 0.5, 1)
        : (0.2 * prev[l] + 0.5, 0.2 * prev[u] + 0.5, 0.2 * prev + 0.5, 0.2 * prev + 0.5))));
}

2025-07-02 16:58:21,114 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:58:21,341 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
        ((prev[u]) <= -2.5) ? (0, 0, 0, 0)
        : ((prev[l]) >= 2.5) ? (1, 1, 1, 1)
        : (
            (0, 1,
             (0.2 * prev + 0.5),
             (0.2 * prev + 0.5)
            )
        );
}

2025-07-02 16:58:21,341 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:58:21,341 - INFO - [STEP 1] All 3 samples failed validation. Retrying 6/10...
2025-07-02 16:58:43,483 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
        ((prev[l] >= 1)) ? (1, 1, 1, 1)
        : ((prev[u] <= -1)) ? (0, 0, 0, 0)
        : ((prev[l] >= -1) & (prev[u] <= 1)) ? ((0.5 * prev[l] + 0.5), (0.5 * prev[u] + 0.5), (0.5 * prev + 0.5), (0.5 * prev + 0.5))
        : ((prev[l] < -1) & (prev[u] <= 1)) ? (0, (0.5 * prev[u] + 0.5), 0, (0.5 * prev + 0.5))
        : ((prev[l] >= -1) & (prev[u] > 1)) ? ((0.5 * prev[l] + 0.5), 1, (0.5 * prev + 0.5), 1)
        : (0, 1, 0, 1);
}

2025-07-02 16:58:43,483 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:58:43,725 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
        ((prev[u]) <= -3.0) ? (0.0, 0.0, 0.0, 0.0) :
        (((prev[l]) >= 3.0) ? (1.0, 1.0, 1.0, 1.0) :
        (( (prev[l]) >= -3.0 && (prev[u]) <= 3.0 ) ?
            (0.16666667 * (prev[l]) + 0.5, 0.16666667 * (prev[u]) + 0.5, 0.16666667 * (prev) + 0.5, 0.16666667 * (prev) + 0.5)
        : ( max(0.0, 0.16666667 * (prev[l]) + 0.5),
            min(1.0, 0.16666667 * (prev[u]) + 0.5),
            0.16666667 * (prev) + 0.5,
            ((0.16666667 * (prev[u]) + 0.5) / ((prev[u]) - (prev[l]))) * (prev) - ((prev[l]) * (0.16666667 * (prev[u]) + 0.5) / ((prev[u]) - (prev[l])))
        )));
}

2025-07-02 16:58:43,725 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:58:43,974 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
        ((prev[u]) <= -3.0) ?
            (0.0, 0.0, 0.0, 0.0) :
        ((prev[l]) >= 3.0) ?
            (1.0, 1.0, 1.0, 1.0) :
        (
            (max(0.0, min(1.0, 0.2 * prev[l] + 0.5))),
            (max(0.0, min(1.0, 0.2 * prev[u] + 0.5))),
            (max(0.0, min(1.0, 0.2 * prev + 0.5))),
            (
                (prev[l] > -3.0 && prev[u] < 3.0) ?
                  (max(0.0, min(1.0, 0.2 * prev + 0.5))) :
                  (
                    (prev[u] > 3.0) ?
                      (max(0.0, min(1.0, 0.2 * prev + 0.5))) :
                      (
                        (prev[l] < -3.0) ?
                          (max(0.0, min(1.0, 0.2 * prev + 0.5)))
                        : (max(0.0, min(1.0, 0.2 * prev + 0.5)))
                      )
                  )
            )
        );
}

2025-07-02 16:58:43,974 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:58:43,974 - INFO - [STEP 1] All 3 samples failed validation. Retrying 7/10...
2025-07-02 16:58:58,718 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
      ((prev[u]) <= -2.5) ? (0, 0, 0, 0) :
      ((prev[l]) >= 2.5) ? (1, 1, 1, 1) :
      (
        max(0, min(1, 0.2 * (prev[l]) + 0.5)),
        max(0, min(1, 0.2 * (prev[u]) + 0.5)),
        0.2 * (prev) + 0.5,
        0.2 * (prev) + 0.5
      );
}

2025-07-02 16:58:58,718 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:58:58,953 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
        // HardSigmoid(x) = max(0, min(1, alpha * x + beta)), typically alpha=0.2, beta=0.5
        let alpha = 0.2 in
        let beta = 0.5 in
        (((prev[l]) * alpha + beta <= 0) ? (0) :
            ((prev[u]) * alpha + beta >= 1) ? (1) : ((prev[l]) * alpha + beta)),
        (((prev[u]) * alpha + beta >= 1) ? (1) :
            ((prev[l]) * alpha + beta <= 0) ? (0) : ((prev[u]) * alpha + beta)),
        (((prev[l]) * alpha + beta <= 0) ? (0) :
            ((prev[u]) * alpha + beta >= 1) ? (1) : ((prev) * alpha + beta)),
        (((prev[u]) * alpha + beta >= 1) ? (1) :
            ((prev[l]) * alpha + beta <= 0) ? (0) :
            (((prev) * alpha + beta)
                - ((prev[l]) * alpha + beta) * (1 - ((prev) - (prev[l])) / ((prev[u]) - (prev[l])))))
}

2025-07-02 16:58:58,954 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:58:59,172 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
        (prev[u] <= -3.0) ? (0.0, 0.0, 0.0, 0.0) :
        (prev[l] >= 3.0) ? (1.0, 1.0, 1.0, 1.0) :
        (
            max(0.0, min(1.0, 0.1666667 * prev[l] + 0.5)),
            max(0.0, min(1.0, 0.1666667 * prev[u] + 0.5)),
            max(0.0, min(1.0, 0.1666667 * prev + 0.5)),
            max(0.0, min(1.0, 0.1666667 * prev + 0.5))
        );
}

2025-07-02 16:58:59,172 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:58:59,172 - INFO - [STEP 1] All 3 samples failed validation. Retrying 8/10...
2025-07-02 16:59:11,896 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:59:12,218 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
        ((prev[u]) <= -2.5) ? (0, 0, 0, 0) :
        (((prev[l]) >= 2.5) ? (1, 1, 1, 1) :
        (max(0, 0.2 * prev[l] + 0.5), min(1, 0.2 * prev[u] + 0.5), max(0, min(1, 0.2 * prev + 0.5)), min(1, max(0, 0.2 * prev + 0.5))));
}

2025-07-02 16:59:12,218 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:59:12,456 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
        ((prev[u]) <= -3) ?
            (0, 0, 0, 0) :
        (
            ((prev[l]) >= 3) ?
                (1, 1, 1, 1) :
            (
                ( ((prev[l]) <= -3) & ((prev[u]) >= 3) ) ?
                    (0, 1, 0, 1) :
                (
                    ( ((prev[l]) >= -3) & ((prev[u]) <= 3)) ?
                        (
                            (0.16666667*(prev[l])+0.5), (0.16666667*(prev[u])+0.5),
                            (0.16666667*prev+0.5), (0.16666667*prev+0.5)
                        ) :
                    (
                        ( ((prev[l]) < -3) & ((prev[u]) <= 3)) ?
                            (
                                0,
                                (0.16666667*(prev[u])+0.5),
                                0,
                                (0.16666667*prev+0.5) - ((prev[u])*(prev[l]+3)/(prev[u]-prev[l]))
                            ) :
                        (
                            0, 1, 0, 1
                        )
                    )
                )
            )
        );
}

2025-07-02 16:59:12,456 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:59:12,456 - INFO - [STEP 1] All 3 samples failed validation. Retrying 9/10...
2025-07-02 16:59:33,970 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
        ((prev[u]) <= -2.5) ? (0, 0, 0, 0)
        : (((prev[l]) >= 2.5) ? (1, 1, 1, 1)
        : ((prev[l]) >= -2.5 && (prev[u]) <= 2.5) ?
            (0.2*(prev[l]) + 0.5, 0.2*(prev[u]) + 0.5, 0.2*prev + 0.5, 0.2*prev + 0.5)
        : ((prev[l]) < -2.5 && (prev[u]) > -2.5 && (prev[u]) <= 2.5) ?
            (0, 0.2*(prev[u]) + 0.5, 0, 0.2*prev + 0.5)
        : ((prev[l]) >= -2.5 && (prev[l]) < 2.5 && (prev[u]) > 2.5) ?
            (0.2*(prev[l]) + 0.5, 1, 0.2*prev + 0.5, 1)
        : (0, 1, 0, 1)
        )
        );
}

2025-07-02 16:59:33,970 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:59:34,206 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
        ((prev[u]) <= -3) ? (0, 0, 0, 0) :
        (
            ((prev[l]) >= 3) ? (1, 1, 1, 1) :
            (
                ( (prev[l]) >= -3 ) & ( (prev[u]) <= 3 ) ?
                    ( ((0.16666667 * prev[l]) + 0.5), ((0.16666667 * prev[u]) + 0.5), ((prev * 0.16666667) + 0.5), ((prev * 0.16666667) + 0.5) )
                :
                    (
                        ( (prev[l]) < -3 ) & ( (prev[u]) > 3 ) ?
                            (0, 1, 0, 1)
                        :
                            (
                                ( (prev[l]) < -3 ) ?
                                    ( 0, ((0.16666667 * prev[u]) + 0.5), 0, ((prev * 0.16666667) + 0.5) )
                                :
                                    ( ((0.16666667 * prev[l]) + 0.5), 1, ((prev * 0.16666667) + 0.5), 1 )
                            )
                    )
            )
        );
}

2025-07-02 16:59:34,206 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:59:34,458 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSigmoid ->
        ((prev[u]) <= -3) ? (0, 0, 0, 0) :
        (((prev[l]) >= 3) ? (1, 1, 1, 1) :
        ( ((prev[l]) >= -3) & ((prev[u]) <= 3) ?
            (0.1666666667 * prev[l] + 0.5, 0.1666666667 * prev[u] + 0.5, 0.1666666667 * prev + 0.5, 0.1666666667 * prev + 0.5 ) :
            ( (prev[l] < -3) & (prev[u] > 3) ?
                (0, 1, (prev - prev[l]) * (1 - 0) / (prev[u] - prev[l]) + 0, (prev - prev[l]) * (1 - 0) / (prev[u] - prev[l]) + 0)
                :
                (max(0, 0.1666666667 * prev[l] + 0.5), min(1, 0.1666666667 * prev[u] + 0.5), max(0, 0.1666666667 * prev + 0.5), min(1, 0.1666666667 * prev + 0.5))
            )
        ));
}

2025-07-02 16:59:34,459 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:59:34,459 - INFO - [STEP 1] All 3 samples failed validation. Retrying 10/10...
2025-07-02 16:59:34,459 - INFO - [HardSigmoid] Runtime: 220.29 seconds
2025-07-02 16:59:34,459 - ERROR - Failed with Error:[STEP 1] Failed after 10 retries.
 during generating code:
transformer deeppoly{
    HardSigmoid ->
        ((prev[u]) <= -3) ? (0, 0, 0, 0) :
        (((prev[l]) >= 3) ? (1, 1, 1, 1) :
        ( ((prev[l]) >= -3) & ((prev[u]) <= 3) ?
            (0.1666666667 * prev[l] + 0.5, 0.1666666667 * prev[u] + 0.5, 0.1666666667 * prev + 0.5, 0.1666666667 * prev + 0.5 ) :
            ( (prev[l] < -3) & (prev[u] > 3) ?
                (0, 1, (prev - prev[l]) * (1 - 0) / (prev[u] - prev[l]) + 0, (prev - prev[l]) * (1 - 0) / (prev[u] - prev[l]) + 0)
                :
                (max(0, 0.1666666667 * prev[l] + 0.5), min(1, 0.1666666667 * prev[u] + 0.5), max(0, 0.1666666667 * prev + 0.5), min(1, 0.1666666667 * prev + 0.5))
            )
        ));
}

2025-07-02 16:59:34,459 - INFO - 2025-07-02 16:59:34.459611 - Extracting HardSwish
2025-07-02 16:59:34,459 - INFO -
API: HardSwish -> Model: gpt-4o @ http://ggnds-serv-01.cs.illinois.edu:8084
2025-07-02 16:59:34,459 - INFO - [STEP 1] Starting step 1/1
2025-07-02 16:59:51,590 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSwish ->
        (prev[l] >= 3) ?
            (prev[l], prev[u], prev, prev)
        : (prev[u] <= -3) ?
            (0, 0, 0, 0)
        :
            (
                max(0, prev[l] * (min(6, max(0, prev[l]+3))/6)),
                max(0, prev[u] * (min(6, max(0, prev[u]+3))/6)),
                prev * (min(6, max(0, prev+3))/6),
                prev * (min(6, max(0, prev+3))/6)
            );
}

2025-07-02 16:59:51,590 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 16:59:51,826 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSwish ->
        (prev[l] >= 3) ? (prev[l], prev[u], prev, prev) :
        (prev[u] <= -3) ? (0, 0, 0, 0) :
        (prev[l] >= -3 && prev[u] <= 3) ?
            (
                prev[l]*((prev[l]+3)/6),
                prev[u]*((prev[u]+3)/6),
                prev*((prev+3)/6),
                prev*((prev+3)/6)
            ) :
        (prev[l] < -3 && prev[u] > 3) ?
            (
                0,
                prev[u],
                prev*((prev+3)/6),
                prev*((prev+3)/6)
            ) :
        (
            min(0, prev[l]*((prev[l]+3)/6)),
            max(prev[u]*((prev[u]+3)/6), prev[u]),
            prev*((prev+3)/6),
            prev*((prev+3)/6)
        );
}

2025-07-02 16:59:51,827 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 16:59:52,106 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 250, in visitBinOp
    rtype = self.visit(node.right)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 249, in visitBinOp
    ltype = self.visit(node.left)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 249, in visitBinOp
    ltype = self.visit(node.left)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 385, in visitMaxOp
    exp2type = self.visit(node.expr2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 389, in visitMaxOp
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: max is not defined on Neuron and Int

Code:
transformer deeppoly{
    HardSwish ->
        (prev[l] >= 3) ? (
            prev[l],
            prev[u],
            prev,
            prev
        ) : ((prev[u] <= -3) ? (
            0,
            0,
            0,
            0
        ) : (
            min(0, prev[l]),
            max(prev[u], 0),
            ((prev + (((min(3, max(prev, -3))) + 3) / 6))),
            ((prev + (((max(3, min(prev, -3))) + 3) / 6)))
        )
    );
}

2025-07-02 16:59:52,106 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 16:59:52,107 - INFO - [STEP 1] All 3 samples failed validation. Retrying 1/10...
2025-07-02 17:00:01,992 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 249, in visitBinOp
    ltype = self.visit(node.left)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 255, in visitBinOp
    node.type = self.get_binop(node.op, ltype, rtype)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 212, in get_binop
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: * is not defined on Neuron and PolyExp

Code:
transformer deeppoly{
    HardSwish -> ((prev[l] >= 3) ? (prev[l], prev[u], prev, prev)
        : (prev[u] <= -3) ? (0, 0, 0, 0)
        : (
            (prev[l] >= 0) ?
                (
                    prev[l] * (prev[l] + 3)/6,
                    prev[u] * (prev[u] + 3)/6,
                    prev * (prev + 3)/6,
                    prev * (prev + 3)/6
                )
            :
                (
                    0,
                    max(prev[u] * (prev[u] + 3)/6, 0),
                    0,
                    prev * (prev + 3)/6
                )
        )
    );
}

2025-07-02 17:00:01,992 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:00:11,061 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:00:11,368 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:00:11,368 - INFO - [STEP 1] All 3 samples failed validation. Retrying 2/10...
2025-07-02 17:00:28,440 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 249, in visitBinOp
    ltype = self.visit(node.left)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 255, in visitBinOp
    node.type = self.get_binop(node.op, ltype, rtype)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 212, in get_binop
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: * is not defined on Neuron and PolyExp

Code:
transformer deeppoly{
    HardSwish ->
      ((prev[l] >= 3) ?
          (prev[l], prev[u], prev, prev)
        : (prev[u] <= -3) ?
          (0, 0, 0, 0)
        : (
            // Lower/Upper
            (prev[l] >= 0) ?
              ((prev[l] * (prev[l] + 3) / 6),
               (prev[u] * (prev[u] + 3) / 6),
               (prev * (prev + 3) / 6),
               (prev * (prev + 3) / 6))
             :
              (0,
               max_op((prev[u] * (prev[u] + 3) / 6), 0),
               0,
               (prev * (prev + 3) / 6)
              )
          )
      );
}

2025-07-02 17:00:28,440 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:00:28,682 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSwish ->
    ((prev[l] >= 3) ? (prev[l], prev[u], prev, prev) :
    ((prev[u] <= -3) ? (0, 0, 0, 0) :
    ((prev[l] >= -3) & (prev[u] <= 3)) ?
        // Within [-3, 3]
        (simplify_lower(prev, (prev[l] + 3) / 6),
         simplify_upper(prev, (prev[u] + 3) / 6),
         replace_lower(prev, (prev[l] + 3) / 6),
         replace_upper(prev, (prev[u] + 3) / 6))
        :
        // General case
        (0, simplify_upper(prev, max(prev[u], 0)),
         0, replace_upper(prev, ((prev[u] + 3) / 6)))
    ));
}

2025-07-02 17:00:28,682 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:00:29,064 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 249, in visitBinOp
    ltype = self.visit(node.left)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 250, in visitBinOp
    rtype = self.visit(node.right)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 385, in visitMaxOp
    exp2type = self.visit(node.expr2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 389, in visitMaxOp
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: min is not defined on PolyExp and Int

Code:
transformer deeppoly{
    HardSwish ->
        ((prev[l]) >= 3) ? ((prev[l]), (prev[u]), (prev), (prev)) :
        (((prev[u]) <= -3) ? (0, 0, 0, 0) :
            (
                (min(prev[l], 0)),
                (max(prev[u], ((prev[u]) * (prev[u] + 3)) / 6)),
                (((prev * max(0, min(prev + 3, 6))) / 6)),
                (((prev * max(0, min(prev + 3, 6))) / 6))
            )
        );
}

2025-07-02 17:00:29,065 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:00:29,065 - INFO - [STEP 1] All 3 samples failed validation. Retrying 3/10...
2025-07-02 17:00:45,945 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:00:46,325 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 249, in visitBinOp
    ltype = self.visit(node.left)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 255, in visitBinOp
    node.type = self.get_binop(node.op, ltype, rtype)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 212, in get_binop
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: * is not defined on Neuron and PolyExp

Code:
transformer deeppoly{
    HardSwish ->
        (prev[l] >= 3) ?
            ((prev[l]), (prev[u]), (prev), (prev))
        : ((prev[u] <= -3) ?
            (0, 0, 0, 0)
        : (
            // General case in (-3, 3)
            (prev[l] > -3) ?
                ((((prev[l]) * (prev[l] + 3)) / 6),
                 ((prev[u]) * (prev[u] + 3)) / 6,
                 ((prev) * (prev + 3)) / 6,
                 ((prev[u]) * (prev[u] + 3)) / 6)
            :
                (0,
                 max((prev[u] * (prev[u] + 3)) / 6, 0),
                 ((prev) * (prev + 3)) / 6,
                 max((prev[u] * (prev[u] + 3)) / 6, 0))
        )
        );
}

2025-07-02 17:00:46,325 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:00:46,645 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 249, in visitBinOp
    ltype = self.visit(node.left)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 250, in visitBinOp
    rtype = self.visit(node.right)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 249, in visitBinOp
    ltype = self.visit(node.left)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 385, in visitMaxOp
    exp2type = self.visit(node.expr2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 389, in visitMaxOp
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: max is not defined on Int and Neuron

Code:
transformer deeppoly{
    HardSwish ->
        ((prev[l]) >= 3) ?
            ((prev[l]), (prev[u]), (prev), (prev))
        :
        (((prev[u]) <= -3) ?
            (0, 0, 0, 0)
        :
            (
                (min(0, prev[l]) * (max(0, prev[l]) + 3) / 6),
                (max(0, prev[u]) * (min(0, prev[u]) + 3) / 6),
                ((prev * (min(3, max(0, prev)) + 3)) / 6),
                ((prev * (max(0, min(3, prev)) + 3)) / 6)
            )
        );
}

2025-07-02 17:00:46,645 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:00:46,645 - INFO - [STEP 1] All 3 samples failed validation. Retrying 4/10...
2025-07-02 17:01:00,802 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 249, in visitBinOp
    ltype = self.visit(node.left)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 255, in visitBinOp
    node.type = self.get_binop(node.op, ltype, rtype)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 212, in get_binop
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: * is not defined on Neuron and PolyExp

Code:
transformer deeppoly{
    HardSwish ->
    ((prev[l]) >= 3) ?
        ((prev[l]), (prev[u]), (prev), (prev))
    : (((prev[u]) <= -3) ?
        (0, 0, 0, 0)
    :
        (
            (prev[l] + ((prev[u] - prev[l]) * (prev[l] + 3) / 6)),
            (prev[u] * (prev[u] + 3) / 6),
            prev * (prev + 3) / 6,
            prev * (prev + 3) / 6
        ));
}

2025-07-02 17:01:00,803 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:01:01,233 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 249, in visitBinOp
    ltype = self.visit(node.left)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 255, in visitBinOp
    node.type = self.get_binop(node.op, ltype, rtype)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 212, in get_binop
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: * is not defined on Neuron and PolyExp

Code:
transformer deeppoly{
    HardSwish ->
        (prev[l] >= 3) ? (
            prev[l],
            prev[u],
            prev,
            prev
        ) : (
            (prev[u] <= -3) ? (
                0,
                0,
                0,
                0
            ) : (
                (prev[l] >= -3) ? (
                    (prev[l] >= 0) ?
                        ((prev[l] * (prev[l] + 3) / 6),
                         (prev[u] * (prev[u] + 3) / 6),
                         (prev * (prev + 3) / 6),
                         (prev * (prev + 3) / 6))
                    :
                        (0,
                         (prev[u] * (prev[u] + 3) / 6),
                         0,
                         (prev * (prev + 3) / 6))
                )
                :
                (0,
                 (prev[u] * (prev[u] + 3) / 6),
                 0,
                 (prev * (prev + 3) / 6))
            )
        );
}

2025-07-02 17:01:01,233 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:01:10,761 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSwish ->
        ((prev[u]) <= -3) ? (0, 0, 0, 0) :
        ((prev[l]) >= 3) ? (prev[l], prev[u], prev, prev) :
        ((prev[l]) >= -3 && (prev[u]) <= 3) ?
            (
                ((prev[l]) * ((prev[l]) + 3) / 6),
                ((prev[u]) * ((prev[u]) + 3) / 6),
                (prev * ((prev + 3) / 6)),
                (prev * ((prev + 3) / 6))
            ) :
        (
            0,
            max((prev[u] * ((prev[u] + 3) / 6)), prev[u], 0),
            0,
            max((prev * ((prev + 3) / 6)), prev, 0)
        );
}

2025-07-02 17:01:10,761 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:01:10,761 - INFO - [STEP 1] All 3 samples failed validation. Retrying 5/10...
2025-07-02 17:01:30,333 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    HardSwish ->
        (prev[l] >= 3) ?
            (prev[l], prev[u], prev, prev)
        : ((prev[u] <= -3) ?
            (0, 0, 0, 0)
        :
            (0, max_op(prev[u], ((prev[u] + 3) * prev[u]) / 6), 0, ((prev[u] + 3) * prev) / 6));
}

2025-07-02 17:01:30,333 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:01:30,688 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSwish ->
        ((prev[l]) >= 3) ?
            ((prev[l]), (prev[u]), (prev), (prev))
        :
        ((prev[u]) <= -3) ?
            (0, 0, 0, 0)
        :
            (
                ((prev[l]) <= -3) ? 0 : ((prev[l])*(min(6, max(0, (prev[l]) + 3)))/6),
                ((prev[u]) >= 3) ? (prev[u]) : ((prev[u])*(min(6, max(0, (prev[u]) + 3)))/6),
                ((prev)*(min(6, max(0, (prev) + 3)))/6),
                // Upper poly approx: convex hull between left and right linear, sharpest upper
                (
                    ((prev[u]) - (prev[l])) == 0 ?
                        ((prev[u])*(min(6, max(0, (prev[u]) + 3)))/6) :
                        (
                            ( ((prev[u])*(min(6, max(0, (prev[u]) + 3)))/6)
                            - ((prev[l])*(min(6, max(0, (prev[l]) + 3)))/6))
                            / ((prev[u]) - (prev[l])) * (prev)
                            - (((prev[u])*(min(6, max(0, (prev[u]) + 3)))/6)*((prev[l]))
                              - ((prev[l])*(min(6, max(0, (prev[l]) + 3)))/6)*((prev[u])))
                            / ((prev[u]) - (prev[l]))
                        )
                )
            )
}

2025-07-02 17:01:30,688 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:01:30,928 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSwish ->
        ((prev[l] >= 3) ?
            (prev[l], prev[u], prev, prev)
        : (prev[u] <= -3) ?
            (0, 0, 0, 0)
        : (
            let lower_0 = (prev[l] <= -3) ? 0 : (prev[l] >= 3) ? prev[l] : prev[l] * (prev[l] + 3) / 6;
            let upper_0 = (prev[u] <= -3) ? 0 : (prev[u] >= 3) ? prev[u] : prev[u] * (prev[u] + 3) / 6;
            let poly_l = (prev[l] <= -3) ? 0 : (prev * (prev + 3) / 6);
            let poly_u = (prev[u] >= 3) ? prev : (prev * (prev + 3) / 6);
            (lower_0, upper_0, poly_l, poly_u)
        )
    );
}

2025-07-02 17:01:30,928 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:01:30,928 - INFO - [STEP 1] All 3 samples failed validation. Retrying 6/10...
2025-07-02 17:01:45,724 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 250, in visitBinOp
    rtype = self.visit(node.right)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 384, in visitMaxOp
    exp1type = self.visit(node.expr1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 389, in visitMaxOp
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: max is not defined on PolyExp and Int

Code:
transformer deeppoly{
    HardSwish ->
        ((prev[l]) >= 3) ?
            ((prev[l]), (prev[u]), (prev), (prev)) :
        (((prev[u]) <= -3) ?
            (0, 0, 0, 0) :
            (
                (min(prev[l], 0)),
                (max(prev[u], (prev[u]) * ((prev[u]) + 3) / 6)),
                ((prev) * (min(max((prev + 3) / 6, 0), 1))),
                ((prev) * (max(min((prev + 3) / 6, 1), 0)))
            )
        );
}

2025-07-02 17:01:45,724 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:01:45,962 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSwish ->
        ((prev[l]) >= 3) ?
            ((prev[l]), (prev[u]), (prev), (prev)) :
        (((prev[u]) <= -3) ?
            (0, 0, 0, 0) :
            (
                (prev[l] + prev[u])/6 + (min(prev[l],0) * max(prev[u],0))/6,
                (prev[u]) > 0 ? (prev[u]) : ((prev[u]+3)*prev[u]/6),
                ((prev+3)*prev)/6,
                (prev[u] > 0) ? (prev) : ((prev+3)*prev/6)
            )
        );
}

2025-07-02 17:01:45,962 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:01:46,842 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:01:46,842 - INFO - [STEP 1] All 3 samples failed validation. Retrying 7/10...
2025-07-02 17:02:10,841 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 250, in visitBinOp
    rtype = self.visit(node.right)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 249, in visitBinOp
    ltype = self.visit(node.left)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 385, in visitMaxOp
    exp2type = self.visit(node.expr2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 389, in visitMaxOp
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: min is not defined on Int and PolyExp

Code:
transformer deeppoly{
    HardSwish ->
        ((prev[l] >= 3)) ?
            ((prev[l]), (prev[u]), (prev), (prev))
        : ((prev[u] <= -3)) ?
            (0, 0, 0, 0)
        :
            (
                (min(prev[l], 0) + max(prev[u], 0)) * (max(0, min(6, prev[u] + 3)) / 6),
                max((prev[u]) * (max(0, min(6, prev[u] + 3)) / 6), (prev[l]) * (max(0, min(6, prev[l] + 3)) / 6)),
                prev * (max(0, min(6, prev + 3)) / 6),
                prev * (max(0, min(6, prev + 3)) / 6)
            );
}

2025-07-02 17:02:10,841 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:02:11,167 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    HardSwish ->
        (prev[l] >= 3) ?
            (prev[l], prev[u], prev, prev)
        : (prev[u] <= -3) ?
            (0, 0, 0, 0)
        : (
            0,
            max_op([
                ((prev[u] + 3) * prev[u]) / 6,
                0,
                ((prev[l] + 3) * prev[l]) / 6
            ]),
            prev * (prev + 3) / 6,
            prev * (prev + 3) / 6
        );
}

2025-07-02 17:02:11,167 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:02:11,403 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSwish ->
        (prev[l] >= 3) ? (
            prev[l],
            prev[u],
            prev,
            prev
        ) : (
            (prev[u] <= -3) ? (
                0,
                0,
                0,
                0
            ) : (
                // Middle region: input range overlaps with [-3, 3]
                // Lower bound
                (0,
                max((prev[u]*((prev[u]+3)/6)), (prev[l]*((prev[l]+3)/6)), 0),
                0,
                (prev * ((prev + 3) / 6)))
            )
        );
}

2025-07-02 17:02:11,403 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:02:11,403 - INFO - [STEP 1] All 3 samples failed validation. Retrying 8/10...
2025-07-02 17:02:28,228 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 249, in visitBinOp
    ltype = self.visit(node.left)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 249, in visitBinOp
    ltype = self.visit(node.left)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 250, in visitBinOp
    rtype = self.visit(node.right)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    HardSwish ->
        ((prev[l]) >= 3) ?
            ((prev[l]), (prev[u]), (prev), (prev))
        : (((prev[u]) <= -3) ?
            (0, 0, 0, 0)
        :
            (
                (prev[l] + (1.0/6.0) * (max_op(0, min_op(prev[u], prev[l] + 3))) - (1.0/6.0) * (max_op(0, min_op(prev[l], prev[u] + 3)))),
                (prev[u] + (1.0/6.0) * (max_op(0, min_op(prev[u], prev[u] + 3))) - (1.0/6.0) * (max_op(0, min_op(prev[l], prev[l] + 3)))),
                (prev * (max_op(0, min_op((prev + 3), 6)) / 6)),
                (prev * (max_op(0, min_op((prev + 3), 6)) / 6))
            )
        )
    ;
}

2025-07-02 17:02:28,228 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:02:28,652 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 43, in visit
    return self.visitTernary(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 438, in visitTernary
    ctype = self.visit(node.cond)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 43, in visit
    return self.visitTernary(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 448, in visitTernary
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Float and Bool are not lub_type

Code:
transformer deeppoly{
    HardSwish ->
        ((prev[u]) <= -3) ? (0, 0, 0, 0) :
        (((prev[l]) >= 3) ? ((prev[l]), (prev[u]), (prev), (prev)) :
        (
            (0,
             (((prev[u]) <= 0) ? ((prev[u]) * ((prev[u]) + 3) / 6) : ((prev[l]) >= 0) ? (prev[u]) : (max(prev[u], (prev[u]) * ((prev[u]) + 3) / 6))),
             ((prev * ((min(prev[u],3)) + 3)) / 6),
             ((prev * ((min(prev[u],3)) + 3)) / 6)
            )
        ));
}

2025-07-02 17:02:28,652 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:02:29,158 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:02:29,158 - INFO - [STEP 1] All 3 samples failed validation. Retrying 9/10...
2025-07-02 17:02:47,272 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 250, in visitBinOp
    rtype = self.visit(node.right)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 249, in visitBinOp
    ltype = self.visit(node.left)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 389, in visitMaxOp
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: min is not defined on PolyExp and Int

Code:
transformer deeppoly{
    HardSwish -> ((prev[l]) >= 3) ?
        ((prev[l]), (prev[u]), (prev), (prev)) :
        (((prev[u]) <= -3) ?
            (0, 0, 0, 0) :
            (
                ( ((prev[l]) >= 0) ? (prev[l] * ((prev[l] + 3) / 6)) : 0 ),
                ( ((prev[u]) <= 0) ? (prev[u] * ((prev[u] + 3) / 6)) : (prev[u]) ),
                prev * ((min(prev + 3, 6)) / 6),
                prev * ((max(prev + 3, 0)) / 6)
            )
        );
}

2025-07-02 17:02:47,272 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:02:47,505 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardSwish ->
        (prev[l] >= 3) ?
            (prev[l], prev[u], prev, prev)
        : (prev[u] <= -3) ?
            (0, 0, 0, 0)
        : (
            0,
            maxOpList([0, prev[u], ((prev[u]+3) * prev[u] / 6), ((prev[l]+3) * prev[l] / 6)]),
            prev * (prev + 3) / 6,
            prev * (prev + 3) / 6
        );
}

2025-07-02 17:02:47,505 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:02:47,845 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 728, in visitTransRetBasic
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Expression in transformer is different from shape declaration

Code:
transformer deeppoly{
    HardSwish ->
        ((prev[l]) >= 3) ? (
            (prev[l]),
            (prev[u]),
            (prev),
            (prev)
        ) :
        ((prev[u]) <= -3) ? (
            0,
            0,
            0,
            0
        ) :
        (
            // lower bound
            ((prev[l]) >= 0) ?
                (prev[l] * (prev[l] + 3) / 6)
            :
                0,
            // upper bound
            ((prev[u]) <= 0) ?
                (prev[u] * (prev[u] + 3) / 6)
            :
                (prev[u]),
            // lower poly
            ((prev[l]) >= 0) ?
                (prev * (prev + 3) / 6)
            :
                0,
            // upper poly
            ((prev[u]) <= 0) ?
                (prev * (prev + 3) / 6)
            :
                (prev)
        );
}

2025-07-02 17:02:47,845 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:02:47,845 - INFO - [STEP 1] All 3 samples failed validation. Retrying 10/10...
2025-07-02 17:02:47,845 - INFO - [HardSwish] Runtime: 193.39 seconds
2025-07-02 17:02:47,845 - ERROR - Failed with Error:[STEP 1] Failed after 10 retries.
 during generating code:
transformer deeppoly{
    HardSwish ->
        ((prev[l]) >= 3) ? (
            (prev[l]),
            (prev[u]),
            (prev),
            (prev)
        ) :
        ((prev[u]) <= -3) ? (
            0,
            0,
            0,
            0
        ) :
        (
            // lower bound
            ((prev[l]) >= 0) ?
                (prev[l] * (prev[l] + 3) / 6)
            :
                0,
            // upper bound
            ((prev[u]) <= 0) ?
                (prev[u] * (prev[u] + 3) / 6)
            :
                (prev[u]),
            // lower poly
            ((prev[l]) >= 0) ?
                (prev * (prev + 3) / 6)
            :
                0,
            // upper poly
            ((prev[u]) <= 0) ?
                (prev * (prev + 3) / 6)
            :
                (prev)
        );
}

2025-07-02 17:02:47,845 - INFO - 2025-07-02 17:02:47.845687 - Extracting HardTanh
2025-07-02 17:02:47,845 - INFO -
API: HardTanh -> Model: gpt-4o @ http://ggnds-serv-01.cs.illinois.edu:8084
2025-07-02 17:02:47,845 - INFO - [STEP 1] Starting step 1/1
2025-07-02 17:03:10,772 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        (prev[l] >= 1) ? (1, 1, 1, 1)
        : (prev[u] <= -1) ? (-1, -1, -1, -1)
        : (prev[l] >= -1 && prev[u] <= 1) ? (prev[l], prev[u], prev, prev)
        : (prev[l] < -1 && prev[u] <= 1) ? (-1, prev[u], -1, prev)
        : (prev[l] >= -1 && prev[u] > 1) ? (prev[l], 1, prev, 1)
        : (-1, 1, -1, 1);
}

2025-07-02 17:03:10,772 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:03:11,001 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        (prev[l] >= 1) ? (1, 1, 1, 1) :
        (prev[u] <= -1) ? (-1, -1, -1, -1) :
        (prev[l] >= -1 && prev[u] <= 1) ? (prev[l], prev[u], prev, prev) :
        (prev[l] < -1 && prev[u] > 1) ? (-1, 1, prev, prev) :
        (prev[l] < -1) ?
            (-1, prev[u], prev*(prev[u]-(-1))/(prev[u]-(prev[l])) + ((-1-prev[u])*(prev[l])/((prev[u])-prev[l])), prev) :
        (prev[u] > 1) ?
            (prev[l], 1, prev, prev*(1-prev[l])/(prev[u]-prev[l]) + ((prev[u]-1)*prev[l])/(prev[u]-prev[l]))) :
        (prev[l], prev[u], prev, prev);
}

2025-07-02 17:03:11,002 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:03:11,233 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        ((prev[u]) <= -1) ?
            (-1, -1, -1, -1)
        :
        ((prev[l]) >= 1) ?
            (1, 1, 1, 1)
        :
        ((prev[l] >= -1) && (prev[u] <= 1)) ?
            (prev[l], prev[u], prev, prev)
        :
        ((prev[l] < -1) && (prev[u] <= 1)) ?
            (-1, prev[u], -1, prev)
        :
        ((prev[l] >= -1) && (prev[u] > 1)) ?
            (prev[l], 1, prev, 1)
        :
            (-1, 1, -1, 1);
}

2025-07-02 17:03:11,233 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:03:11,234 - INFO - [STEP 1] All 3 samples failed validation. Retrying 1/10...
2025-07-02 17:03:30,217 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        (prev[u] <= -1) ? (-1, -1, -1, -1) :
        (prev[l] >= 1) ? (1, 1, 1, 1) :
        (prev[l] >= -1 && prev[u] <= 1) ? (prev[l], prev[u], prev, prev) :
        (prev[l] < -1 && prev[u] > 1) ? (-1, 1, prev*(2/(prev[u]-prev[l])) - (prev[l]+prev[u])/(prev[u]-prev[l]), prev*(2/(prev[u]-prev[l])) - (prev[l]+prev[u])/(prev[u]-prev[l])) :
        (prev[l] < -1) ? (-1, prev[u], prev*((prev[u]+1)/(prev[u]-prev[l])) - (prev[l]+1)/(prev[u]-prev[l]), prev) :
        (prev[u] > 1) ? (prev[l], 1, prev, prev*((1-prev[l])/(prev[u]-prev[l])) + (prev[u]-1)/(prev[u]-prev[l])) :
        (prev[l], prev[u], prev, prev);
}

2025-07-02 17:03:30,217 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:03:30,453 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        (prev[l] >= 1) ? (1, 1, 1, 1) :
        (prev[u] <= -1) ? (-1, -1, -1, -1) :
        (prev[l] >= -1 && prev[u] <= 1) ? (prev[l], prev[u], prev, prev) :
        (prev[l] < -1 && prev[u] > 1) ? (-1, 1, prev, prev) :
        (prev[l] < -1) ? (-1, max(prev[u], -1), prev, (prev[u] - (-1)) / (prev[u] - prev[l]) * prev - (prev[u] * (-1)) / (prev[u] - prev[l])) :
        (prev[u] > 1) ? (min(prev[l], 1), 1, (1 - prev[l]) / (prev[u] - prev[l]) * prev + (prev[u] - 1) / (prev[u] - prev[l]), prev) :
        (prev[l], prev[u], prev, prev);
}

2025-07-02 17:03:30,453 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:03:30,692 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh -> ((prev[u] <= -1) ? (-1, -1, -1, -1) :
                ((prev[l] >= 1) ? (1, 1, 1, 1) :
                ((prev[l] >= -1) & (prev[u] <= 1) ? (prev[l], prev[u], prev, prev) :
                ((prev[l] < -1) & (prev[u] > 1) ? (-1, 1, prev*(2/(prev[u]-prev[l])) - ((prev[u]+prev[l])/(prev[u]-prev[l])), prev*(2/(prev[u]-prev[l])) - ((prev[u]+prev[l])/(prev[u]-prev[l]))) :
                ((prev[l] < -1) & (prev[u] <= 1) ? (-1, prev[u], ((prev[u]+1)/(prev[u]-prev[l]))*prev - ((prev[u]+1)*prev[l]/(prev[u]-prev[l])) , prev) :
                ((prev[l] >= -1) & (prev[u] > 1) ? (prev[l], 1, prev, ((1-prev[l])/(prev[u]-prev[l]))*prev + (prev[u]-1)*prev[l]/(prev[u]-prev[l])) :
                (prev[l], prev[u], prev, prev)
                ))))));
}

2025-07-02 17:03:30,692 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:03:30,692 - INFO - [STEP 1] All 3 samples failed validation. Retrying 2/10...
2025-07-02 17:03:45,428 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:03:45,663 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        (prev[l] >= 1) ? (1, 1, 1, 1) :
        (prev[u] <= -1) ? (-1, -1, -1, -1) :
        (prev[l] >= -1 && prev[u] <= 1) ? (prev[l], prev[u], prev, prev) :
        (prev[l] < -1 && prev[u] <= 1) ? (-1, prev[u], -1, prev) :
        (prev[l] >= -1 && prev[u] > 1) ? (prev[l], 1, prev, 1) :
        (prev[l] < -1 && prev[u] > 1) ? (-1, 1, -1, 1) :
        (prev[l], prev[u], prev, prev);
}

2025-07-02 17:03:45,663 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:03:45,892 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        ((prev[l] >= 1) ? (1, 1, 1, 1)
        : (prev[u] <= -1) ? (-1, -1, -1, -1)
        : (prev[l] >= -1 && prev[u] <= 1) ? (prev[l], prev[u], prev, prev)
        : (prev[l] < -1 && prev[u] > 1) ? (-1, 1, prev, prev)
        : (prev[l] < -1) ? (-1, prev[u], -1, ((prev[u] + 1)/(prev[u]-prev[l]))*prev - (prev[u]+1)*prev[l]/(prev[u]-prev[l])))
        : (prev[u] > 1) ? (prev[l], 1, ((1-prev[l])/(prev[u]-prev[l]))*prev + (prev[u]-1)*prev[l]/(prev[u]-prev[l]), 1)
        : (0, 0, 0, 0));
}

2025-07-02 17:03:45,892 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:03:45,892 - INFO - [STEP 1] All 3 samples failed validation. Retrying 3/10...
2025-07-02 17:04:10,734 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        (prev[u] <= -1) ? (-1, -1, -1, -1)
        : (prev[l] >= 1) ? (1, 1, 1, 1)
        : (prev[l] >= -1 && prev[u] <= 1) ? (prev[l], prev[u], prev, prev)
        : (prev[l] < -1 && prev[u] <= 1) ? (-1, prev[u], -1, (prev - prev[l]) * ((prev[u] - 1) / (prev[u] - prev[l])) + 1)
        : (prev[l] >= -1 && prev[u] > 1) ? (prev[l], 1, prev, (prev - prev[u]) * ((1 - prev[l]) / (prev[u] - prev[l])) + prev[l])
        : (-1, 1, -1, 1);
}

2025-07-02 17:04:10,734 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:04:10,966 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        ((prev[l] >= 1) ? (1, 1, 1, 1) :
        ((prev[u] <= -1) ? (-1, -1, -1, -1) :
            (0 <= prev[l] && prev[u] <= 1) ? (prev[l], prev[u], prev, prev) :
            (prev[l] < -1 && prev[u] > 1) ? (-1, 1, prev, prev) :
            (prev[l] < -1) ? (-1, max_op(prev[u], 1), -1, prev + ((1 - prev[u])/(prev[u] - prev[l]))*(prev - prev[l]) ) :
            (prev[u] > 1) ? (min_op(prev[l], 1), 1, prev + ((-1 - prev[l])/(prev[u] - prev[l]))*(prev - prev[u]), 1) :
            (max(-1, prev[l]), min(1, prev[u]), prev, prev)
        )
    );
}

2025-07-02 17:04:10,966 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:04:11,207 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        (prev[u] <= -1) ?
            (-1, -1, -1, -1) :
        (prev[l] >= 1) ?
            (1, 1, 1, 1) :
        (prev[l] >= -1 && prev[u] <= 1) ?
            (prev[l], prev[u], prev, prev) :
        (prev[l] < -1 && prev[u] <= 1) ?
            (-1, prev[u], -1, prev) :
        (prev[l] >= -1 && prev[u] > 1) ?
            (prev[l], 1, prev, 1) :
        (prev[l] < -1 && prev[u] > 1) ?
            (-1, 1, -1, 1) :
        (prev[l], prev[u], prev, prev);
}

2025-07-02 17:04:11,207 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:04:11,207 - INFO - [STEP 1] All 3 samples failed validation. Retrying 4/10...
2025-07-02 17:04:28,549 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh -> (
        (prev[l] >= 1) ? 1 :
        (prev[u] <= -1) ? -1 :
        (prev[l] < -1 && prev[u] > 1) ? -1 :
        max(prev[l], -1),

        (prev[u] <= -1) ? -1 :
        (prev[l] >= 1) ? 1 :
        (prev[u] > 1 && prev[l] < -1) ? 1 :
        min(prev[u], 1),

        (prev[l] >= 1) ? 1 :
        (prev[u] <= -1) ? -1 :
        (prev[l] < -1 && prev[u] > 1) ? -1 :
        (prev[l] < -1) ? 0.5 * ((1 + prev[u])/(prev[u] - prev[l])) * (prev - prev[l]) - 1 : prev,

        (prev[u] <= -1) ? -1 :
        (prev[l] >= 1) ? 1 :
        (prev[u] > 1) ? 0.5 * ((1 - prev[l])/(prev[u] - prev[l])) * (prev - prev[l]) + prev[l] : prev
    );
}

2025-07-02 17:04:28,549 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:04:28,796 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        (prev[u] <= -1) ?
            (-1, -1, -1, -1) :
        (prev[l] >= 1) ?
            (1, 1, 1, 1) :
        (prev[l] >= -1 && prev[u] <= 1) ?
            (prev[l], prev[u], prev, prev) :
        (prev[l] < -1 && prev[u] > 1) ?
            (-1, 1, prev, prev) :
        (prev[l] < -1 && prev[u] <= 1) ?
            (-1, prev[u], -1, ((prev[u] + 1) / (prev[u] - prev[l])) * prev - ((prev[u] + 1) * prev[l]) / (prev[u] - prev[l]))) :
        (prev[l] >= -1 && prev[u] > 1) ?
            (prev[l], 1, prev, ((1 - prev[l]) / (prev[u] - prev[l])) * prev + ((prev[u] - 1) * (-prev[l])) / (prev[u] - prev[l]))) ;
}

2025-07-02 17:04:28,796 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:04:29,039 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        ((prev[u]) <= -1) ?
            (-1, -1, -1, -1)
        : (
            (prev[l] >= 1) ?
                (1, 1, 1, 1)
            : (
                (prev[l] >= -1 && prev[u] <= 1) ?
                    (prev[l], prev[u], prev, prev)
                : (
                    (prev[l] < -1 && prev[u] <= 1) ?
                        (0, prev[u], 0, prev - ((prev[l] + 1) * prev) / (prev[u] - prev[l]) + (prev[u] * (prev[l] + 1)) / (prev[u] - prev[l]))
                    : (
                        (prev[l] >= -1 && prev[u] > 1) ?
                            (prev[l], 1, prev, prev * (1 - prev[l]) / (prev[u] - prev[l]) + (prev[u] * (1 - prev[l])) / (prev[u] - prev[l]))
                        :
                            (0, 1, 0, 1)
                    )
                )
            )
        );
}

2025-07-02 17:04:29,040 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:04:29,040 - INFO - [STEP 1] All 3 samples failed validation. Retrying 5/10...
2025-07-02 17:04:49,443 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        (prev[l] >= 1) ? (1, 1, 1, 1) :
        (prev[u] <= -1) ? (-1, -1, -1, -1) :
        (
            max(-1, prev[l]),
            min(1, prev[u]),
            (prev[l] >= -1) ? ((prev[u] <= 1) ? prev : ((1 - prev[l])/(prev[u] - prev[l])) * prev + (prev[u] - 1)/(prev[u] - prev[l])) :
                             ((prev[u] <= 1) ? ((-1 - prev[l])/(prev[u] - prev[l])) * prev + (prev[u] + 1)/(prev[u] - prev[l]) : 0),
            (prev[u] <= 1 && prev[l] >= -1) ? prev :
                ((prev[u] > 1 && prev[l] < -1) ? 0 :
                    ((prev[u] > 1) ? ((1 - prev[l])/(prev[u] - prev[l]))*prev + (prev[u] - 1)/(prev[u] - prev[l]) :
                        ((prev[l] < -1) ? ((-1 - prev[l])/(prev[u] - prev[l]))*prev + (prev[u] + 1)/(prev[u] - prev[l]) : prev)))
        );
}

2025-07-02 17:04:49,443 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:04:49,688 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        (prev[l] >= 1) ? (1, 1, 1, 1)
        : (prev[u] <= -1) ? (-1, -1, -1, -1)
        : (prev[l] >= -1 && prev[u] <= 1) ? (prev[l], prev[u], prev, prev)
        : (prev[l] < -1 && prev[u] > 1) ? (-1, 1, prev * 2 / (prev[u] - prev[l]) - (prev[u] + prev[l]) / (prev[u] - prev[l]), prev * 2 / (prev[u] - prev[l]) - (prev[u] + prev[l]) / (prev[u] - prev[l]))
        : (prev[l] < -1) ? ( -1, prev[u] <= 1 ? prev[u] : 1, ((prev * (prev[u] - 1) ) / (prev[u] - prev[l]) + ( (1 - prev[l]) * (-1) ) / (prev[u] - prev[l]) ), prev[u] <= 1 ? prev : (prev * 2 / (prev[u] - prev[l]) - (prev[u] + prev[l]) / (prev[u] - prev[l])) )
        : ( prev[u] > 1 ? (prev[l] >= -1 ? prev[l] : -1 , 1, prev[l] >= -1 ? prev : (prev * 2 / (prev[u] - prev[l]) - (prev[u] + prev[l]) / (prev[u] - prev[l])) , (prev * (1 - prev[l]) / (prev[u] - prev[l]) + (prev[u] - 1) / (prev[u] - prev[l]) * 1) )
        : (prev[l], prev[u], prev, prev));
}

2025-07-02 17:04:49,689 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:04:49,942 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        (prev[l] >= 1) ? (1, 1, 1, 1) :
        (prev[u] <= -1) ? (-1, -1, -1, -1) :
        (prev[l] >= -1 && prev[u] <= 1) ? (prev[l], prev[u], prev, prev) :
        (prev[l] < -1 && prev[u] <= 1) ? (-1, prev[u], -1, prev) :
        (prev[l] >= -1 && prev[u] > 1) ? (prev[l], 1, prev, 1) :
        (-1, 1, prev * ((prev[u] + 1) / (prev[u] - prev[l])) - ((prev[u] + 1) * prev[l] / (prev[u] - prev[l])), prev * ((1 - prev[l]) / (prev[u] - prev[l])) + ((prev[u] - 1) * 1 / (prev[u] - prev[l])));
}

2025-07-02 17:04:49,943 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:04:49,943 - INFO - [STEP 1] All 3 samples failed validation. Retrying 6/10...
2025-07-02 17:05:10,735 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        (prev[l] >= 1) ? (1, 1, 1, 1) :
        (prev[u] <= -1) ? (-1, -1, -1, -1) :
        (prev[l] >= -1 && prev[u] <= 1) ? (prev[l], prev[u], prev, prev) :
        (prev[l] < -1 && prev[u] > 1) ? (-1, 1, ((prev - prev[l]) * (1 - (-1)) / (prev[u] - prev[l])) + (-1), ((prev - prev[l]) * (1 - (-1)) / (prev[u] - prev[l])) + (-1)) :
        (prev[l] < -1) ? (-1, prev[u], ((prev - prev[l]) * (prev[u] - (-1)) / (prev[u] - prev[l])) + (-1), ((prev - prev[l]) * (prev[u] - (-1)) / (prev[u] - prev[l])) + (-1)) :
        (prev[u] > 1) ? (prev[l], 1, ((prev - prev[l]) * (1 - prev[l]) / (prev[u] - prev[l])) + prev[l], ((prev - prev[l]) * (1 - prev[l]) / (prev[u] - prev[l])) + prev[l]) ;
}

2025-07-02 17:05:10,738 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:05:11,122 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        ((prev[u]) <= -1) ? (-1, -1, -1, -1) :
        ((prev[l]) >= 1) ? (1, 1, 1, 1) :
        ((prev[l]) >= -1 && (prev[u]) <= 1) ? (prev[l], prev[u], prev, prev) :
        ((prev[l]) < -1 && (prev[u]) <= 1) ? (-1, prev[u], -1, prev) :
        ((prev[l]) >= -1 && (prev[u]) > 1) ? (prev[l], 1, prev, 1) :
        (-1, 1, -1, 1);
}

2025-07-02 17:05:11,122 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:05:11,350 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        ((prev[l] >= 1)) ? (1, 1, 1, 1)
        : ((prev[u] <= -1)) ? (-1, -1, -1, -1)
        : ((prev[l] >= -1) & (prev[u] <= 1)) ? (prev[l], prev[u], prev, prev)
        : ((prev[l] < -1) & (prev[u] > 1)) ? (-1, 1, prev, prev)
        : ((prev[l] < -1) & (prev[u] <= 1)) ? (-1, prev[u], 0.5 * (prev + 1) - 1, prev)
        : ((prev[l] >= -1) & (prev[u] > 1)) ? (prev[l], 1, prev, 0.5 * (prev - 1) + 1)
        : (prev[l], prev[u], prev, prev);
}

2025-07-02 17:05:11,350 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:05:11,350 - INFO - [STEP 1] All 3 samples failed validation. Retrying 7/10...
2025-07-02 17:05:23,932 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:05:24,178 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh -> ((prev[u] <= -1) ? (-1, -1, -1, -1) : ((prev[l] >= 1) ? (1, 1, 1, 1) : ((prev[l] >= -1 && prev[u] <= 1) ? (prev[l], prev[u], prev, prev) : ((prev[l] < -1 && prev[u] <= 1) ? (0, prev[u], 0, prev) : ((prev[l] >= -1 && prev[u] > 1) ? (prev[l], 1, prev, 1) : (-1, 1, prev, prev)))));
}

2025-07-02 17:05:24,178 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:05:24,415 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        (prev[l] >= 1) ? (1, 1, 1, 1) :
        ((prev[u] <= -1) ? (-1, -1, -1, -1) :
            (0 <= prev[l] && prev[u] <= 1) ? (prev[l], prev[u], prev, prev) :
            (prev[l] < -1 && prev[u] > 1) ? (-1, 1, prev, prev) :
            (prev[l] < -1) ? (-1, min(prev[u], 1), -1, (prev - prev[l]) / (prev[u] - prev[l]) * (min(prev[u],1) + 1) - 1) :
            (prev[u] > 1) ? (max(prev[l], -1), 1, (prev - prev[u]) / (prev[u] - prev[l]) * (1 - max(prev[l],-1)) + 1, 1) :
            (max(prev[l], -1), min(prev[u], 1), prev, prev)
        );
}

2025-07-02 17:05:24,415 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:05:24,415 - INFO - [STEP 1] All 3 samples failed validation. Retrying 8/10...
2025-07-02 17:05:39,682 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        (prev[l] >= 1) ? (1, 1, 1, 1) :
        (prev[u] <= -1) ? (-1, -1, -1, -1) :
        (prev[l] >= -1 && prev[u] <= 1) ? (prev[l], prev[u], prev, prev) :
        (prev[l] < -1 && prev[u] > 1) ? (-1, 1, ((prev - prev[l])/(prev[u] - prev[l]) * 2) - 1, ((prev - prev[l])/(prev[u] - prev[l]) * 2) - 1) :
        (prev[l] < -1) ? (-1, prev[u], (-1), ((prev - prev[l])/(prev[u] - prev[l])) * (prev[u] + 1) + (-1)) :
        (prev[u] > 1) ? (prev[l], 1, ((prev - prev[l])/(prev[u] - prev[l])) * (1 - prev[l]) + prev[l], (1)) :
        (prev[l], prev[u], prev, prev);
}

2025-07-02 17:05:39,682 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:05:39,926 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        (prev[l] >= 1) ? (1, 1, 1, 1)
        : (prev[u] <= -1) ? (-1, -1, -1, -1)
        : (prev[l] >= -1 && prev[u] <= 1) ? (prev[l], prev[u], prev, prev)
        : (prev[l] < -1 && prev[u] <= 1) ? (-1, prev[u], -1, (prev - prev[l])/(prev[u] - prev[l]) * (prev - prev[l]) + (-1))
        : (prev[l] >= -1 && prev[u] > 1) ? (prev[l], 1, prev, (prev[u] - prev)/(prev[u] - prev[l]) * (1 - prev[l]) + prev[l])
        : (-1, 1, prev, ((prev[u]-prev)/(prev[u]-prev[l]))*(1-prev[l])+((prev-prev[l])/(prev[u]-prev[l]))*(-1-prev[u])+prev[l]);
}

2025-07-02 17:05:39,926 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:05:40,161 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        (prev[l] >= 1) ? (1, 1, 1, 1)
        : (prev[u] <= -1) ? (-1, -1, -1, -1)
        : (prev[l] >= -1 && prev[u] <= 1) ? (prev[l], prev[u], prev, prev)
        : (prev[l] < -1 && prev[u] > 1) ? (-1, 1, prev, prev)
        : (prev[l] < -1) ? (-1, (prev[u] < 1) ? prev[u] : 1, (prev[l] + 1)/(prev[u] - prev[l]) * (prev - prev[l]) - (prev[l] + 1)/(prev[u] - prev[l]) * (prev - prev[u]) - 1, (prev[u] < 1) ? prev : 1)
        : ((prev[u] > 1) ? ((prev[l] > -1) ? (prev[l], 1, prev, 1) : (-1, 1, prev, 1)) : (prev[l], prev[u], prev, prev));
}

2025-07-02 17:05:40,161 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:05:40,161 - INFO - [STEP 1] All 3 samples failed validation. Retrying 9/10...
2025-07-02 17:06:10,504 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        (prev[l] >= 1) ? (1, 1, 1, 1) :
        (prev[u] <= -1) ? (-1, -1, -1, -1) :
        (prev[l] >= -1 && prev[u] <= 1) ? (prev[l], prev[u], prev, prev) :
        (prev[l] < -1 && prev[u] > 1) ? (-1, 1, prev, prev) :
        (prev[l] < -1) ? (-1, prev[u], -1, (prev - prev[l])/(prev[u] - prev[l]) * (prev[u] - 1) + 1) :
        (prev[u] > 1) ? (prev[l], 1, (prev - prev[u])/(prev[u] - prev[l]) * (1 - prev[l]) + prev[l], 1) :
        (prev[l], prev[u], prev, prev);
}

2025-07-02 17:06:10,504 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:06:10,758 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        ((prev[u]) <= -1) ? (-1, -1, -1, -1) :
        (
            (prev[l] >= 1) ? (1, 1, 1, 1) :
            (
                (prev[l] >= -1 && prev[u] <= 1) ? (prev[l], prev[u], prev, prev) :
                (
                    (prev[l] < -1 && prev[u] <= 1) ? (0, prev[u], 0, prev) :
                    (
                        (prev[l] >= -1 && prev[u] > 1) ? (prev[l], 1, prev, 1) :
                        (0, 1, 0, 1)
                    )
                )
            )
        );
}

2025-07-02 17:06:10,758 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:06:10,993 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    HardTanh ->
        (prev[u] <= -1) ? (-1, -1, -1, -1) :
        (prev[l] >= 1) ? (1, 1, 1, 1) :
        (prev[l] >= -1 && prev[u] <= 1) ? (prev[l], prev[u], prev, prev) :
        (prev[l] < -1 && prev[u] > 1) ? (-1, 1, prev, prev) :
        (prev[l] < -1) ? (-1, min(prev[u], 1), prev*(min(prev[u], 1) + 1)/(min(prev[u], 1) - prev[l]) - ((2*min(prev[u], 1)*prev[l])/(min(prev[u], 1) - prev[l])), min(prev[u], 1)) :
        (prev[u] > 1) ? (max(prev[l], -1), 1, max(prev[l], -1), prev*(1 - max(prev[l], -1))/(prev[u] - max(prev[l], -1)) + (prev[u]*max(prev[l], -1))/(prev[u] - max(prev[l], -1))) :
        (prev[l], prev[u], prev, prev);
}

2025-07-02 17:06:10,994 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:06:10,994 - INFO - [STEP 1] All 3 samples failed validation. Retrying 10/10...
2025-07-02 17:06:10,994 - INFO - [HardTanh] Runtime: 203.15 seconds
2025-07-02 17:06:10,994 - ERROR - Failed with Error:[STEP 1] Failed after 10 retries.
 during generating code:
transformer deeppoly{
    HardTanh ->
        (prev[u] <= -1) ? (-1, -1, -1, -1) :
        (prev[l] >= 1) ? (1, 1, 1, 1) :
        (prev[l] >= -1 && prev[u] <= 1) ? (prev[l], prev[u], prev, prev) :
        (prev[l] < -1 && prev[u] > 1) ? (-1, 1, prev, prev) :
        (prev[l] < -1) ? (-1, min(prev[u], 1), prev*(min(prev[u], 1) + 1)/(min(prev[u], 1) - prev[l]) - ((2*min(prev[u], 1)*prev[l])/(min(prev[u], 1) - prev[l])), min(prev[u], 1)) :
        (prev[u] > 1) ? (max(prev[l], -1), 1, max(prev[l], -1), prev*(1 - max(prev[l], -1))/(prev[u] - max(prev[l], -1)) + (prev[u]*max(prev[l], -1))/(prev[u] - max(prev[l], -1))) :
        (prev[l], prev[u], prev, prev);
}

2025-07-02 17:06:10,994 - INFO - 2025-07-02 17:06:10.994549 - Extracting Maxpool
2025-07-02 17:06:10,994 - INFO -
API: Maxpool -> Model: gpt-4o @ http://ggnds-serv-01.cs.illinois.edu:8084
2025-07-02 17:06:10,994 - INFO - [STEP 1] Starting step 1/1
2025-07-02 17:06:15,962 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Maxpool -> (
        max_op(prev[l]),
        max_op(prev[u]),
        max_op(prev),
        max_op(prev)
    );
}

2025-07-02 17:06:15,962 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:06:16,281 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Maxpool -> (max_op(list_op(prev[l])), max_op(list_op(prev[u])), max_op(list_op(prev[L])), max_op(list_op(prev[U])));
}

2025-07-02 17:06:16,281 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:06:16,672 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Maxpool -> (
        max_op(prev[l]),
        max_op(prev[u]),
        max_op(prev),
        max_op(prev)
    );
}

2025-07-02 17:06:16,673 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:06:16,673 - INFO - [STEP 1] All 3 samples failed validation. Retrying 1/10...
2025-07-02 17:06:23,298 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Maxpool ->
        max_idx = argmax(prev_list.map(lambda n: n[u]));
        max_u = prev_list[max_idx][u];
        min_l = prev_list.map(lambda n: n[l]).max();
        max_L = prev_list[max_idx];
        max_U = prev_list[max_idx];
        (min_l, max_u, max_L, max_U);
}

2025-07-02 17:06:23,298 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:06:23,541 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: maxOp is not defined

Code:
transformer deeppoly{
    Maxpool -> (maxOp(prev[l]), maxOp(prev[u]), maxOp(prev), maxOp(prev));
}

2025-07-02 17:06:23,541 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:06:23,779 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: maxOpList is not defined

Code:
transformer deeppoly{
    Maxpool -> (
        maxOpList(prev[l]),
        maxOpList(prev[u]),
        maxOpList(prev),
        maxOpList(prev)
    );
}

2025-07-02 17:06:23,779 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:06:23,779 - INFO - [STEP 1] All 3 samples failed validation. Retrying 2/10...
2025-07-02 17:06:35,456 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Maxpool ->
        (max_op(prev[l]),
         max_op(prev[u]),
         max_op(prev[L]),
         max_op(prev[U]));
}

2025-07-02 17:06:35,456 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:06:35,696 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Maxpool -> (max_op(prev[l]), max_op(prev[u]), max_op(prev), max_op(prev));
}

2025-07-02 17:06:35,696 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:06:36,528 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: maxOpList is not defined

Code:
transformer deeppoly{
    Maxpool ->
        (maxOpList([prev_0[l], prev_1[l], prev_2[l], prev_3[l]]),
         maxOpList([prev_0[u], prev_1[u], prev_2[u], prev_3[u]]),
         // Lower PolyExp
         (prev_0[u] >= maxOpList([prev_1[u], prev_2[u], prev_3[u]])) ? (prev_0) :
         (prev_1[u] >= maxOpList([prev_0[u], prev_2[u], prev_3[u]])) ? (prev_1) :
         (prev_2[u] >= maxOpList([prev_0[u], prev_1[u], prev_3[u]])) ? (prev_2) : (prev_3),
         // Upper PolyExp
         (prev_0[u] >= maxOpList([prev_1[u], prev_2[u], prev_3[u]])) ? (prev_0) :
         (prev_1[u] >= maxOpList([prev_0[u], prev_2[u], prev_3[u]])) ? (prev_1) :
         (prev_2[u] >= maxOpList([prev_0[u], prev_1[u], prev_3[u]])) ? (prev_2) : (prev_3)
        );
}

2025-07-02 17:06:36,528 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:06:36,528 - INFO - [STEP 1] All 3 samples failed validation. Retrying 3/10...
2025-07-02 17:06:44,426 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: maxOpList is not defined

Code:
transformer deeppoly{
    Maxpool ->
        (
            maxOpList([prev_0[l], prev_1[l], prev_2[l], prev_3[l], prev_4[l]]),
            maxOpList([prev_0[u], prev_1[u], prev_2[u], prev_3[u], prev_4[u]]),
            maxOpList([prev_0, prev_1, prev_2, prev_3, prev_4]),
            maxOpList([prev_0, prev_1, prev_2, prev_3, prev_4])
        );
}

2025-07-02 17:06:44,426 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:06:44,665 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Maxpool ->
        (
            max_op(prev[l]),
            max_op(prev[u]),
            max_op(prev),
            max_op(prev)
        );
}

2025-07-02 17:06:44,666 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:06:44,892 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Maxpool ->
        max_idx = argmaxOp(prev[l], prev[u]);
        (
            prev[l][max_idx],                     // lower bound is lower of argmax
            prev[u][max_idx],                     // upper bound is upper of argmax
            prev[L][max_idx],                     // lower poly is poly of argmax lower
            prev[U][max_idx]                      // upper poly is poly of argmax upper
        );
}

2025-07-02 17:06:44,892 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:06:44,892 - INFO - [STEP 1] All 3 samples failed validation. Retrying 4/10...
2025-07-02 17:06:49,746 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Maxpool -> (max_op(prev[l]), max_op(prev[u]), max_op(prev), max_op(prev));
}

2025-07-02 17:06:49,746 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:06:49,992 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Maxpool -> (max_op(prev[l]), max_op(prev[u]), max_op(prev), max_op(prev));
}

2025-07-02 17:06:49,992 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:06:50,232 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Maxpool -> (maxOpList([PREVLIST[l]]), maxOpList([PREVLIST[u]]), maxOpList([PREVLIST]), maxOpList([PREVLIST]))
}

2025-07-02 17:06:50,232 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:06:50,232 - INFO - [STEP 1] All 3 samples failed validation. Retrying 5/10...
2025-07-02 17:06:55,236 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Maxpool -> (
        max_op(prev[l]),
        max_op(prev[u]),
        max_op(prev),
        max_op(prev)
    );
}

2025-07-02 17:06:55,236 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:06:55,462 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Maxpool ->
        (max_op([prev_list.map(x -> x[l])]),                          // lower bound l
         max_op([prev_list.map(x -> x[u])]),                          // upper bound u
         max_op([prev_list.map(x -> x[L])]),                          // lower PolyExp L
         max_op([prev_list.map(x -> x[U])]));                         // upper PolyExp U
}

2025-07-02 17:06:55,463 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:07:10,806 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Maxpool -> (
        max_op(prev[l]),
        max_op(prev[u]),
        max_op(prev),
        max_op(prev)
    );
}

2025-07-02 17:07:10,806 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:07:10,806 - INFO - [STEP 1] All 3 samples failed validation. Retrying 6/10...
2025-07-02 17:07:17,760 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: maxOp is not defined

Code:
transformer deeppoly{
    Maxpool -> (maxOp(prev_list[l]), maxOp(prev_list[u]), maxOp(prev_list[L]), maxOp(prev_list[U]));
}

2025-07-02 17:07:17,760 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:07:18,064 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Maxpool -> (max_op([prev_0[l], prev_1[l], prev_2[l], prev_3[l]]),    // adjust input count as needed
                max_op([prev_0[u], prev_1[u], prev_2[u], prev_3[u]]),
                max_op([prev_0, prev_1, prev_2, prev_3]),               // over poly
                max_op([prev_0, prev_1, prev_2, prev_3])
    );
}

2025-07-02 17:07:18,065 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:07:18,308 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Maxpool -> (max_op(prev_0[l], prev_1[l]), max_op(prev_0[u], prev_1[u]), max_op(prev_0, prev_1), max_op(prev_0, prev_1));
}

2025-07-02 17:07:18,308 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:07:18,308 - INFO - [STEP 1] All 3 samples failed validation. Retrying 7/10...
2025-07-02 17:07:24,481 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Maxpool ->
        max_idx = argmax(prev_list[curr_list], curr_list),
        (prev_list[max_idx][l], prev_list[max_idx][u], prev_list[max_idx], prev_list[max_idx]);
}

2025-07-02 17:07:24,481 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:07:24,717 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Maxpool -> (max_op(prev[l]), max_op(prev[u]), max_op(prev[L]), max_op(prev[U]));
}

2025-07-02 17:07:24,717 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:07:24,943 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Maxpool ->
        (max_op(prev_list.map(x -> x[l])),
         max_op(prev_list.map(x -> x[u])),
         max_op(prev_list.map(x -> x[L])),
         max_op(prev_list.map(x -> x[U])));
}

2025-07-02 17:07:24,944 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:07:24,944 - INFO - [STEP 1] All 3 samples failed validation. Retrying 8/10...
2025-07-02 17:07:30,435 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Maxpool -> (max_op(prev_list.map(lambda x -> x[l])), max_op(prev_list.map(lambda x -> x[u])), max_op(prev_list.map(lambda x -> x[L])), max_op(prev_list.map(lambda x -> x[U])));
}

2025-07-02 17:07:30,435 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:07:30,676 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Maxpool ->
        (max_op([prev_list.map(x -> x[l])]),
         max_op([prev_list.map(x -> x[u])]),
         max_op([prev_list.map(x -> x[L])]),
         max_op([prev_list.map(x -> x[U])])
        );
}

2025-07-02 17:07:30,677 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:07:30,923 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Maxpool -> (
        max_op(prev[l]),                            // l = max lower bound among inputs
        max_op(prev[u]),                            // u = max upper bound among inputs
        max_op(prev),                               // L = max poly lower between inputs
        max_op(prev)                                // U = max poly upper between inputs
    );
}

2025-07-02 17:07:30,923 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:07:30,923 - INFO - [STEP 1] All 3 samples failed validation. Retrying 9/10...
2025-07-02 17:07:35,573 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Maxpool -> (max_op(prev[l]), max_op(prev[u]), max_op(prev), max_op(prev));
}

2025-07-02 17:07:35,576 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:07:35,816 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Maxpool -> (
        max_op(prev[l]),
        max_op(prev[u]),
        max_op(prev),
        max_op(prev)
    );
}

2025-07-02 17:07:35,820 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:07:36,274 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Maxpool -> (max_op(prev[l]), max_op(prev[u]), max_op(prev), max_op(prev));
}

2025-07-02 17:07:36,274 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:07:36,274 - INFO - [STEP 1] All 3 samples failed validation. Retrying 10/10...
2025-07-02 17:07:36,274 - INFO - [Maxpool] Runtime: 85.28 seconds
2025-07-02 17:07:36,274 - ERROR - Failed with Error:[STEP 1] Failed after 10 retries.
 during generating code:
transformer deeppoly{
    Maxpool -> (max_op(prev[l]), max_op(prev[u]), max_op(prev), max_op(prev));
}

2025-07-02 17:07:36,274 - INFO - 2025-07-02 17:07:36.274703 - Extracting Minpool
2025-07-02 17:07:36,274 - INFO -
API: Minpool -> Model: gpt-4o @ http://ggnds-serv-01.cs.illinois.edu:8084
2025-07-02 17:07:36,274 - INFO - [STEP 1] Starting step 1/1
2025-07-02 17:07:43,711 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool -> (min_op(prev[l]), min_op(prev[u]), min_op(prev[L]), min_op(prev[U]));
}

2025-07-02 17:07:43,711 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:07:44,046 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool ->
        (min_op([prev_0[l], prev_1[l], prev_2[l], prev_3[l]]),
         min_op([prev_0[u], prev_1[u], prev_2[u], prev_3[u]]),
         min_op([prev_0[L], prev_1[L], prev_2[L], prev_3[L]]),
         min_op([prev_0[U], prev_1[U], prev_2[U], prev_3[U]]));
}

2025-07-02 17:07:44,046 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:07:44,285 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool ->
       (min_op(prev[l]),
        min_op(prev[u]),
        min_op(prev[L]),
        min_op(prev[U]));
}

2025-07-02 17:07:44,285 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:07:44,285 - INFO - [STEP 1] All 3 samples failed validation. Retrying 1/10...
2025-07-02 17:07:49,978 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Minpool -> (min(prev_list.map(x -> x[l])), min(prev_list.map(x -> x[u])), prev_list.map(x -> x[L]).min(), prev_list.map(x -> x[U]).min());
}

2025-07-02 17:07:49,978 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:07:50,224 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool ->
        (min_op(prev[l]),
         min_op(prev[u]),
         min_op(prev[L]),
         min_op(prev[U])
        );
}

2025-07-02 17:07:50,224 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:07:50,449 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Minpool ->
        (min_op(prev_list.map(x -> x[l])),
         min_op(prev_list.map(x -> x[u])),
         min_op(prev_list.map(x -> x[L])),
         min_op(prev_list.map(x -> x[U])));
}

2025-07-02 17:07:50,449 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:07:50,449 - INFO - [STEP 1] All 3 samples failed validation. Retrying 2/10...
2025-07-02 17:07:56,003 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool -> (min_op(prev[l]), min_op(prev[u]), min_op(prev[L]), min_op(prev[U]));
}

2025-07-02 17:07:56,003 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:07:58,687 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool ->
        (min_op([prev_i[l] for i in range(n)]),           // lower
         min_op([prev_i[u] for i in range(n)]),           // upper
         min_op([prev_i for i in range(n)]),              // PolyExp lower
         min_op([prev_i for i in range(n)])               // PolyExp upper
        );
}

2025-07-02 17:07:58,687 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:08:10,752 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 384, in visitMaxOp
    exp1type = self.visit(node.expr1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 47, in visit
    return self.visitGetElement(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 472, in visitGetElement
    etype = self.visit(node.expr)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 27, in visit
    return self.visitVar(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 403, in visitVar
    raise UndefinedVarException(node.name + " is undefined")
constraintflow.core.astTC.UndefinedVarException: prev_0 is undefined

Code:
transformer deeppoly{
    Minpool ->
        (min(prev_0[l], prev_1[l]),
         min(prev_0[u], prev_1[u]),
         (prev_0[l] <= prev_1[l]) ? prev_0 : prev_1,
         (prev_0[u] <= prev_1[u]) ? prev_0 : prev_1);
}

2025-07-02 17:08:10,753 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:08:10,753 - INFO - [STEP 1] All 3 samples failed validation. Retrying 3/10...
2025-07-02 17:08:24,833 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Minpool ->
        argmin = argmax_op(MINUS prev_list[u], 0);
        (prev_list[argmin][l], prev_list[argmin][u], prev_list[argmin], prev_list[argmin]);
}

2025-07-02 17:08:24,833 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:08:25,069 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 384, in visitMaxOp
    exp1type = self.visit(node.expr1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 47, in visit
    return self.visitGetElement(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 472, in visitGetElement
    etype = self.visit(node.expr)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 27, in visit
    return self.visitVar(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 403, in visitVar
    raise UndefinedVarException(node.name + " is undefined")
constraintflow.core.astTC.UndefinedVarException: prev_0 is undefined

Code:
transformer deeppoly{
    Minpool ->
        (min(prev_0[l], prev_1[l]),
         min(prev_0[u], prev_1[u]),
         (prev_0[l] <= prev_1[l]) ? prev_0 : prev_1,
         (prev_0[u] <= prev_1[u]) ? prev_0 : prev_1
        );
}

2025-07-02 17:08:25,072 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:08:25,308 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool ->
        (min_op(prev[l]),
         min_op(prev[u]),
         min_op(prev[L]),
         min_op(prev[U])
        );
}

2025-07-02 17:08:25,308 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:08:25,308 - INFO - [STEP 1] All 3 samples failed validation. Retrying 4/10...
2025-07-02 17:08:30,401 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool ->
        (min_op([prev_0[l], prev_1[l], prev_2[l], prev_3[l]]),
         min_op([prev_0[u], prev_1[u], prev_2[u], prev_3[u]]),
         min_op([prev_0, prev_1, prev_2, prev_3]),
         min_op([prev_0, prev_1, prev_2, prev_3]));
}

2025-07-02 17:08:30,401 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:08:30,651 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool -> (min_op(prev[l]), min_op(prev[u]), min_op(prev[L]), min_op(prev[U]));
}

2025-07-02 17:08:30,652 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:08:30,900 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool ->
        (
            min_op(prev[l]),
            min_op(prev[u]),
            min_op(prev[L]),
            min_op(prev[U])
        );
}

2025-07-02 17:08:30,901 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:08:30,901 - INFO - [STEP 1] All 3 samples failed validation. Retrying 5/10...
2025-07-02 17:08:55,348 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool ->
    (min_op(prev[l]),
     min_op(prev[u]),
     min_op(prev),
     min_op(prev)
    );
}

2025-07-02 17:08:55,349 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:08:55,603 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool -> (min_op(prev[l]), min_op(prev[u]), min_op(prev[L]), min_op(prev[U]));
}

2025-07-02 17:08:55,604 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:08:55,838 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 384, in visitMaxOp
    exp1type = self.visit(node.expr1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 47, in visit
    return self.visitGetElement(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 472, in visitGetElement
    etype = self.visit(node.expr)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 27, in visit
    return self.visitVar(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 403, in visitVar
    raise UndefinedVarException(node.name + " is undefined")
constraintflow.core.astTC.UndefinedVarException: prev_0 is undefined

Code:
transformer deeppoly{
    Minpool -> (min(prev_0[l], prev_1[l]), min(prev_0[u], prev_1[u]), (prev_0[L] <= prev_1[L]) ? prev_0[L] : prev_1[L], (prev_0[U] <= prev_1[U]) ? prev_0[U] : prev_1[U]);
}

2025-07-02 17:08:55,838 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:08:55,838 - INFO - [STEP 1] All 3 samples failed validation. Retrying 6/10...
2025-07-02 17:09:01,502 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Minpool -> (min_op(prev[l]), min_op(prev[u]), min_op(prev), min_op(prev))
}

2025-07-02 17:09:01,503 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:09:01,772 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool -> (min_op(prev[l]), min_op(prev[u]), min_op(prev), min_op(prev));
}

2025-07-02 17:09:01,772 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:09:02,021 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool -> (
        min_op(prev[l]),
        min_op(prev[u]),
        min_op(prev),
        min_op(prev)
    );
}

2025-07-02 17:09:02,021 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:09:02,021 - INFO - [STEP 1] All 3 samples failed validation. Retrying 7/10...
2025-07-02 17:09:10,763 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Minpool -> (min_op(prev[l]), min_op(prev[u]), min_op(prev), min_op(prev))
}

2025-07-02 17:09:10,763 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:09:11,002 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool -> (min_op(prev[l]), min_op(prev[u]), min_op(prev), min_op(prev));
}

2025-07-02 17:09:11,003 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:09:11,239 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool -> (min_op(prev[l]), min_op(prev[u]), min_op(prev[L]), min_op(prev[U]));
}

2025-07-02 17:09:11,239 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:09:11,239 - INFO - [STEP 1] All 3 samples failed validation. Retrying 8/10...
2025-07-02 17:09:18,733 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool ->
        (min_op(prev[l]),
         min_op(prev[u]),
         min_op(prev[L]),
         min_op(prev[U]));
}

2025-07-02 17:09:18,733 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:09:18,964 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool -> (
        min_op(prev_0[l], prev_1[l]),
        min_op(prev_0[u], prev_1[u]),
        (prev_0[l] <= prev_1[l]) ? prev_0 : prev_1,
        (prev_0[u] <= prev_1[u]) ? prev_0 : prev_1
    );
}

2025-07-02 17:09:18,964 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:09:19,193 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Minpool ->
        (min(prev_list.map(x -> x[l])),
         min(prev_list.map(x -> x[u])),
         prev_list[argmax_op(prev_list.map(x -> -x[l]), 1)],
         prev_list[argmax_op(prev_list.map(x -> -x[u]), 1)]
        );
}

2025-07-02 17:09:19,197 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:09:19,197 - INFO - [STEP 1] All 3 samples failed validation. Retrying 9/10...
2025-07-02 17:09:23,850 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool ->
        (min_op(prev[l]),
         min_op(prev[u]),
         min_op(prev[L]),
         min_op(prev[U]));
}

2025-07-02 17:09:23,850 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:09:24,089 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool -> (min_op(prev[l]), min_op(prev[u]), min_op(prev[L]), min_op(prev[U]));
}

2025-07-02 17:09:24,089 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:09:24,546 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: min_op is not defined

Code:
transformer deeppoly{
    Minpool -> (min_op(prev[l]), min_op(prev[u]), min_op(prev), min_op(prev));
}

2025-07-02 17:09:24,546 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:09:24,546 - INFO - [STEP 1] All 3 samples failed validation. Retrying 10/10...
2025-07-02 17:09:24,546 - INFO - [Minpool] Runtime: 108.27 seconds
2025-07-02 17:09:24,546 - ERROR - Failed with Error:[STEP 1] Failed after 10 retries.
 during generating code:
transformer deeppoly{
    Minpool -> (min_op(prev[l]), min_op(prev[u]), min_op(prev), min_op(prev));
}

2025-07-02 17:09:24,546 - INFO - 2025-07-02 17:09:24.546609 - Extracting Neuron_add
2025-07-02 17:09:24,546 - INFO -
API: Neuron_add -> Model: gpt-4o @ http://ggnds-serv-01.cs.illinois.edu:8084
2025-07-02 17:09:24,546 - INFO - [STEP 1] Starting step 1/1
2025-07-02 17:09:30,719 - INFO - [STEP 1] Sample 1: Validation passed.
2025-07-02 17:09:30,719 - INFO - [Neuron_add] Runtime: 6.17 seconds
2025-07-02 17:09:30,719 - INFO - Succeed. Saved to logs/2025-07-02_16-51-47/results/gpt-4o/success/Neuron_add.txt

2025-07-02 17:09:30,719 - INFO - 2025-07-02 17:09:30.719469 - Extracting Neuron_max
2025-07-02 17:09:30,719 - INFO -
API: Neuron_max -> Model: gpt-4o @ http://ggnds-serv-01.cs.illinois.edu:8084
2025-07-02 17:09:30,719 - INFO - [STEP 1] Starting step 1/1
2025-07-02 17:09:39,078 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_max ->
    (f(prev_0, prev_1) ? (prev_0[l], prev_0[u], prev_0[L], prev_0[U])
    : (f(prev_1, prev_0) ? (prev_1[l], prev_1[u], prev_1[L], prev_1[U])
    : (max(prev_0[l], prev_1[l]),
       max(prev_0[u], prev_1[u]),
       (prev_0[L] + prev_1[L] + abs(prev_0[L] - prev_1[L])) / 2,
       (prev_0[U] + prev_1[U] + abs(prev_0[U] - prev_1[U])) / 2 ));
}

2025-07-02 17:09:39,078 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:09:39,413 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 728, in visitTransRetBasic
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Expression in transformer is different from shape declaration

Code:
transformer deeppoly{
    Neuron_max -> ( ((prev_0[l]) >= (prev_1[l])) ? (prev_0[l]) : (prev_1[l]),
                    ((prev_0[u]) >= (prev_1[u])) ? (prev_0[u]) : (prev_1[u]),
                    ((prev_0[l]) >= (prev_1[l])) ? (prev_0) : (prev_1),
                    (((prev_0[u]) >= (prev_1[u])) ? (prev_0) : (prev_1)) );
}

2025-07-02 17:09:39,413 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:09:39,647 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Neuron_max -> (max_op(prev_0[l], prev_1[l]), max_op(prev_0[u], prev_1[u]),
                   (prev_0[l] >= prev_1[l]) ? prev_0 : prev_1,
                   (prev_0[u] >= prev_1[u]) ? prev_0 : prev_1);
}

2025-07-02 17:09:39,647 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:09:39,647 - INFO - [STEP 1] All 3 samples failed validation. Retrying 1/10...
2025-07-02 17:09:51,069 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 43, in visit
    return self.visitTernary(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 443, in visitTernary
    rtype = self.visit(node.fexpr)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 43, in visit
    return self.visitTernary(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 443, in visitTernary
    rtype = self.visit(node.fexpr)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 250, in visitBinOp
    rtype = self.visit(node.right)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: abs is not defined

Code:
transformer deeppoly{
    Neuron_max -> (
        max(prev_0[l], prev_1[l]),
        max(prev_0[u], prev_1[u]),
        (f(prev_0, prev_1)) ? prev_0 : ((f(prev_1, prev_0)) ? prev_1 : (0.5 * (prev_0 + prev_1) + 0.5 * abs(prev_0 - prev_1))),
        (f(prev_0, prev_1)) ? prev_0 : ((f(prev_1, prev_0)) ? prev_1 : (0.5 * (prev_0 + prev_1) + 0.5 * abs(prev_0 - prev_1)))
    );
}

2025-07-02 17:09:51,069 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:09:51,461 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 728, in visitTransRetBasic
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Expression in transformer is different from shape declaration

Code:
transformer deeppoly{
    Neuron_max -> ( (prev_0[l] >= prev_1[l]) ? prev_0[l] : prev_1[l],
                    (prev_0[u] >= prev_1[u]) ? prev_0[u] : prev_1[u],
                    (prev_0[l] >= prev_1[l]) ? prev_0 : (prev_1[l] >= prev_0[l]) ? prev_1 : ( ((prev_0 - prev_1)*( (prev_0[l] - prev_1[u]) / ( (prev_0[l] - prev_1[u])+(prev_1[l] - prev_0[u]) ) )) + prev_1 ),
                    (prev_0[u] >= prev_1[u]) ? prev_0 : (prev_1[u] >= prev_0[u]) ? prev_1 : ( ((prev_0 - prev_1)*( (prev_0[u] - prev_1[l]) / ( (prev_0[u] - prev_1[l])+(prev_1[u] - prev_0[l]) ) )) + prev_1 )
    );
}

2025-07-02 17:09:51,462 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:09:52,200 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:09:52,200 - INFO - [STEP 1] All 3 samples failed validation. Retrying 2/10...
2025-07-02 17:10:10,762 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 43, in visit
    return self.visitTernary(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 443, in visitTernary
    rtype = self.visit(node.fexpr)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 43, in visit
    return self.visitTernary(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 443, in visitTernary
    rtype = self.visit(node.fexpr)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 255, in visitBinOp
    node.type = self.get_binop(node.op, ltype, rtype)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 212, in get_binop
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: * is not defined on PolyExp and Neuron

Code:
transformer deeppoly{
    Neuron_max -> (max(prev_0[l], prev_1[l]), max(prev_0[u], prev_1[u]),
        (prev_0[u] >= prev_1[u]) ? prev_0 : ((prev_1[u] >= prev_0[u]) ? prev_1 : (0.5*prev_0 + 0.5*prev_1)),
        (prev_0[l] >= prev_1[l]) ? prev_0 : ((prev_1[l] >= prev_0[l]) ? prev_1 : (0.5*prev_0 + 0.5*prev_1))
    );
}

2025-07-02 17:10:10,763 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:10:11,641 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:10:12,126 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:10:12,126 - INFO - [STEP 1] All 3 samples failed validation. Retrying 3/10...
2025-07-02 17:10:23,255 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 43, in visit
    return self.visitTernary(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 440, in visitTernary
    raise TypeMismatchException("Condition has to be boolean")
constraintflow.core.astTC.TypeMismatchException: Condition has to be boolean

Code:
transformer deeppoly{
    Neuron_max -> ( (f(prev_0, prev_1)) ? (prev_0[l], prev_0[u], prev_0[L], prev_0[U]) : ( (f(prev_1, prev_0)) ? (prev_1[l], prev_1[u], prev_1[L], prev_1[U]) : ( max(prev_0[l], prev_1[l]), max(prev_0[u], prev_1[u]), prev_0[L] >= prev_1[L] ? prev_0[L] : prev_1[L], prev_0[U] >= prev_1[U] ? prev_0[U] : prev_1[U] ) ) );
}

2025-07-02 17:10:23,255 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:10:23,521 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 728, in visitTransRetBasic
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Expression in transformer is different from shape declaration

Code:
transformer deeppoly{
    Neuron_max -> (
        (prev_0[l] >= prev_1[l]) ? prev_0[l] : prev_1[l],
        (prev_0[u] >= prev_1[u]) ? prev_0[u] : prev_1[u],
        (prev_0[L] >= prev_1[L]) ? prev_0[L] : prev_1[L],
        (prev_0[U] >= prev_1[U]) ? prev_0[U] : prev_1[U]
    );
}

2025-07-02 17:10:23,521 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:10:23,872 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 728, in visitTransRetBasic
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Expression in transformer is different from shape declaration

Code:
transformer deeppoly{
    Neuron_max -> (
        (prev_0[l] >= prev_1[l]) ? prev_0[l] : prev_1[l],
        (prev_0[u] >= prev_1[u]) ? prev_0[u] : prev_1[u],
        max(prev_0, prev_1),
        (prev_0[l] >= prev_1[u]) ? prev_0 : ((prev_1[l] >= prev_0[u]) ? prev_1 : ( ((prev_0[u]-prev_1[l])/(prev_0[u]-prev_0[l]+prev_1[u]-prev_1[l]))*prev_0 + ((prev_1[u]-prev_0[l])/(prev_1[u]-prev_1[l]+prev_0[u]-prev_0[l]))*prev_1 ) )
    );
}

2025-07-02 17:10:23,873 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:10:23,873 - INFO - [STEP 1] All 3 samples failed validation. Retrying 4/10...
2025-07-02 17:10:35,595 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:10:36,438 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:10:36,931 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:10:36,931 - INFO - [STEP 1] All 3 samples failed validation. Retrying 5/10...
2025-07-02 17:10:44,127 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:10:44,564 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:10:45,014 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:10:45,014 - INFO - [STEP 1] All 3 samples failed validation. Retrying 6/10...
2025-07-02 17:11:10,806 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Neuron_max ->
        (prev_0[l] >= prev_1[l]) ?
            (
                // case: prev_0 lower bound dominates
                (prev_0[l], max_op(prev_0[u], prev_1[u]), prev_0, max_op(prev_0, prev_1))
            )
        : (prev_1[l] >= prev_0[l]) ?
            (
                // case: prev_1 lower bound dominates
                (prev_1[l], max_op(prev_0[u], prev_1[u]), prev_1, max_op(prev_0, prev_1))
            )
        : (
            // general case: merge, using convex relaxation for lower, linear upper
            max_op(prev_0[l], prev_1[l]),
            max_op(prev_0[u], prev_1[u]),
            ( (prev_0[l] >= prev_1[l]) ? prev_0 : prev_1 ),
            max_op(prev_0, prev_1)
        );
}

2025-07-02 17:11:10,806 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:11:11,051 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 43, in visit
    return self.visitTernary(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 443, in visitTernary
    rtype = self.visit(node.fexpr)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 43, in visit
    return self.visitTernary(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 443, in visitTernary
    rtype = self.visit(node.fexpr)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 250, in visitBinOp
    rtype = self.visit(node.right)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: abs is not defined

Code:
transformer deeppoly{
    Neuron_max -> (max(prev_0[l], prev_1[l]), max(prev_0[u], prev_1[u]), (prev_0[l] >= prev_1[u]) ? prev_0 : ((prev_1[l] >= prev_0[u]) ? prev_1 : (0.5 * (prev_0 + prev_1) + 0.5 * abs(prev_0 - prev_1))), (prev_0[u] >= prev_1[l]) ? prev_0 : ((prev_1[u] >= prev_0[l]) ? prev_1 : (0.5 * (prev_0 + prev_1) + 0.5 * abs(prev_0 - prev_1))));
}

2025-07-02 17:11:11,051 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:11:11,336 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_max ->
        (prev_0[l] >= prev_1[l]) ?
            ((prev_0[l] >= prev_1[u]) ? (prev_0[l], prev_0[u], prev_0[L], prev_0[U]) :
                ((prev_0[u] <= prev_1[l]) ? (prev_1[l], prev_1[u], prev_1[L], prev_1[U]) :
                    (max(prev_0[l], prev_1[l]), max(prev_0[u], prev_1[u]),
                        (prev_0[L] >= prev_1[L]) ? prev_0[L] : prev_1[L],
                        ((prev_0[u] - prev_1[l] >= 0) ? prev_0[U] :
                            ((prev_0[u] - prev_1[u] <= 0) ? prev_1[U] :
                                (prev_0[U]*(prev_0[u]-prev_1[l])/(prev_0[u]-prev_1[l]+prev_1[u]-prev_0[l]) + prev_1[U]*(prev_1[u]-prev_0[l])/(prev_0[u]-prev_1[l]+prev_1[u]-prev_0[l]))
                            )
                        )
                    )
                )
            ) :
            ((prev_1[l] >= prev_0[u]) ? (prev_1[l], prev_1[u], prev_1[L], prev_1[U]) :
                ((prev_1[u] <= prev_0[l]) ? (prev_0[l], prev_0[u], prev_0[L], prev_0[U]) :
                    (max(prev_0[l], prev_1[l]), max(prev_0[u], prev_1[u]),
                        (prev_0[L] >= prev_1[L]) ? prev_0[L] : prev_1[L],
                        ((prev_1[u] - prev_0[l] >= 0) ? prev_1[U] :
                            ((prev_1[u] - prev_0[u] <= 0) ? prev_0[U] :
                                (prev_1[U]*(prev_1[u]-prev_0[l])/(prev_1[u]-prev_0[l]+prev_0[u]-prev_1[l]) + prev_0[U]*(prev_0[u]-prev_1[l])/(prev_1[u]-prev_0[l]+prev_0[u]-prev_1[l]))
                            )
                        )
                    )
                )
            )
}

2025-07-02 17:11:11,336 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:11:11,336 - INFO - [STEP 1] All 3 samples failed validation. Retrying 7/10...
2025-07-02 17:11:28,718 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_max -> (f(prev_0, prev_1) ? (prev_0[l], prev_0[u], prev_0[L], prev_0[U]) : (f(prev_1, prev_0) ? (prev_1[l], prev_1[u], prev_1[L], prev_1[U]) : (max(prev_0[l], prev_1[l]), max(prev_0[u], prev_1[u]), prev_0[L] * (prev_0[u] >= prev_1[u]) + prev_1[L] * (prev_1[u] > prev_0[u]), prev_0[U] * (prev_0[l] >= prev_1[l]) + prev_1[U] * (prev_1[l] > prev_0[l])));
}

2025-07-02 17:11:28,718 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:11:28,982 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 43, in visit
    return self.visitTernary(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 443, in visitTernary
    rtype = self.visit(node.fexpr)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 43, in visit
    return self.visitTernary(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 443, in visitTernary
    rtype = self.visit(node.fexpr)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: maxOp is not defined

Code:
transformer deeppoly{
    Neuron_max -> (max(prev_0[l], prev_1[l]), max(prev_0[u], prev_1[u]),
        (prev_0[u] <= prev_1[l]) ? prev_1 :
        ((prev_1[u] <= prev_0[l]) ? prev_0 : maxOp(prev_0, prev_1)),
        (prev_0[l] >= prev_1[u]) ? prev_0 :
        ((prev_1[l] >= prev_0[u]) ? prev_1 : maxOp(prev_0, prev_1))
    );
}

2025-07-02 17:11:28,982 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:11:29,247 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 249, in visitBinOp
    ltype = self.visit(node.left)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 250, in visitBinOp
    rtype = self.visit(node.right)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: abs is not defined

Code:
transformer deeppoly{
    Neuron_max ->
        ( (prev_0[l] >= prev_1[l])
            ? ((prev_0[l]), (prev_0[u]), (prev_0), (prev_0))
            : ((prev_1[l] >= prev_0[l])
                ? ((prev_1[l]), (prev_1[u]), (prev_1), (prev_1))
                : (max(prev_0[l], prev_1[l]), max(prev_0[u], prev_1[u]), (prev_0 + prev_1 + abs(prev_0 - prev_1)) / 2, (prev_0 + prev_1 + abs(prev_0 - prev_1)) / 2)
            )
        );
}

2025-07-02 17:11:29,251 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:11:29,251 - INFO - [STEP 1] All 3 samples failed validation. Retrying 8/10...
2025-07-02 17:11:48,534 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:11:48,763 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 389, in visitMaxOp
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: max is not defined on Neuron and Neuron

Code:
transformer deeppoly{
    Neuron_max -> (max(prev_0[l], prev_1[l]), max(prev_0[u], prev_1[u]), max(prev_0, prev_1), max(prev_0, prev_1));
}

2025-07-02 17:11:48,763 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:11:49,495 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:11:49,495 - INFO - [STEP 1] All 3 samples failed validation. Retrying 9/10...
2025-07-02 17:12:11,283 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:12:11,532 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 43, in visit
    return self.visitTernary(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 443, in visitTernary
    rtype = self.visit(node.fexpr)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 43, in visit
    return self.visitTernary(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 443, in visitTernary
    rtype = self.visit(node.fexpr)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 255, in visitBinOp
    node.type = self.get_binop(node.op, ltype, rtype)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 212, in get_binop
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: * is not defined on PolyExp and Neuron

Code:
transformer deeppoly{
    Neuron_max -> (max(prev_0[l], prev_1[l]), max(prev_0[u], prev_1[u]),
        (prev_0[l] >= prev_1[u]) ? prev_0 : ((prev_1[l] >= prev_0[u]) ? prev_1 : 0.5*prev_0 + 0.5*prev_1),
        (prev_0[u] >= prev_1[u]) ? prev_0 : prev_1
    );
}

2025-07-02 17:12:11,533 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:12:12,059 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:12:12,059 - INFO - [STEP 1] All 3 samples failed validation. Retrying 10/10...
2025-07-02 17:12:12,059 - INFO - [Neuron_max] Runtime: 161.34 seconds
2025-07-02 17:12:12,059 - ERROR - Failed with Error:[STEP 1] Failed after 10 retries.
 during generating code:
transformer deeppoly{
    Neuron_max -> (prev_0[l] >= prev_1[l]) ? (
        (max(prev_0[l], prev_1[l]), max(prev_0[u], prev_1[u]), prev_0[l] >= prev_1[l] ? prev_0 : prev_1, prev_0[u] >= prev_1[u] ? prev_0 : prev_1)
    ) : (
        (prev_0[u] <= prev_1[l]) ? (
            (prev_1[l], prev_1[u], prev_1, prev_1)
        ) : (
            (max(prev_0[l], prev_1[l]), max(prev_0[u], prev_1[u]),
             (prev_0[u] - prev_1[l] >= 0) ? prev_0 : prev_1,
             (prev_0[u] >= prev_1[u]) ? prev_0 : prev_1
            )
        )
    );
}

2025-07-02 17:12:12,059 - INFO - 2025-07-02 17:12:12.059915 - Extracting Neuron_min
2025-07-02 17:12:12,059 - INFO -
API: Neuron_min -> Model: gpt-4o @ http://ggnds-serv-01.cs.illinois.edu:8084
2025-07-02 17:12:12,060 - INFO - [STEP 1] Starting step 1/1
2025-07-02 17:12:22,099 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 728, in visitTransRetBasic
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Expression in transformer is different from shape declaration

Code:
transformer deeppoly{
    Neuron_min -> ( ((prev_0[l]) <= (prev_1[l])) ? (prev_0[l]) : (prev_1[l]),
                   ((prev_0[u]) <= (prev_1[u])) ? (prev_0[u]) : (prev_1[u]),
                   ((prev_0[L]) <= (prev_1[L])) ? (prev_0[L]) : (prev_1[L]),
                   ((prev_0[U]) <= (prev_1[U])) ? (prev_0[U]) : (prev_1[U]) );
}

2025-07-02 17:12:22,099 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:12:22,437 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 728, in visitTransRetBasic
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Expression in transformer is different from shape declaration

Code:
transformer deeppoly{
    Neuron_min -> (
        (prev_0[l] < prev_1[l]) ? prev_0[l] : prev_1[l],
        (prev_0[u] < prev_1[u]) ? prev_0[u] : prev_1[u],
        (prev_0[l] < prev_1[l]) ? prev_0 : prev_1,
        (prev_0[u] < prev_1[u]) ?
            (prev_0[u] < prev_1[l] ? prev_0 : (prev_0[u] - prev_1[l])/(prev_0[u] - prev_0[l]) * (prev_1 - prev_0[l]) + prev_0)
            :
            (prev_1[u] < prev_0[l] ? prev_1 : (prev_1[u] - prev_0[l])/(prev_1[u] - prev_1[l]) * (prev_0 - prev_1[l]) + prev_1)
    );
}

2025-07-02 17:12:22,437 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:12:22,705 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 43, in visit
    return self.visitTernary(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 438, in visitTernary
    ctype = self.visit(node.cond)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 43, in visit
    return self.visitTernary(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 448, in visitTernary
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Neuron and Bool are not lub_type

Code:
transformer deeppoly{
    Neuron_min ->
        (prev_0[l] <= prev_1[l]) ?
            (prev_0[l], max(prev_0[u], prev_1[u]), prev_0, ((prev_0[u] <= prev_1[l]) ? prev_0 : (prev_0[u] >= prev_1[u]) ? prev_1 : (prev_0 + prev_1) / 2))
            :
            (prev_1[l], max(prev_0[u], prev_1[u]), prev_1, ((prev_1[u] <= prev_0[l]) ? prev_1 : (prev_1[u] >= prev_0[u]) ? prev_0 : (prev_0 + prev_1) / 2));
}

2025-07-02 17:12:22,705 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:12:22,706 - INFO - [STEP 1] All 3 samples failed validation. Retrying 1/10...
2025-07-02 17:12:30,293 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 728, in visitTransRetBasic
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Expression in transformer is different from shape declaration

Code:
transformer deeppoly{
    Neuron_min ->
        ( (prev_0[l] <= prev_1[l]) ? prev_0[l] : prev_1[l],
          (prev_0[u] <= prev_1[u]) ? prev_0[u] : prev_1[u],
          (prev_0[l] <= prev_1[l]) ? prev_0 : prev_1,
          (prev_0[u] <= prev_1[u]) ? prev_0 : prev_1
        );
}

2025-07-02 17:12:30,294 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:12:30,554 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 728, in visitTransRetBasic
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Expression in transformer is different from shape declaration

Code:
transformer deeppoly{
    Neuron_min -> ( (prev_0[l] <= prev_1[l]) ? prev_0[l] : prev_1[l],
                    (prev_0[u] <= prev_1[u]) ? prev_0[u] : prev_1[u],
                    (prev_0[L] <= prev_1[L]) ? prev_0[L] : prev_1[L],
                    (prev_0[U] <= prev_1[U]) ? prev_0[U] : prev_1[U] );
}

2025-07-02 17:12:30,554 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:12:30,834 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 728, in visitTransRetBasic
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Expression in transformer is different from shape declaration

Code:
transformer deeppoly{
    Neuron_min -> ( ((prev_0[l]) <= (prev_1[l])) ? (prev_0[l]) : (prev_1[l]),
                    ((prev_0[u]) <= (prev_1[u])) ? (prev_0[u]) : (prev_1[u]),
                    ((prev_0[L]) <= (prev_1[L])) ? (prev_0[L]) : (prev_1[L]),
                    ((prev_0[U]) <= (prev_1[U])) ? (prev_0[U]) : (prev_1[U]) );
}

2025-07-02 17:12:30,835 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:12:30,835 - INFO - [STEP 1] All 3 samples failed validation. Retrying 2/10...
2025-07-02 17:12:54,968 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:12:55,224 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 728, in visitTransRetBasic
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Expression in transformer is different from shape declaration

Code:
transformer deeppoly{
    Neuron_min -> ( (prev_0[l] <= prev_1[l]) ? prev_0[l] : prev_1[l],
                    (prev_0[u] <= prev_1[u]) ? prev_0[u] : prev_1[u],
                    (prev_0[l] <= prev_1[l]) ? prev_0 : prev_1,
                    (prev_0[u] <= prev_1[u]) ? prev_0 : prev_1 );
}

2025-07-02 17:12:55,225 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:12:55,597 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:12:55,597 - INFO - [STEP 1] All 3 samples failed validation. Retrying 3/10...
2025-07-02 17:13:10,759 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 728, in visitTransRetBasic
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Expression in transformer is different from shape declaration

Code:
transformer deeppoly{
    Neuron_min ->
        ( (prev_0[l] <= prev_1[l]) ? prev_0[l] : prev_1[l],
          (prev_0[u] <= prev_1[u]) ? prev_0[u] : prev_1[u],
          (prev_0[l] <= prev_1[l]) ? prev_0 : prev_1,
          (prev_0[u] <= prev_1[u]) ? prev_0 : prev_1
        );
}

2025-07-02 17:13:10,759 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:13:11,424 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:13:11,803 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:13:11,803 - INFO - [STEP 1] All 3 samples failed validation. Retrying 4/10...
2025-07-02 17:13:22,175 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 249, in visitBinOp
    ltype = self.visit(node.left)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 250, in visitBinOp
    rtype = self.visit(node.right)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: abs is not defined

Code:
transformer deeppoly{
    Neuron_min -> (f(prev_0, prev_1) ? (prev_1[l], prev_1[u], prev_1[L], prev_1[U]) : (f(prev_1, prev_0) ? (prev_0[l], prev_0[u], prev_0[L], prev_0[U]) : (min(prev_0[l], prev_1[l]), min(prev_0[u], prev_1[u]), (prev_0 + prev_1 - abs(prev_0 - prev_1)) * 0.5, (prev_0 + prev_1 - abs(prev_0 - prev_1)) * 0.5)));
}

2025-07-02 17:13:22,175 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:13:22,428 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 728, in visitTransRetBasic
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Expression in transformer is different from shape declaration

Code:
transformer deeppoly{
    Neuron_min -> ( (prev_0[l] <= prev_1[l]) ? prev_0[l] : prev_1[l],
                    (prev_0[u] <= prev_1[u]) ? prev_0[u] : prev_1[u],
                    (prev_0[l] <= prev_1[l]) ? prev_0 : prev_1,
                    (prev_0[u] <= prev_1[u]) ? prev_0 : prev_1 );
}

2025-07-02 17:13:22,431 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:13:22,833 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:13:22,833 - INFO - [STEP 1] All 3 samples failed validation. Retrying 5/10...
2025-07-02 17:13:35,286 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 728, in visitTransRetBasic
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Expression in transformer is different from shape declaration

Code:
transformer deeppoly{
    Neuron_min -> (
        (prev_0[l] <= prev_1[l]) ? prev_0[l] : prev_1[l],
        (prev_0[u] <= prev_1[u]) ? prev_0[u] : prev_1[u],
        (prev_0[l] <= prev_1[l]) ? prev_0 : prev_1,
        (prev_0[u] <= prev_1[u]) ? prev_0 : prev_1
    );
}

2025-07-02 17:13:35,286 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:13:35,546 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 728, in visitTransRetBasic
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Expression in transformer is different from shape declaration

Code:
transformer deeppoly{
    Neuron_min ->
        ( (prev_0[l] <= prev_1[l]) ? prev_0[l] : prev_1[l],
          (prev_0[u] <= prev_1[u]) ? prev_0[u] : prev_1[u],
          (prev_0[u] <= prev_1[u]) ? prev_0 : prev_1,
          (prev_0[l] <= prev_1[l]) ? prev_1 : prev_0
        );
}

2025-07-02 17:13:35,547 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:13:35,951 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:13:35,951 - INFO - [STEP 1] All 3 samples failed validation. Retrying 6/10...
2025-07-02 17:13:44,834 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_min -> (f(prev_0, prev_1) ? (prev_1[l], prev_1[u], prev_1, prev_1)
        : (f(prev_1, prev_0) ? (prev_0[l], prev_0[u], prev_0, prev_0)
        : (min(prev_0[l], prev_1[l]), min(prev_0[u], prev_1[u]),
            (prev_0 + prev_1 - abs(prev_0 - prev_1)) * 0.5,
            (prev_0 + prev_1 - abs(prev_0 - prev_1)) * 0.5)))
}

2025-07-02 17:13:44,834 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:13:45,111 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 728, in visitTransRetBasic
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Expression in transformer is different from shape declaration

Code:
transformer deeppoly{
    Neuron_min -> (
        (prev_0[l] <= prev_1[l]) ? prev_0[l] : prev_1[l],
        (prev_0[u] <= prev_1[u]) ? prev_0[u] : prev_1[u],
        (prev_0[l] <= prev_1[l]) ? prev_0 : prev_1,
        (prev_0[u] <= prev_1[u]) ? prev_0 : prev_1
    );
}

2025-07-02 17:13:45,111 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:13:45,380 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 728, in visitTransRetBasic
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Expression in transformer is different from shape declaration

Code:
transformer deeppoly{
    Neuron_min -> ( (prev_0[l] <= prev_1[l]) ? prev_0[l] : prev_1[l],
                    (prev_0[u] <= prev_1[u]) ? prev_0[u] : prev_1[u],
                    (prev_0[l] <= prev_1[l]) ? prev_0 : prev_1,
                    (prev_0[u] <= prev_1[u]) ? prev_0 : prev_1 );
}

2025-07-02 17:13:45,381 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:13:45,381 - INFO - [STEP 1] All 3 samples failed validation. Retrying 7/10...
2025-07-02 17:13:55,540 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: max_op is not defined

Code:
transformer deeppoly{
    Neuron_min ->
        (prev_0[l] <= prev_1[l]) ?
            (prev_0[l], max_op(prev_0[u], prev_1[u]), prev_0, prev_0) :
        (prev_1[l] <= prev_0[l]) ?
            (prev_1[l], max_op(prev_0[u], prev_1[u]), prev_1, prev_1) :
            (min_op(prev_0[l], prev_1[l]), max_op(prev_0[u], prev_1[u]), prev_0, prev_1);
}

2025-07-02 17:13:55,540 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:13:56,121 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:13:56,385 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 728, in visitTransRetBasic
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Expression in transformer is different from shape declaration

Code:
transformer deeppoly{
    Neuron_min -> (
        (prev_0[l] <= prev_1[l]) ? prev_0[l] : prev_1[l],
        (prev_0[u] <= prev_1[u]) ? prev_0[u] : prev_1[u],
        (prev_0[l] <= prev_1[l]) ? prev_0 : prev_1,
        (prev_0[u] <= prev_1[u]) ? prev_0 : prev_1
    );
}

2025-07-02 17:13:56,385 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:13:56,385 - INFO - [STEP 1] All 3 samples failed validation. Retrying 8/10...
2025-07-02 17:14:10,897 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:14:11,153 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_min -> ( (prev_0[l] <= prev_1[l]) ? prev_0[l] : prev_1[l], (prev_0[u] <= prev_1[u]) ? prev_0[u] : prev_1[u], (prev_0[l] <= prev_1[l]) ? prev_0 : prev_1, ( (prev_0[u] <= prev_1[u]) ? prev_0 : ( (prev_1[u] <= prev_0[u]) ? prev_1 : ( (prev_0[u]-prev_1[l] <= 0) ? prev_0 : ( (prev_1[u]-prev_0[l] <= 0) ? prev_1 : ( (prev_1[u]-prev_0[l])/( (prev_1[u]-prev_0[l]) + (prev_0[u]-prev_1[l]) ) * prev_0 + (prev_0[u]-prev_1[l])/( (prev_1[u]-prev_0[l]) + (prev_0[u]-prev_1[l]) ) * prev_1 ) ) ) ) )
}

2025-07-02 17:14:11,153 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:14:11,519 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:14:11,519 - INFO - [STEP 1] All 3 samples failed validation. Retrying 9/10...
2025-07-02 17:14:20,201 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 249, in visitBinOp
    ltype = self.visit(node.left)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 250, in visitBinOp
    rtype = self.visit(node.right)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 63, in visit
    return self.visitFuncCall(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 674, in visitFuncCall
    raise UndefinedVarException(name + " is not defined")
constraintflow.core.astTC.UndefinedVarException: abs is not defined

Code:
transformer deeppoly{
    Neuron_min -> (f(prev_0, prev_1) ? (prev_1[l], prev_1[u], prev_1[L], prev_1[U]) : (f(prev_1, prev_0) ? (prev_0[l], prev_0[u], prev_0[L], prev_0[U]) : (min(prev_0[l], prev_1[l]), min(prev_0[u], prev_1[u]), (prev_0[L] + prev_1[L] - abs(prev_0[L] - prev_1[L]))/2, (prev_0[U] + prev_1[U] - abs(prev_0[U] - prev_1[U]))/2)));
}

2025-07-02 17:14:20,201 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:14:20,450 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 43, in visit
    return self.visitTernary(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 443, in visitTernary
    rtype = self.visit(node.fexpr)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 43, in visit
    return self.visitTernary(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 443, in visitTernary
    rtype = self.visit(node.fexpr)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 250, in visitBinOp
    rtype = self.visit(node.right)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 389, in visitMaxOp
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: min is not defined on Neuron and Neuron

Code:
transformer deeppoly{
    Neuron_min -> (
        min(prev_0[l], prev_1[l]),
        min(prev_0[u], prev_1[u]),
        (f(prev_0, prev_1)) ? prev_1 : prev_0,
        (prev_0[u] <= prev_1[l]) ? prev_0 : ((prev_1[u] <= prev_0[l]) ? prev_1 : (prev_0 + prev_1 - min(prev_0, prev_1)))
    );
}

2025-07-02 17:14:20,450 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:14:20,711 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 728, in visitTransRetBasic
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: Expression in transformer is different from shape declaration

Code:
transformer deeppoly{
    Neuron_min -> (
        (prev_0[l] <= prev_1[l]) ? prev_0[l] : prev_1[l],
        (prev_0[u] <= prev_1[u]) ? prev_0[u] : prev_1[u],
        (prev_0[l] <= prev_1[l]) ? prev_0 : prev_1,
        (prev_0[u] <= prev_1[u]) ? prev_0 : prev_1
    );
}

2025-07-02 17:14:20,711 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:14:20,711 - INFO - [STEP 1] All 3 samples failed validation. Retrying 10/10...
2025-07-02 17:14:20,711 - INFO - [Neuron_min] Runtime: 128.65 seconds
2025-07-02 17:14:20,711 - ERROR - Failed with Error:[STEP 1] Failed after 10 retries.
 during generating code:
transformer deeppoly{
    Neuron_min -> (
        (prev_0[l] <= prev_1[l]) ? prev_0[l] : prev_1[l],
        (prev_0[u] <= prev_1[u]) ? prev_0[u] : prev_1[u],
        (prev_0[l] <= prev_1[l]) ? prev_0 : prev_1,
        (prev_0[u] <= prev_1[u]) ? prev_0 : prev_1
    );
}

2025-07-02 17:14:20,711 - INFO - 2025-07-02 17:14:20.711939 - Extracting Neuron_mult
2025-07-02 17:14:20,711 - INFO -
API: Neuron_mult -> Model: gpt-4o @ http://ggnds-serv-01.cs.illinois.edu:8084
2025-07-02 17:14:20,712 - INFO - [STEP 1] Starting step 1/1
2025-07-02 17:14:32,059 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult -> (
        min(prev_0[l]*prev_1[l], prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], prev_0[u]*prev_1[u]),
        max(prev_0[l]*prev_1[l], prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], prev_0[u]*prev_1[u]),
        prev_0*prev_1,
        prev_0*prev_1
    );
}

2025-07-02 17:14:32,060 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:14:32,296 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult -> (
        min(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        max(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        prev_0 * prev_1,
        prev_0 * prev_1
    );
}

2025-07-02 17:14:32,297 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:14:32,562 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult ->
        ((prev_0[l]) >= 0) ? (
            ((prev_1[l]) >= 0) ? (
                (prev_0[l] * prev_1[l], prev_0[u] * prev_1[u], prev_0 * prev_1, prev_0 * prev_1)
            ) : (
                (prev_0[l] * prev_1[u], prev_0[u] * prev_1[l], prev_0 * prev_1, prev_0 * prev_1)
            )
        ) : (
            ((prev_0[u]) <= 0) ? (
                (prev_0[u] * prev_1[l], prev_0[l] * prev_1[u], prev_0 * prev_1, prev_0 * prev_1)
            ) : (
                (min(prev_0[l] * prev_1[u], prev_0[u] * prev_1[l], prev_0[l] * prev_1[l], prev_0[u] * prev_1[u]),
                 max(prev_0[l] * prev_1[u], prev_0[u] * prev_1[l], prev_0[l] * prev_1[l], prev_0[u] * prev_1[u]),
                 prev_0 * prev_1, prev_0 * prev_1)
            )
        );
}

2025-07-02 17:14:32,562 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:14:32,562 - INFO - [STEP 1] All 3 samples failed validation. Retrying 1/10...
2025-07-02 17:14:44,236 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult -> (
        min(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        max(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        prev_0[L] * prev_1[L],
        prev_0[U] * prev_1[U]
    );
}

2025-07-02 17:14:44,236 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:14:44,633 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 255, in visitBinOp
    node.type = self.get_binop(node.op, ltype, rtype)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 212, in get_binop
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: * is not defined on Neuron and Neuron

Code:
transformer deeppoly{
    Neuron_mult ->
        ( ((prev_0[l] >= 0) ? simplify_lower(prev_1, prev_0[l]) : simplify_lower(prev_1, prev_0[u]))
        + ((prev_1[l] >= 0) ? simplify_lower(prev_0, prev_1[l]) : simplify_lower(prev_0, prev_1[u])),
          ((prev_0[u] <= 0) ? simplify_upper(prev_1, prev_0[u]) : simplify_upper(prev_1, prev_0[l]))
        + ((prev_1[u] <= 0) ? simplify_upper(prev_0, prev_1[u]) : simplify_upper(prev_0, prev_1[l])),
          prev_0 * prev_1,
          prev_0 * prev_1
        );
}

2025-07-02 17:14:44,633 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:14:45,180 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult ->
        (prev_0[l] >= 0) ? (
            (prev_1[l] >= 0) ? (
                simplify_lower(prev_0, prev_1[l]),
                simplify_upper(prev_0, prev_1[u]),
                prev_0[L] * prev_1[L],
                prev_0[U] * prev_1[U]
            ) : (
                simplify_lower(prev_0, prev_1[u]),
                simplify_upper(prev_0, prev_1[l]),
                prev_0[L] * prev_1[U],
                prev_0[U] * prev_1[L]
            )
        ) : (
            (prev_1[l] >= 0) ? (
                simplify_lower(prev_1, prev_0[l]),
                simplify_upper(prev_1, prev_0[u]),
                prev_1[L] * prev_0[L],
                prev_1[U] * prev_0[U]
            ) : (
                min(
                    simplify_lower(prev_0, prev_1[l]),
                    simplify_lower(prev_0, prev_1[u]),
                    simplify_lower(prev_1, prev_0[l]),
                    simplify_lower(prev_1, prev_0[u])
                ),
                max(
                    simplify_upper(prev_0, prev_1[l]),
                    simplify_upper(prev_0, prev_1[u]),
                    simplify_upper(prev_1, prev_0[l]),
                    simplify_upper(prev_1, prev_0[u])
                ),
                min(
                    prev_0[L] * prev_1[L],
                    prev_0[L] * prev_1[U],
                    prev_0[U] * prev_1[L],
                    prev_0[U] * prev_1[U]
                ),
                max(
                    prev_0[U] * prev_1[U],
                    prev_0[U] * prev_1[L],
                    prev_0[L] * prev_1[U],
                    prev_0[L] * prev_1[L]
                )
            )
        );
}

2025-07-02 17:14:45,184 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:14:45,184 - INFO - [STEP 1] All 3 samples failed validation. Retrying 2/10...
2025-07-02 17:15:10,734 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult -> (
        max(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        min(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        prev_0 * prev_1,
        prev_0 * prev_1
    );
}

2025-07-02 17:15:10,734 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:15:10,993 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult ->
        ((prev_0[l] >= 0) & (prev_1[l] >= 0)) ?
            (prev_0[l] * prev_1[l], prev_0[u] * prev_1[u], prev_0 * prev_1, prev_0 * prev_1) :
        ((prev_0[u] <= 0) & (prev_1[u] <= 0)) ?
            (prev_0[u] * prev_1[u], prev_0[l] * prev_1[l], prev_0 * prev_1, prev_0 * prev_1) :
        (min(prev_0[l]*prev_1[l], prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], prev_0[u]*prev_1[u]),
         max(prev_0[l]*prev_1[l], prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], prev_0[u]*prev_1[u]),
         prev_0 * prev_1,
         prev_0 * prev_1);
}

2025-07-02 17:15:10,993 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:15:11,220 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult -> (
        min(prev_0[l]*prev_1[l], prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], prev_0[u]*prev_1[u]),
        max(prev_0[l]*prev_1[l], prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], prev_0[u]*prev_1[u]),
        prev_0 * prev_1,
        prev_0 * prev_1
    );
}

2025-07-02 17:15:11,220 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:15:11,220 - INFO - [STEP 1] All 3 samples failed validation. Retrying 3/10...
2025-07-02 17:15:20,486 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult -> (
        min((prev_0[l]) * (prev_1[l]), (prev_0[l]) * (prev_1[u]), (prev_0[u]) * (prev_1[l]), (prev_0[u]) * (prev_1[u])),
        max((prev_0[l]) * (prev_1[l]), (prev_0[l]) * (prev_1[u]), (prev_0[u]) * (prev_1[l]), (prev_0[u]) * (prev_1[u])),
        prev_0 * prev_1,
        prev_0 * prev_1
    );
}

2025-07-02 17:15:20,486 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:15:20,726 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult -> (
        min(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        max(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        prev_0 * prev_1,
        prev_0 * prev_1
    );
}

2025-07-02 17:15:20,726 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:15:20,959 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult -> (
        min(prev_0[l] * prev_1[l], prev_0[l] * prev_1[u], prev_0[u] * prev_1[l], prev_0[u] * prev_1[u]),
        max(prev_0[l] * prev_1[l], prev_0[l] * prev_1[u], prev_0[u] * prev_1[l], prev_0[u] * prev_1[u]),
        prev_0 * prev_1,
        prev_0 * prev_1
    );
}

2025-07-02 17:15:20,959 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:15:20,959 - INFO - [STEP 1] All 3 samples failed validation. Retrying 4/10...
2025-07-02 17:15:33,260 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult -> (
        min(prev_0[l] * prev_1[l], prev_0[l] * prev_1[u], prev_0[u] * prev_1[l], prev_0[u] * prev_1[u]),
        max(prev_0[l] * prev_1[l], prev_0[l] * prev_1[u], prev_0[u] * prev_1[l], prev_0[u] * prev_1[u]),
        prev_0 * prev_1,
        prev_0 * prev_1
    );
}

2025-07-02 17:15:33,260 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:15:33,547 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 255, in visitBinOp
    node.type = self.get_binop(node.op, ltype, rtype)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 212, in get_binop
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: * is not defined on Neuron and Neuron

Code:
transformer deeppoly{
    Neuron_mult -> (
        min( min( prev_0[l] * prev_1[l], prev_0[l] * prev_1[u] ), min( prev_0[u] * prev_1[l], prev_0[u] * prev_1[u] ) ),
        max( max( prev_0[l] * prev_1[l], prev_0[l] * prev_1[u] ), max( prev_0[u] * prev_1[l], prev_0[u] * prev_1[u] ) ),
        prev_0 * prev_1,
        prev_0 * prev_1
    );
}

2025-07-02 17:15:33,547 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:15:33,776 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult -> (
        min(prev_0[l]*prev_1[l], prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], prev_0[u]*prev_1[u]),
        max(prev_0[l]*prev_1[l], prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], prev_0[u]*prev_1[u]),
        prev_0*prev_1,
        prev_0*prev_1
    );
}

2025-07-02 17:15:33,776 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:15:33,776 - INFO - [STEP 1] All 3 samples failed validation. Retrying 5/10...
2025-07-02 17:15:50,280 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult ->
        ((prev_0[l] >= 0) ? (
            (prev_1[l] >= 0) ? (
                prev_0[l]*prev_1[l], prev_0[u]*prev_1[u], prev_0*prev_1, prev_0*prev_1
            ) : (
                prev_1[u] <= 0 ? (
                    prev_0[u]*prev_1[l], prev_0[l]*prev_1[u], prev_0*prev_1, prev_0*prev_1
                ) : (
                    min(prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], 0), max(prev_0[l]*prev_1[l], prev_0[u]*prev_1[u], 0),
                    prev_0*prev_1, prev_0*prev_1
                )
            )
        ) : (
            prev_0[u] <= 0 ? (
                prev_1[l] >= 0 ? (
                    prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], prev_0*prev_1, prev_0*prev_1
                ) : (
                    prev_1[u] <= 0 ? (
                        prev_0[u]*prev_1[u], prev_0[l]*prev_1[l], prev_0*prev_1, prev_0*prev_1
                    ) : (
                        min(prev_0[l]*prev_1[l], prev_0[u]*prev_1[u], 0), max(prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], 0),
                        prev_0*prev_1, prev_0*prev_1
                    )
                )
            ) : (
                min(prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], prev_0[l]*prev_1[l], prev_0[u]*prev_1[u], 0),
                max(prev_0[l]*prev_1[l], prev_0[u]*prev_1[u], prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], 0),
                prev_0*prev_1, prev_0*prev_1
            )
        )
    );
}

2025-07-02 17:15:50,281 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:15:50,506 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult -> (
        min(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        max(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        prev_0 * prev_1,
        prev_0 * prev_1
    );
}

2025-07-02 17:15:50,506 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:15:50,723 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult -> (
        min(prev_0[l] * prev_1[l], prev_0[l] * prev_1[u], prev_0[u] * prev_1[l], prev_0[u] * prev_1[u]),
        max(prev_0[l] * prev_1[l], prev_0[l] * prev_1[u], prev_0[u] * prev_1[l], prev_0[u] * prev_1[u]),
        prev_0 * prev_1,
        prev_0 * prev_1
    );
}

2025-07-02 17:15:50,723 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:15:50,723 - INFO - [STEP 1] All 3 samples failed validation. Retrying 6/10...
2025-07-02 17:16:13,223 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult -> (
        min(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        max(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        prev_0 * prev_1,
        prev_0 * prev_1
    );
}

2025-07-02 17:16:13,228 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:16:13,478 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult ->
        (prev_0[l] >= 0) ? (
            (prev_1[l] >= 0) ?
                (prev_0[l] * prev_1[l], prev_0[u] * prev_1[u], prev_0 * prev_1, prev_0 * prev_1)
            : (prev_1[u] <= 0) ?
                (prev_0[u] * prev_1[l], prev_0[l] * prev_1[u], prev_0 * prev_1, prev_0 * prev_1)
            :
                (min(prev_0[l] * prev_1[u], prev_0[u] * prev_1[l]), max(prev_0[u] * prev_1[u], prev_0[l] * prev_1[l]), prev_0 * prev_1, prev_0 * prev_1)
        : (prev_0[u] <= 0) ?
            (prev_1[l] >= 0) ?
                (prev_0[l] * prev_1[u], prev_0[u] * prev_1[l], prev_0 * prev_1, prev_0 * prev_1)
            : (prev_1[u] <= 0) ?
                (prev_0[u] * prev_1[u], prev_0[l] * prev_1[l], prev_0 * prev_1, prev_0 * prev_1)
            :
                (min(prev_0[l] * prev_1[l], prev_0[u] * prev_1[u]), max(prev_0[u] * prev_1[l], prev_0[l] * prev_1[u]), prev_0 * prev_1, prev_0 * prev_1)
        :
            (prev_1[l] >= 0) ?
                (min(prev_0[l] * prev_1[u], prev_0[u] * prev_1[l]), max(prev_0[u] * prev_1[u], prev_0[l] * prev_1[l]), prev_0 * prev_1, prev_0 * prev_1)
            : (prev_1[u] <= 0) ?
                (min(prev_0[u] * prev_1[l], prev_0[l] * prev_1[u]), max(prev_0[l] * prev_1[l], prev_0[u] * prev_1[u]), prev_0 * prev_1, prev_0 * prev_1)
            :
                (min(prev_0[l] * prev_1[u], prev_0[u] * prev_1[l], prev_0[u] * prev_1[u], prev_0[l] * prev_1[l]), max(prev_0[u] * prev_1[u], prev_0[l] * prev_1[l], prev_0[u] * prev_1[l], prev_0[l] * prev_1[u]), prev_0 * prev_1, prev_0 * prev_1)
    ;
}

2025-07-02 17:16:13,478 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:16:13,842 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 255, in visitBinOp
    node.type = self.get_binop(node.op, ltype, rtype)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 212, in get_binop
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: * is not defined on Neuron and Neuron

Code:
transformer deeppoly{
    Neuron_mult ->
        ((prev_0[l] >= 0) ?
            ((prev_1[l] >= 0) ?
                (prev_0[l] * prev_1[l], prev_0[u] * prev_1[u], prev_0 * prev_1, prev_0 * prev_1) :
                (prev_0[l] * prev_1[u], prev_0[u] * prev_1[l], prev_0 * prev_1, prev_0 * prev_1)
            ) :
            ((prev_0[u] <= 0) ?
                ((prev_1[u] <= 0) ?
                    (prev_0[u] * prev_1[l], prev_0[l] * prev_1[u], prev_0 * prev_1, prev_0 * prev_1) :
                    (prev_0[u] * prev_1[u], prev_0[l] * prev_1[l], prev_0 * prev_1, prev_0 * prev_1)
                ) :
                (min_op(prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], prev_0[l]*prev_1[l], prev_0[u]*prev_1[u]),
                 max_op(prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], prev_0[l]*prev_1[l], prev_0[u]*prev_1[u]),
                 prev_0 * prev_1,
                 prev_0 * prev_1)
            )
        );
}

2025-07-02 17:16:13,843 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:16:13,843 - INFO - [STEP 1] All 3 samples failed validation. Retrying 7/10...
2025-07-02 17:16:22,709 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult -> (
        min(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        max(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        prev_0 * prev_1,
        prev_0 * prev_1
    );
}

2025-07-02 17:16:22,709 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:16:22,928 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult ->
        (
            min(prev_0[l]*prev_1[l], prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], prev_0[u]*prev_1[u]),
            max(prev_0[l]*prev_1[l], prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], prev_0[u]*prev_1[u]),
            (prev_0*prev_1),
            (prev_0*prev_1)
        );
}

2025-07-02 17:16:22,928 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:16:23,217 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult -> (
        min((prev_0[l] * prev_1[l]), (prev_0[l] * prev_1[u]), (prev_0[u] * prev_1[l]), (prev_0[u] * prev_1[u])),
        max((prev_0[l] * prev_1[l]), (prev_0[l] * prev_1[u]), (prev_0[u] * prev_1[l]), (prev_0[u] * prev_1[u])),
        prev_0 * prev_1,
        prev_0 * prev_1
    );
}

2025-07-02 17:16:23,218 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:16:23,218 - INFO - [STEP 1] All 3 samples failed validation. Retrying 8/10...
2025-07-02 17:16:53,486 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult -> (
        min(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        max(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        prev_0 * prev_1,
        prev_0 * prev_1
    );
}

2025-07-02 17:16:53,486 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:16:53,982 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult -> (
        min(
            prev_0[l]*prev_1[l],
            prev_0[l]*prev_1[u],
            prev_0[u]*prev_1[l],
            prev_0[u]*prev_1[u]
        ),
        max(
            prev_0[l]*prev_1[l],
            prev_0[l]*prev_1[u],
            prev_0[u]*prev_1[l],
            prev_0[u]*prev_1[u]
        ),
        prev_0*prev_1,
        prev_0*prev_1
    );
}

2025-07-02 17:16:53,982 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:16:54,206 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult -> (
        min(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        max(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        prev_0 * prev_1,
        prev_0 * prev_1
    );
}

2025-07-02 17:16:54,206 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:16:54,206 - INFO - [STEP 1] All 3 samples failed validation. Retrying 9/10...
2025-07-02 17:17:30,123 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 15, in visit
    return self.visitBinOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 255, in visitBinOp
    node.type = self.get_binop(node.op, ltype, rtype)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 212, in get_binop
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: * is not defined on Neuron and Neuron

Code:
transformer deeppoly{
    Neuron_mult ->
        (prev_0[l] >= 0) ?
            ((prev_1[l] >= 0) ?
                (simplify_lower(prev_0, prev_1[l]), simplify_upper(prev_0, prev_1[u]), prev_0 * prev_1, prev_0 * prev_1)
            :
                (prev_1[u] <= 0) ?
                    (simplify_lower(prev_0, prev_1[u]), simplify_upper(prev_0, prev_1[l]), prev_0 * prev_1, prev_0 * prev_1)
                :
                    (min(simplify_lower(prev_0, prev_1[l]), simplify_lower(prev_0, prev_1[u])), max(simplify_upper(prev_0, prev_1[l]), simplify_upper(prev_0, prev_1[u])), prev_0 * prev_1, prev_0 * prev_1)
        )
        :
            (prev_0[u] <= 0) ?
                ((prev_1[l] >= 0) ?
                    (simplify_lower(prev_0, prev_1[u]), simplify_upper(prev_0, prev_1[l]), prev_0 * prev_1, prev_0 * prev_1)
                :
                    (prev_1[u] <= 0) ?
                        (simplify_lower(prev_0, prev_1[l]), simplify_upper(prev_0, prev_1[u]), prev_0 * prev_1, prev_0 * prev_1)
                    :
                        (min(simplify_lower(prev_0, prev_1[l]), simplify_lower(prev_0, prev_1[u])), max(simplify_upper(prev_0, prev_1[l]), simplify_upper(prev_0, prev_1[u])), prev_0 * prev_1, prev_0 * prev_1)
                )
            :
                (prev_1[l] >= 0) ?
                    (min(simplify_lower(prev_0, prev_1[l]), simplify_lower(prev_0, prev_1[u])), max(simplify_upper(prev_0, prev_1[l]), simplify_upper(prev_0, prev_1[u])), prev_0 * prev_1, prev_0 * prev_1)
                :
                    (prev_1[u] <= 0) ?
                        (min(simplify_lower(prev_0, prev_1[l]), simplify_lower(prev_0, prev_1[u])), max(simplify_upper(prev_0, prev_1[l]), simplify_upper(prev_0, prev_1[u])), prev_0 * prev_1, prev_0 * prev_1)
                    :
                        (min(
                            min(simplify_lower(prev_0, prev_1[l]), simplify_lower(prev_0, prev_1[u])),
                            min(simplify_lower(prev_0, prev_1[l]), simplify_lower(prev_0, prev_1[u]))
                        ), max(
                            max(simplify_upper(prev_0, prev_1[l]), simplify_upper(prev_0, prev_1[u])),
                            max(simplify_upper(prev_0, prev_1[l]), simplify_upper(prev_0, prev_1[u]))
                        ), prev_0 * prev_1, prev_0 * prev_1)
        ;
}

2025-07-02 17:17:30,124 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:17:30,403 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult ->
        (prev_0[l] >= 0) ?
            ((prev_1[l] >= 0) ?
                (simplify_lower(prev_0,1) * simplify_lower(prev_1,1),
                 simplify_upper(prev_0,1) * simplify_upper(prev_1,1),
                 prev_0 * prev_1,
                 prev_0 * prev_1)
            :
            ((prev_1[u] <= 0) ?
                (simplify_lower(prev_0,1) * simplify_upper(prev_1,1),
                 simplify_upper(prev_0,1) * simplify_lower(prev_1,1),
                 prev_0 * prev_1,
                 prev_0 * prev_1)
            :
                (min(prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], prev_0[l]*prev_1[l], prev_0[u]*prev_1[u]),
                 max(prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], prev_0[l]*prev_1[l], prev_0[u]*prev_1[u]),
                 prev_0 * prev_1,
                 prev_0 * prev_1)
            )
        :
        ((prev_0[u] <= 0) ?
            ((prev_1[l] >= 0) ?
                (simplify_upper(prev_0,1) * simplify_lower(prev_1,1),
                 simplify_lower(prev_0,1) * simplify_upper(prev_1,1),
                 prev_0 * prev_1,
                 prev_0 * prev_1)
            :
            ((prev_1[u] <= 0) ?
                (simplify_upper(prev_0,1) * simplify_upper(prev_1,1),
                 simplify_lower(prev_0,1) * simplify_lower(prev_1,1),
                 prev_0 * prev_1,
                 prev_0 * prev_1)
            :
                (min(prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], prev_0[l]*prev_1[l], prev_0[u]*prev_1[u]),
                 max(prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], prev_0[l]*prev_1[l], prev_0[u]*prev_1[u]),
                 prev_0 * prev_1,
                 prev_0 * prev_1)
            )
        )
        :
            (min(prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], prev_0[l]*prev_1[l], prev_0[u]*prev_1[u]),
             max(prev_0[l]*prev_1[u], prev_0[u]*prev_1[l], prev_0[l]*prev_1[l], prev_0[u]*prev_1[u]),
             prev_0 * prev_1,
             prev_0 * prev_1)
        );
}

2025-07-02 17:17:30,403 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:17:30,630 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Neuron_mult -> (
        min(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        max(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        prev_0 * prev_1,
        prev_0 * prev_1
    );
}

2025-07-02 17:17:30,631 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:17:30,631 - INFO - [STEP 1] All 3 samples failed validation. Retrying 10/10...
2025-07-02 17:17:30,631 - INFO - [Neuron_mult] Runtime: 189.92 seconds
2025-07-02 17:17:30,631 - ERROR - Failed with Error:[STEP 1] Failed after 10 retries.
 during generating code:
transformer deeppoly{
    Neuron_mult -> (
        min(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        max(
            prev_0[l] * prev_1[l],
            prev_0[l] * prev_1[u],
            prev_0[u] * prev_1[l],
            prev_0[u] * prev_1[u]
        ),
        prev_0 * prev_1,
        prev_0 * prev_1
    );
}

2025-07-02 17:17:30,631 - INFO - 2025-07-02 17:17:30.631328 - Extracting Relu
2025-07-02 17:17:30,631 - INFO -
API: Relu -> Model: gpt-4o @ http://ggnds-serv-01.cs.illinois.edu:8084
2025-07-02 17:17:30,631 - INFO - [STEP 1] Starting step 1/1
2025-07-02 17:17:37,667 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:17:38,265 - INFO - [STEP 1] Sample 2: Validation passed.
2025-07-02 17:17:38,265 - INFO - [Relu] Runtime: 7.63 seconds
2025-07-02 17:17:38,265 - INFO - Succeed. Saved to logs/2025-07-02_16-51-47/results/gpt-4o/success/Relu.txt

2025-07-02 17:17:38,265 - INFO - 2025-07-02 17:17:38.265471 - Extracting Relu6
2025-07-02 17:17:38,265 - INFO -
API: Relu6 -> Model: gpt-4o @ http://ggnds-serv-01.cs.illinois.edu:8084
2025-07-02 17:17:38,265 - INFO - [STEP 1] Starting step 1/1
2025-07-02 17:17:53,168 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        ((prev[u]) <= 0) ? (0, 0, 0, 0) :
        ((prev[l]) >= 6) ? (6, 6, 6, 6) :
        ((prev[l]) >= 0 && (prev[u]) <= 6) ? (prev[l], prev[u], prev, prev) :
        ((prev[l]) < 0 && (prev[u]) <= 6) ?
            (0, prev[u], 0, (prev[u]/(prev[u]-prev[l]))*prev - (prev[u]*prev[l])/(prev[u]-prev[l]))) :
        ((prev[l]) >= 0 && (prev[u]) > 6) ?
            (prev[l], 6, prev, ((6-prev[l])/(prev[u]-prev[l]))*prev + ((prev[u]-6)*prev[l])/(prev[u]-prev[l]))) :
        (0, 6, 0, ((6/(prev[u]-prev[l]))*prev) - (6*prev[l])/(prev[u]-prev[l]));
}

2025-07-02 17:17:53,168 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:17:53,402 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        (prev[l] >= 6) ? (6, 6, 6, 6) :
        ((prev[u] <= 0) ? (0, 0, 0, 0) :
        ((prev[l] >= 0 && prev[u] <= 6) ? (prev[l], prev[u], prev, prev) :
        ((prev[l] < 0 && prev[u] <= 6) ?
            (0, prev[u], 0, (prev[u]/(prev[u]-prev[l]))*prev - (prev[u]*prev[l])/(prev[u]-prev[l])) :
        ((prev[l] >= 0 && prev[u] > 6) ?
            (prev[l], 6, prev, prev + (6 - prev[u])) :
        // Mixed
            (0, 6,
                0,
                ( (6 - prev[l])/(prev[u]-prev[l]) ) * prev + ( -prev[l]*6/(prev[u]-prev[l]) )
            )
        ))));
}

2025-07-02 17:17:53,402 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:17:53,650 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        ((prev[l]) >= 6) ? (6, 6, 6, 6) :
        ((prev[u]) <= 0) ? (0, 0, 0, 0) :
        ((prev[l]) >= 0 && (prev[u]) <= 6) ? (prev[l], prev[u], prev, prev) :
        ((prev[l]) < 0 && (prev[u]) > 0 && (prev[u]) <= 6) ? (0, prev[u], 0, (((prev[u]) / ((prev[u]) - (prev[l]))) * prev) - (((prev[u]) * (prev[l])) / ((prev[u]) - (prev[l])))) :
        ((prev[l]) >= 0 && (prev[l]) < 6 && (prev[u]) > 6) ? (prev[l], 6, prev, prev + ((6 - prev[u]) * (prev - prev[u])) / (prev[u] - prev[l])) :
        ((prev[l]) < 0 && (prev[u]) > 6) ? (0, 6, 0, ((((6 - prev[l]) / (prev[u] - prev[l]))) * prev) - (((prev[l]) * 6) / (prev[u] - prev[l]))) :
        (0, 6, 0, 6);
}

2025-07-02 17:17:53,651 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:17:53,651 - INFO - [STEP 1] All 3 samples failed validation. Retrying 1/10...
2025-07-02 17:18:10,774 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        (prev[l] >= 6) ? (6, 6, 6, 6) :
        (prev[u] <= 0) ? (0, 0, 0, 0) :
        (prev[l] >= 0) ?
            (prev[u] <= 6) ?
                (prev[l], prev[u], prev, prev) :
                (prev[l], 6, prev, ((6-prev[l])/(prev[u]-prev[l]))*prev + (prev[u]-6)/(prev[u]-prev[l])*6)
        :
        (prev[u] <= 6) ?
            (0, prev[u], 0, prev) :
            (0, 6, 0, ((6) / (prev[u] - prev[l])) * prev - ((prev[l] * 6) / (prev[u] - prev[l])));
}

2025-07-02 17:18:10,774 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:18:11,006 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        ((prev[l]) >= 6)    ? (6, 6, 6, 6)
     : ((prev[u]) <= 0)    ? (0, 0, 0, 0)
     : ((prev[l]) >= 0 && (prev[u]) <= 6) ? (prev[l], prev[u], prev, prev)
     : ((prev[l]) < 0 && (prev[u]) <= 6)  ? (0, prev[u], 0, (prev[u]/(prev[u]-prev[l]))*prev - ((prev[u]*prev[l])/(prev[u]-prev[l])))
     : ((prev[l]) >= 0 && (prev[u]) > 6)  ? (prev[l], 6, prev, prev + ((6-prev[u])/(prev[u]-prev[l]))*(prev - prev[l]))
     : (0, 6, 0, (6/(prev[u]-prev[l]))*prev - ((prev[l]*6)/(prev[u]-prev[l])));
}

2025-07-02 17:18:11,006 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:18:11,242 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 -> (
        ((prev[l]) >= 6) ? (6, 6, 6, 6) : (
            (prev[u] <= 0) ? (0, 0, 0, 0) : (
                (prev[l] >= 0 && prev[u] <= 6) ? (prev[l], prev[u], prev, prev) : (
                    (prev[l] < 0 && prev[u] > 0 && prev[u] <= 6) ? (
                        0, prev[u], 0, (((prev[u]) / ((prev[u]) - (prev[l]))) * (prev)) - (((prev[u]) * (prev[l])) / ((prev[u]) - (prev[l])))
                    ) : (
                        (prev[l] >= 0 && prev[l] < 6 && prev[u] > 6) ? (
                            prev[l], 6, prev, ((6 - prev[l]) / (prev[u] - prev[l])) * (prev) + ((prev[u] - 6) / (prev[u] - prev[l])) * 6
                        ) : (
                            0, 6, 0,
                            max(
                                (((prev[u])/((prev[u])-(prev[l])))*(prev)) - (((prev[u])*(prev[l]))/((prev[u])-(prev[l]))),
                                ((6-(prev[l]))/((prev[u])-(prev[l])))*(prev) + (((prev[u])-6)/((prev[u])-(prev[l])))*6
                            )
                        )
                    )
                )
            )
        )
    );
}

2025-07-02 17:18:11,242 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:18:11,242 - INFO - [STEP 1] All 3 samples failed validation. Retrying 2/10...
2025-07-02 17:18:28,768 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        (prev[u] <= 0) ? (0, 0, 0, 0)
        :
        (prev[l] >= 6) ? (6, 6, 6, 6)
        :
        (prev[l] >= 0 && prev[u] <= 6) ? (prev[l], prev[u], prev, prev)
        :
        (prev[l] < 0 && prev[u] <= 6) ? (0, prev[u], 0, ((prev[u] / (prev[u] - prev[l])) * prev) - ((prev[u] * prev[l]) / (prev[u] - prev[l])))
        :
        (prev[l] >= 0 && prev[u] > 6) ? (prev[l], 6, prev, prev + ((6 - prev[u]) / (prev[u] - prev[l])) * (prev - prev[l]) )
        :
        (0, 6, 0, (6 / (prev[u] - prev[l])) * prev - (6 * prev[l] / (prev[u] - prev[l])));
}

2025-07-02 17:18:28,768 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:18:29,010 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 -> (
        (prev[l] >= 6) ? (6, 6, 6, 6) :
        (prev[u] <= 0) ? (0, 0, 0, 0) :
        (prev[l] >= 0 && prev[u] <= 6) ? (prev[l], prev[u], prev, prev) :
        (prev[l] < 0 && prev[u] <= 6) ? (0, prev[u], 0, (prev[u] / (prev[u] - prev[l])) * prev - (prev[u] * prev[l]) / (prev[u] - prev[l])) :
        (prev[l] >= 0 && prev[u] > 6) ? (prev[l], 6, prev, ((6 - prev[l]) / (prev[u] - prev[l])) * (prev - prev[l]) + 6) :
        (0, 6, 0, (prev[u] / (prev[u] - prev[l])) * prev - (prev[u] * prev[l]) / (prev[u] - prev[l]) + ((6 - prev[l]) / (prev[u] - prev[l])) * (prev - prev[l]) + 6)
    );
}

2025-07-02 17:18:29,010 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:18:29,593 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        (prev[l] >= 6) ? (6, 6, 6, 6)
        : (prev[u] <= 0) ? (0, 0, 0, 0)
        : (prev[l] >= 0 && prev[u] <= 6) ? (prev[l], prev[u], prev, prev)
        : (prev[l] < 0 && prev[u] > 6) ? (0, 6, 0, prev * ((6-0)/(prev[u]-prev[l])) - (prev[l]*6/(prev[u]-prev[l])))
        : (prev[l] < 0) ? (0, prev[u], 0, prev * ((prev[u]-0)/(prev[u]-prev[l])))
        : (prev[u] > 6) ? (prev[l], 6, prev, prev * ((6-prev[l])/(prev[u]-prev[l])) + prev[u]*(-prev[l])/(prev[u]-prev[l]))
        : (0, 6, 0, 6);
}

2025-07-02 17:18:29,593 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:18:29,593 - INFO - [STEP 1] All 3 samples failed validation. Retrying 3/10...
2025-07-02 17:18:45,218 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 389, in visitMaxOp
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: min is not defined on Neuron and Int

Code:
transformer deeppoly{
    Relu6 ->
        ((prev[u]) <= 0) ?
            (0, 0, 0, 0)
        : (((prev[l]) >= 6) ?
            (6, 6, 6, 6)
        : (((prev[l]) >= 0) ?
            ((prev[l]), min(prev[u], 6), prev, min(prev, 6))
        : (((prev[u]) <= 6) ?
            (0, prev[u], 0, prev)
        :
            (0, 6, 0, (prev * 6 / (prev[u] - prev[l])) - ((prev[l] * 6) / (prev[u] - prev[l])))
        )));
}

2025-07-02 17:18:45,218 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:18:45,454 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        (prev[l] >= 6) ? (6, 6, 6, 6) :
        ((prev[u] <= 0) ? (0, 0, 0, 0) :
        ((prev[l] >= 0 && prev[u] <= 6) ? (prev[l], prev[u], prev, prev) :
        ((prev[l] < 0 && prev[u] > 6) ? (0, 6, 0, (prev * 6) / (prev[u] - prev[l]) - ((prev[l] * 6) / (prev[u] - prev[l]))) :
        ((prev[l] < 0) ? (0, prev[u], 0, (prev * prev[u]) / (prev[u] - prev[l]) - ((prev[l] * prev[u]) / (prev[u] - prev[l]))) :
        (prev[l], 6, prev, (prev * (6 - prev[l]) + prev[l] * (prev[u] - 6)) / (prev[u] - prev[l]))))));
}

2025-07-02 17:18:45,454 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:18:45,687 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        (prev[l] >= 6) ?
            (6, 6, 6, 6)
        : (prev[u] <= 0) ?
            (0, 0, 0, 0)
        : (prev[l] >= 0 && prev[u] <= 6) ?
            (prev[l], prev[u], prev, prev)
        : (prev[l] < 0 && prev[u] > 6) ?
            (0, 6, 0, ((6/(prev[u]-prev[l]))*prev) - ((6*prev[l])/(prev[u]-prev[l])))
        : (prev[l] >= 0 && prev[u] > 6) ?
            (prev[l], 6, prev, ((6/(prev[u]-prev[l]))*prev) - ((6*prev[l])/(prev[u]-prev[l])))
        : (prev[l] < 0 && prev[u] <= 6) ?
            (0, prev[u], 0, prev)
        : (0, 6, 0, ((6/(prev[u]-prev[l]))*prev) - ((6*prev[l])/(prev[u]-prev[l])));
}

2025-07-02 17:18:45,687 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:18:45,687 - INFO - [STEP 1] All 3 samples failed validation. Retrying 4/10...
2025-07-02 17:19:10,745 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        (prev[l] >= 6) ? (6, 6, 6, 6) :
        ((prev[u] <= 0) ? (0, 0, 0, 0) :
        ((prev[l] >= 0 && prev[u] <= 6) ? (prev[l], prev[u], prev, prev) :
        ((prev[l] < 0 && prev[u] <= 6) ? (0, prev[u], 0, (prev[u]/(prev[u] - prev[l])) * prev - ((prev[u] * prev[l])/(prev[u] - prev[l]))) :
        ((prev[l] >= 0 && prev[u] > 6) ? (prev[l], 6, prev, (((6 - prev[l])/(prev[u] - prev[l])) * prev) + (prev[u]*(prev[l] - 6)/(prev[u] - prev[l]))) :
        (0, 6, 0, ((6/(prev[u] - prev[l]))*prev) + (prev[u]*(-6)/(prev[u] - prev[l])))))));
}

2025-07-02 17:19:10,745 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:19:11,027 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 389, in visitMaxOp
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: min is not defined on Neuron and Int

Code:
transformer deeppoly{
    Relu6 -> ((prev[l]) >= 6) ? (6, 6, 6, 6)
    : (((prev[u]) <= 0) ? (0, 0, 0, 0)
    : (((prev[l]) >= 0) ? ((min(prev[u], 6)), (min(prev[u], 6)), (min(prev, 6)), (min(prev, 6)))
    : (((prev[u]) <= 6) ? (0, (prev[u]), 0, ((prev[u]) / ((prev[u]) - (prev[l])) * prev) - ((prev[u]) * (prev[l]) / (prev[u] - prev[l])) )
    : (0, 6, 0, ((6-prev[l])/(prev[u]-prev[l]))*prev - ((prev[l]*6)/(prev[u]-prev[l])) )
    )));
}

2025-07-02 17:19:11,027 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:19:11,272 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        (prev[l] >= 6) ? (6, 6, 6, 6) :
        (prev[u] <= 0) ? (0, 0, 0, 0) :
        (prev[l] >= 0 && prev[u] <= 6) ? (prev[l], prev[u], prev, prev) :
        (prev[l] < 0 && prev[u] <= 6) ? (0, prev[u], 0, prev*(prev[u])/(prev[u]-prev[l]) - (prev[u]*prev[l])/(prev[u]-prev[l])) :
        (prev[l] >= 0 && prev[u] > 6) ? (prev[l], 6, prev, (6-prev[l])/(prev[u]-prev[l]) * (prev) + (prev[u]-6)/(prev[u]-prev[l]) * 6) :
        (0, 6, 0,
            ((prev[u])/(prev[u]-prev[l]))*(prev)-(prev[u]*prev[l])/(prev[u]-prev[l])
                <=
            ((6-prev[l])/(prev[u]-prev[l]))*(prev) + ((prev[u]-6)/(prev[u]-prev[l]))*6
        ? ((prev[u])/(prev[u]-prev[l]))*(prev)-(prev[u]*prev[l])/(prev[u]-prev[l])
        : ((6-prev[l])/(prev[u]-prev[l]))*(prev) + ((prev[u]-6)/(prev[u]-prev[l]))*6
        );
}

2025-07-02 17:19:11,272 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:19:11,272 - INFO - [STEP 1] All 3 samples failed validation. Retrying 5/10...
2025-07-02 17:19:32,218 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        (prev[l] >= 6) ?
            (6, 6, 6, 6) :
        (prev[u] <= 0) ?
            (0, 0, 0, 0) :
        (prev[l] >= 0 && prev[u] <= 6) ?
            (prev[l], prev[u], prev, prev) :
        (prev[l] < 0 && prev[u] > 6) ?
            (0, 6, 0, ((6 / (prev[u] - prev[l])) * prev) - ((6 * prev[l]) / (prev[u] - prev[l]))) :
        (prev[l] < 0) ?
            (0, prev[u], 0, ((prev[u] / (prev[u] - prev[l])) * prev) - ((prev[u] * prev[l]) / (prev[u] - prev[l]))) :
        (prev[u] > 6) ?
            (prev[l], 6, prev, ((6 - prev[l]) / (prev[u] - prev[l])) * (prev - prev[l]) + prev[l]) :
        (prev[l], prev[u], prev, prev)
    ;
}

2025-07-02 17:19:32,219 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:19:32,462 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        ((prev[l]) >= 6) ?
            (6, 6, 6, 6)
        :
        (((prev[u]) <= 0) ?
            (0, 0, 0, 0)
        :
        (((prev[l]) >= 0) & ((prev[u]) <= 6) ?
            ((prev[l]), (prev[u]), (prev), (prev))
        :
        (((prev[l]) < 0) & ((prev[u]) > 0) & ((prev[u]) <= 6) ?
            (0, (prev[u]), 0, ((prev[u]) / ((prev[u]) - (prev[l]))) * (prev) - ((prev[u]) * (prev[l])) / ((prev[u]) - (prev[l])))
        :
        (((prev[l]) < 6) & ((prev[u]) > 6) & ((prev[l]) >= 0) ?
            ((prev[l]), 6, (prev), (prev) + ((6 - (prev[u]))/(prev[u] - prev[l])) * ((prev[u]) - (prev)))
        :
        (((prev[l]) < 0) & ((prev[u]) > 6) ?
            (0, 6, 0, (((prev[u]) / ((prev[u]) - (prev[l]))) * (prev) - ((prev[u]) * (prev[l])) / ((prev[u]) - (prev[l]))) + (((6 - (prev[u]))/(prev[u] - prev[l])) * ((prev[u]) - (prev))))
        :
            (0, 6, 0, 6)
        )))));
}

2025-07-02 17:19:32,462 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:19:32,708 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        ((prev[l]) >= 6) ? (6, 6, 6, 6)
        : (((prev[u]) <= 0) ? (0, 0, 0, 0)
        : (((prev[l]) >= 0 && (prev[u]) <= 6) ? (prev[l], prev[u], prev, prev)
        : (((prev[l]) < 0 && (prev[u]) > 0 && (prev[u]) <= 6) ?
              (0, prev[u], 0, ((prev[u]/(prev[u]-prev[l])) * prev) - ((prev[u]*prev[l])/(prev[u]-prev[l])))
           : (((prev[l]) >= 0 && (prev[l]) < 6 && (prev[u]) > 6) ?
                 (prev[l], 6, prev, prev + ((6 - prev[u])/(prev[u] - prev[l])) * (prev - prev[l]))
             : (0, 6, 0,
                 min(
                     ((prev[u]/(prev[u]-prev[l])) * prev) - ((prev[u]*prev[l])/(prev[u]-prev[l])),
                     (6 + ((prev[l]-6)/(prev[l]-prev[u])) * (prev - prev[u]))
                 )
             )
           )
        )));
}

2025-07-02 17:19:32,708 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:19:32,708 - INFO - [STEP 1] All 3 samples failed validation. Retrying 6/10...
2025-07-02 17:19:50,725 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        (prev[l] >= 6) ? (6, 6, 6, 6)
        : (prev[u] <= 0) ? (0, 0, 0, 0)
        : (prev[l] >= 0 && prev[u] <= 6) ? (prev[l], prev[u], prev, prev)
        : (prev[l] < 0 && prev[u] <= 6) ? (0, prev[u], 0, ((prev[u]) / (prev[u] - prev[l])) * prev - ((prev[u] * prev[l]) / (prev[u] - prev[l])))
        : (prev[l] >= 0 && prev[u] > 6) ? (prev[l], 6, prev, ((6 - prev[l]) / (prev[u] - prev[l])) * prev + (prev[u] - 6) / (prev[u] - prev[l]) * 6)
        : (0, 6, 0, (((6 - prev[l]) / (prev[u] - prev[l])) * prev) + ((prev[u] - 6) / (prev[u] - prev[l])) * 6)
    ;
}

2025-07-02 17:19:50,725 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:19:50,999 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        ((prev[l]) >= 6)
            ? (6, 6, 6, 6)
            : ((prev[u]) <= 0)
                ? (0, 0, 0, 0)
                : ((prev[l]) >= 0 && (prev[u]) <= 6)
                    ? (prev[l], prev[u], prev, prev)
                    : ((prev[l]) < 0 && (prev[u]) > 0 && (prev[u]) <= 6)
                        ? (0, prev[u], 0, ((prev[u])/((prev[u])-(prev[l])))*(prev) - ((prev[u])*(prev[l]))/((prev[u])-(prev[l])))
                        : ((prev[l]) >= 0 && (prev[l]) < 6 && (prev[u]) > 6)
                            ? (prev[l], 6, prev, ((6 - prev[l])/(prev[u] - prev[l]))*(prev) + ((prev[u] - 6)/(prev[u] - prev[l]))*6)
                            : (0, 6, 0, ((6 - prev[l])/(prev[u] - prev[l]))*(prev) + ((prev[u] - 6)/(prev[u] - prev[l]))*6)
        ;
}

2025-07-02 17:19:50,999 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:19:51,651 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:19:51,651 - INFO - [STEP 1] All 3 samples failed validation. Retrying 7/10...
2025-07-02 17:20:16,189 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 -> (
        (prev[l] >= 6) ? (6, 6, 6, 6) :
        ((prev[u] <= 0) ? (0, 0, 0, 0) :
        ((prev[l] >= 0 && prev[u] <= 6) ? (prev[l], prev[u], prev, prev) :
        ((prev[l] < 0 && prev[u] > 0 && prev[u] <= 6) ? (0, prev[u], 0, (prev[u] / (prev[u] - prev[l])) * prev - (prev[u] * prev[l]) / (prev[u] - prev[l])) :
        ((prev[l] >= 0 && prev[l] < 6 && prev[u] > 6) ? (prev[l], 6, prev, ((6 - prev[l]) / (prev[u] - prev[l])) * (prev - prev[l]) + prev[l]) :
        (0, 6, 0, max( ((prev[u] / (prev[u] - prev[l])) * prev - (prev[u] * prev[l]) / (prev[u] - prev[l])), ((6 - prev[l]) / (prev[u] - prev[l])) * (prev - prev[l]) + prev[l] ))
        )))));
}

2025-07-02 17:20:16,190 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:20:16,439 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        ((prev[l]) >= 6) ? (6, 6, 6, 6)
        : (((prev[u]) <= 0) ? (0, 0, 0, 0)
        : (((prev[l]) >= 0) & ((prev[u]) <= 6)) ? (prev[l], prev[u], prev, prev)
        : (((prev[l]) < 0) & ((prev[u]) > 0) & ((prev[u]) <= 6)) ? (0, prev[u], 0, ((prev[u])/(prev[u] - prev[l])) * prev - ((prev[u] * prev[l])/(prev[u] - prev[l])))
        : (((prev[l]) < 0) & ((prev[u]) > 6)) ? (0, 6, 0, prev * (6 - prev[l])/(prev[u] - prev[l]) - ((prev[u] * prev[l] - 6 * prev[l])/(prev[u] - prev[l])))
        : (((prev[l]) >= 0) & ((prev[l]) < 6) & ((prev[u]) > 6)) ? (prev[l], 6, prev, ((6 - prev[l])/(prev[u] - prev[l])) * prev + ((prev[u] - 6) * prev[l])/(prev[u] - prev[l]))
        : (0, 6, 0, 6));
}

2025-07-02 17:20:16,439 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:20:16,749 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 389, in visitMaxOp
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: min is not defined on Neuron and Int

Code:
transformer deeppoly{
    Relu6 -> ((prev[l]) >= 6)
        ? (6, 6, 6, 6)
        : ((prev[u]) <= 0)
            ? (0, 0, 0, 0)
            : ((prev[l]) >= 0)
                ? ((min(prev[u], 6)), (min(prev[u], 6)), (min(prev, 6)), (min(prev, 6)))
                : ((prev[u]) <= 6)
                    ? (0, (prev[u]), 0, ((prev[u]) / ((prev[u]) - (prev[l])) * (prev) - ((prev[u]) * (prev[l]) / ((prev[u]) - (prev[l])))))
                    : (0, 6, 0, ((6 / (prev[u] - prev[l])) * (prev) - ((prev[l]) * 6 / (prev[u] - prev[l]))));
}

2025-07-02 17:20:16,750 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:20:16,750 - INFO - [STEP 1] All 3 samples failed validation. Retrying 8/10...
2025-07-02 17:20:35,155 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:20:35,389 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        ((prev[l]) >= 6) ?
            (6, 6, 6, 6)
        : (((prev[u]) <= 0) ?
            (0, 0, 0, 0)
        : (((prev[l]) >= 0) & ((prev[u]) <= 6)) ?
            (prev[l], prev[u], prev, prev)
        : (((prev[l]) < 0) & ((prev[u]) > 0) & ((prev[u]) <= 6)) ?
            (0, prev[u], 0, ((prev[u]) / ((prev[u]) - (prev[l]))) * prev - ((prev[u]) * (prev[l])) / ((prev[u]) - (prev[l])))
        : (((prev[l]) >= 0) & ((prev[l]) < 6) & ((prev[u]) > 6)) ?
            (prev[l], 6, prev, 6)
        : (0, 6, 0, ((prev[u]) / ((prev[u]) - (prev[l]))) * prev - ((prev[u]) * (prev[l])) / ((prev[u]) - (prev[l])) + ((6 - (prev[l])) / ((prev[u]) - (prev[l]))) * (prev - prev[u]) + 6))
}

2025-07-02 17:20:35,389 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:20:35,629 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        ((prev[l]) >= 6) ? (6, 6, 6, 6)
        : (((prev[u]) <= 0) ? (0, 0, 0, 0)
        : (((prev[l]) >= 0) & ((prev[u]) <= 6)) ? (prev[l], prev[u], prev, prev)
        : (((prev[l]) < 0) & ((prev[u]) > 0) & ((prev[u]) <= 6)) ? (0, prev[u], 0, (prev[u] / (prev[u] - prev[l])) * prev - ((prev[u] * prev[l]) / (prev[u] - prev[l])))
        : (((prev[l]) >= 0) & ((prev[l]) < 6) & ((prev[u]) > 6)) ? (prev[l], 6, prev, prev + ((6 - prev[u]) / (prev[u] - prev[l])) * (6 - prev))
        : ((0, 6, 0, (prev[u] / (prev[u] - prev[l])) * prev - ((prev[u] * prev[l]) / (prev[u] - prev[l])) + ((6 - prev[u]) / (prev[u] - prev[l])) * (6 - prev)))
        );
}

2025-07-02 17:20:35,629 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:20:35,629 - INFO - [STEP 1] All 3 samples failed validation. Retrying 9/10...
2025-07-02 17:20:51,319 - WARNING - [STEP 1] Sample 1: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        (prev[l] >= 6) ? (6, 6, 6, 6)
        : (prev[u] <= 0) ? (0, 0, 0, 0)
        : (prev[l] >= 0 && prev[u] <= 6) ? (prev[l], prev[u], prev, prev)
        : (prev[l] < 0 && prev[u] <= 6) ? (0, prev[u], 0, (prev[u] / (prev[u] - prev[l])) * prev - ((prev[u] * prev[l]) / (prev[u] - prev[l])))
        : (prev[l] >= 0 && prev[u] > 6) ? (prev[l], 6, prev, ((6 - prev[l]) / (prev[u] - prev[l])) * (prev - prev[l]) + prev[l])
        : (prev[l] < 0 && prev[u] > 6) ? (0, 6, 0, (6 / (prev[u] - prev[l])) * prev - ((6 * prev[l]) / (prev[u] - prev[l])))
        : (0, 6, 0, (6 / (prev[u] - prev[l])) * prev - ((6 * prev[l]) / (prev[u] - prev[l])));
}

2025-07-02 17:20:51,319 - INFO - [STEP 1] Sample 1: Validation failed.
2025-07-02 17:20:51,562 - WARNING - [STEP 1] Sample 2: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 43, in run_verifier_from_str
    astTC.ASTTC().visit(ast)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 93, in visit
    return self.visitProg(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 935, in visitProg
    self.visit(node.stmt)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 914, in visitSeq
    self.visit(node.stmt1)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 89, in visit
    return self.visitSeq(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 915, in visitSeq
    self.visit(node.stmt2)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 75, in visit
    return self.visitTransformer(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 833, in visitTransformer
    self.visit(node.oplist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 73, in visit
    return self.visitOpList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 814, in visitOpList
    self.visit(s)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 71, in visit
    return self.visitOpStmt(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 799, in visitOpStmt
    self.visit(node.ret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 738, in visitTransRetIf
    self.visit(node.fret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 69, in visit
    return self.visitTransRetIf(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 737, in visitTransRetIf
    self.visit(node.tret)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 67, in visit
    return self.visitTransRetBasic(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 726, in visitTransRetBasic
    rettype = self.visit(node.exprlist)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 13, in visit
    return self.visitExprList(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 175, in visitExprList
    listtype.append(self.visit(e))
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astVisitor.py", line 23, in visit
    return self.visitMaxOp(node)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astTC.py", line 389, in visitMaxOp
    raise TypeMismatchException(
constraintflow.core.astTC.TypeMismatchException: min is not defined on Neuron and Int

Code:
transformer deeppoly{
    Relu6 -> ((prev[l]) >= 6) ? (6, 6, 6, 6)
        : (((prev[u]) <= 0) ? (0, 0, 0, 0)
        : (((prev[l]) >= 0) ? ((prev[l]), min(prev[u],6), (prev), min(prev,6))
        : (((prev[u]) <= 6) ? (0, (prev[u]), 0, (prev))
        : (0, 6,
              0,
              (prev * ((prev[u] - 0)/(prev[u] - prev[l]))) - (prev[l] * prev[u]/(prev[u] - prev[l])) )
        )));
}

2025-07-02 17:20:51,562 - INFO - [STEP 1] Sample 2: Validation failed.
2025-07-02 17:20:51,801 - WARNING - [STEP 1] Sample 3: Validator exception. Full traceback:
Traceback (most recent call last):
  File "/home/qiuhan/constraintsflow_patch/generation/gen.py", line 141, in step_by_step_gen
    result, ce = step.validator(code)
  File "/home/qiuhan/constraintsflow_patch/generation/validator/soundness_check.py", line 111, in validator
    return run_verifier_from_str(full_dsl)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/experiments/experiments_correct.py", line 42, in run_verifier_from_str
    ast = astBuilder.ASTBuilder().visit(tree)
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 575, in accept
    return visitor.visitProg(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 18, in visitProg
    stmt = self.visit(ctx.statement())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 41, in visitSeqstmt
    stmt1 = self.visit(ctx.statement(0))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 800, in accept
    return visitor.visitSeqstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 42, in visitSeqstmt
    stmt2 = self.visit(ctx.statement(1))
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 824, in accept
    return visitor.visitTransstmt(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 46, in visitTransstmt
    return self.visit(ctx.transformer())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1019, in accept
    return visitor.visitTransformer(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 54, in visitTransformer
    op_list = self.visit(ctx.op_list())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/dslParser.py", line 1074, in accept
    return visitor.visitOp_list(self)
  File "/home/qiuhan/constraintsflow_patch/constraintflow/core/astBuilder.py", line 63, in visitOp_list
    stmt = self.visit(ctx.op_stmt())
  File "/apps/conda/qiuhan/envs/llm/lib/python3.10/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
AttributeError: 'NoneType' object has no attribute 'accept'

Code:
transformer deeppoly{
    Relu6 ->
        ((prev[l]) >= 6) ? (6, 6, 6, 6) :
        ((prev[u]) <= 0) ? (0, 0, 0, 0) :
        ((prev[l]) >= 0 && (prev[u]) <= 6) ? (prev[l], prev[u], prev, prev) :
        ((prev[l]) < 0 && (prev[u]) > 0 && (prev[u]) <= 6) ? (0, prev[u], 0, ((prev[u])/(prev[u]-prev[l]))*prev - ((prev[u])*prev[l])/(prev[u]-prev[l])) :
        ((prev[l]) >= 0 && (prev[l]) < 6 && (prev[u]) > 6) ? (prev[l], 6, prev, ((6-prev[l])/(prev[u]-prev[l]))*prev + ((prev[u]-6)*prev[l])/(prev[u]-prev[l]))) :
        ((prev[l]) < 0 && (prev[u]) > 6) ? (0, 6, 0, max(
            ((6-prev[l])/(prev[u]-prev[l]))*prev + ((prev[u]-6)*prev[l])/(prev[u]-prev[l]),
            ((prev[u])/(prev[u]-prev[l]))*prev - ((prev[u])*prev[l])/(prev[u]-prev[l])
        )) :
        (0, 6, 0, 6);
}

2025-07-02 17:20:51,805 - INFO - [STEP 1] Sample 3: Validation failed.
2025-07-02 17:20:51,805 - INFO - [STEP 1] All 3 samples failed validation. Retrying 10/10...
2025-07-02 17:20:51,805 - INFO - [Relu6] Runtime: 193.54 seconds
2025-07-02 17:20:51,805 - ERROR - Failed with Error:[STEP 1] Failed after 10 retries.
 during generating code:
transformer deeppoly{
    Relu6 ->
        ((prev[l]) >= 6) ? (6, 6, 6, 6) :
        ((prev[u]) <= 0) ? (0, 0, 0, 0) :
        ((prev[l]) >= 0 && (prev[u]) <= 6) ? (prev[l], prev[u], prev, prev) :
        ((prev[l]) < 0 && (prev[u]) > 0 && (prev[u]) <= 6) ? (0, prev[u], 0, ((prev[u])/(prev[u]-prev[l]))*prev - ((prev[u])*prev[l])/(prev[u]-prev[l])) :
        ((prev[l]) >= 0 && (prev[l]) < 6 && (prev[u]) > 6) ? (prev[l], 6, prev, ((6-prev[l])/(prev[u]-prev[l]))*prev + ((prev[u]-6)*prev[l])/(prev[u]-prev[l]))) :
        ((prev[l]) < 0 && (prev[u]) > 6) ? (0, 6, 0, max(
            ((6-prev[l])/(prev[u]-prev[l]))*prev + ((prev[u]-6)*prev[l])/(prev[u]-prev[l]),
            ((prev[u])/(prev[u]-prev[l]))*prev - ((prev[u])*prev[l])/(prev[u]-prev[l])
        )) :
        (0, 6, 0, 6);
}

2025-07-02 17:20:51,809 - INFO -  Total runtime for all operators: 1744.66 seconds
