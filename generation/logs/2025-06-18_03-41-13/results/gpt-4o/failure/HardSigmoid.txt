transformer deeppoly{
    HardSigmoid ->
        ((prev[u] <= -2)) ? (0, 0, 0, 0) :
        ((prev[l] >= 2)) ? (1, 1, 1, 1) :
        (((prev[l] >= -2) & (prev[u] <= 2))) ? (
            0.25 * prev[l] + 0.5,
            0.25 * prev[u] + 0.5,
            0.25 * prev + 0.5,
            0.25 * prev + 0.5
        ) :
        ( (prev[l] < -2) & (prev[u] > 2) ) ? (
            0,
            1,
            0,
            ((0.25 * (prev[u] - prev[l]) * prev) + (0.5 * (prev[u] - prev[l])) - (0.25 * prev[u] * prev[l])) / (prev[u] - prev[l])
        ) :
        ( (prev[l] < -2) & (prev[u] <= 2) ) ? (
            0,
            0.25 * prev[u] + 0.5,
            0,
            ( (0.25 * (prev[u] + 2) * prev) + 0.5 * (prev[u] + 2) - 0.25 * prev[u] * (-2) ) / (prev[u] + 2)
        ) :
        ( (prev[l] >= -2) & (prev[u] > 2) ) ? (
            0.25 * prev[l] + 0.5,
            1,
            0.25 * prev + 0.5,
            ( (0.25 * (2 - prev[l]) * prev) + 0.5 * (2 - prev[l]) - 0.25 * 2 * prev[l] ) / (2 - prev[l])
        ) :
        (0, 1, 0, 1);
}
