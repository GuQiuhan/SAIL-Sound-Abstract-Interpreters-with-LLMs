transformer deeppoly{
    HardSwish ->
        ((prev[l] >= 3) ? (prev[l], prev[u], prev, prev) :
        ((prev[u] <= -3) ? (0, 0, 0, 0) :
        (
            (l, u, L, U) where
            l = min(0, prev[l], (prev[u] + 3) * prev[u] / 6),
            u = max(0, prev[u], (prev[l] + 3) * prev[l] / 6),
            slope = (prev[u] - prev[l]) > 0 ? ((HardSwish(prev[u]) - HardSwish(prev[l])) / (prev[u] - prev[l])) : 0,
            bias = HardSwish(prev[l]) - slope * prev[l],
            L = slope * prev + bias,
            U = slope * prev + bias
        )
        ))
}
