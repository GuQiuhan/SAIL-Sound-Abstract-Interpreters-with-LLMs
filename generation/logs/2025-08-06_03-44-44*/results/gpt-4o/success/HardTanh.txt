transformer deeppoly{
    HardTanh ->
        ((prev[l] >= 1)) ?
            (1, 1, 1, 1)
        : ((prev[u] <= -1)) ?
            (-1, -1, -1, -1)
        : ((prev[l] >= -1) and (prev[u] <= 1)) ?
            (prev[l], prev[u], prev, prev)
        : ((prev[l] < -1) and (prev[u] > 1)) ?
            (-1, 1, ((prev - prev[l]) * (1 - (-1)) / (prev[u] - prev[l]) + (-1)), ((prev - prev[l]) * (1 - (-1)) / (prev[u] - prev[l]) + (-1)))
        : ((prev[l] < -1) and (prev[u] <= 1)) ?
            (-1, prev[u], -1, ((prev - prev[l]) * (1 - (-1)) / (prev[u] - prev[l]) + (-1)))
        : ((prev[l] >= -1) and (prev[u] > 1)) ?
            (prev[l], 1, prev, (1 - prev[u])/(prev[u] - prev[l]) * (prev - prev[l]) + 1)
        :
            (-1, 1, ((prev - prev[l]) * (1 - (-1)) / (prev[u] - prev[l]) + (-1)), ((prev - prev[l]) * (1 - (-1)) / (prev[u] - prev[l]) + (-1)));
}
