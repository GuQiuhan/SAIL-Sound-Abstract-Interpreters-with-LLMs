transformer deeppoly {
    HardTanh -> (
        (prev[l] >= 1) ? (1, 1, 1, 1) :
        (prev[u] <= -1) ? (-1, -1, -1, -1) :
        ((prev[l] >= -1) and (prev[u] <= 1)) ? (prev[l], prev[u], prev, prev) :
        ((prev[l] < -1) and (prev[u] > 1)) ? (-1, 1, prev * (2 / (prev[u] - prev[l])) - (2 * prev[l] / (prev[u] - prev[l])) - 1, prev * (2 / (prev[u] - prev[l])) - (2 * prev[l] / (prev[u] - prev[l])) - 1) :
        (prev[l] < -1) ? (-1, 1, prev * (1 / (prev[u] + 1)), prev * (1 / (prev[u] + 1))) :
        (0, 1, prev * (1 / (prev[u] - (-1))), prev * (1 / (prev[u] - (-1))))
    );
}
