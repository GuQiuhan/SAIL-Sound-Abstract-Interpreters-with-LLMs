transformer deepz{
    HardTanh -> ((prev[u] <= -1) ?
                    (-1, -1, -1) :
                    ((prev[l] >= 1) ?
                        (1, 1, 1) :
                        (max(-1, prev[l]), min(1, prev[u]), prev[z] * ((min(1, prev[u]) + max(-1, prev[l])) / 2))));
}
