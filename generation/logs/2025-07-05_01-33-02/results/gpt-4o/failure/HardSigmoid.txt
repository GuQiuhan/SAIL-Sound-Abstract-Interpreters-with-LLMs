transformer deeppoly{
    HardSigmoid ->
        (prev[l] >= 2) ? (1, 1, 1, 1)
        : (prev[u] <= -2) ? (0, 0, 0, 0)
        : (
            (prev[l] >= -2) ?
                (
                    0.25 * prev[l] + 0.5,
                    (prev[u] <= 2) ? (0.25 * prev[u] + 0.5) : 1,
                    0.25 * prev + 0.5,
                    (prev[u] <= 2) ? (0.25 * prev + 0.5) : ((prev - prev[l])/(prev[u] - prev[l]) + (prev[u] - prev)/(prev[u] - prev[l]) * (0.25 * prev[l] + 0.5))
                )
            : (
                (prev[u] <= 2) ?
                    (
                        0,
                        0.25 * prev[u] + 0.5,
                        ((prev - prev[u])/(prev[l] - prev[u]) * (0.25 * prev[u] + 0.5)),
                        0.25 * prev + 0.5
                    )
                : (
                    0,
                    1,
                    ((prev[u] * (prev - prev[l]))/((prev[u] - prev[l]))) / 2,
                    ((prev - prev[l])/(prev[u] - prev[l])) + ((prev[u] - prev)/(prev[u] - prev[l])) * 0
                )
            )
        );
}
