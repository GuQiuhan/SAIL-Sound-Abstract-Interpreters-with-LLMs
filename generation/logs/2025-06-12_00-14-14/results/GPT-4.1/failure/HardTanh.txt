transformer deeppoly{
    HardTanh(min_v, max_v) ->
        ((prev[u] <= min_v) ? (min_v, min_v, min_v, min_v) :
            (prev[l] >= max_v) ? (max_v, max_v, max_v, max_v) :
                (prev[l] >= min_v && prev[u] <= max_v) ? (prev[l], prev[u], prev, prev) :
                    (prev[l] < min_v && prev[u] > max_v) ? (min_v, max_v, min_v + (prev * (max_v - min_v) / (prev[u] - prev[l])), max_v + (prev * (max_v - min_v) / (prev[u] - prev[l]))) :
                        (prev[l] < min_v) ? (min_v, prev[u], min_v + ((prev * (prev[u] - min_v)) / (prev[u] - prev[l])), prev) :
                            (prev[u] > max_v) ? (prev[l], max_v, prev, max_v + ((prev * (max_v - prev[l])) / (prev[u] - prev[l]))) :
                                (prev[l], prev[u], prev, prev)
        );
}
