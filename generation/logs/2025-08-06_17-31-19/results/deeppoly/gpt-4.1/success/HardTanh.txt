transformer deeppoly{
    HardTanh ->
        ((prev[u]) <= -1) ? (-1, -1, -1, -1) :
        ((prev[l]) >= 1) ? (1, 1, 1, 1) :
        ((prev[l]) >= -1) and ((prev[u]) <= 1) ? (prev[l], prev[u], prev, prev) :
        ((prev[u]) > 1) and ((prev[l]) < -1) ? (-1, 1, ((prev - prev[l]) / (prev[u] - prev[l])) * 1 + ((prev[u] - prev) / (prev[u] - prev[l])) * -1, ((prev - prev[l]) / (prev[u] - prev[l])) * 1 + ((prev[u] - prev) / (prev[u] - prev[l])) * -1) :
        ((prev[l]) < -1) ? (-1, min(1, prev[u]), -1, ((prev - prev[l]) / (prev[u] - prev[l])) * min(1, prev[u]) + ((prev[u] - prev) / (prev[u] - prev[l])) * -1) :
        ((prev[u]) > 1) ? (max(-1, prev[l]), 1, ((prev - prev[l]) / (prev[u] - prev[l])) * 1 + ((prev[u] - prev) / (prev[u] - prev[l])) * max(-1, prev[l]), 1) :
        (prev[l], prev[u], prev, prev);
}
