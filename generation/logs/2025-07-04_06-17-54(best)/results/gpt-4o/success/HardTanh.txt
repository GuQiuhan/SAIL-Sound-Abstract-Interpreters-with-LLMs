transformer deeppoly{
    HardTanh ->
        (prev[u] <= -1) ?
            (-1, -1, -1, -1) :
        (prev[l] >= 1) ?
            (1, 1, 1, 1) :
        ((prev[l] >= -1) and (prev[u] <= 1)) ?
            (prev[l], prev[u], prev, prev) :
        ((prev[l] < -1) and (prev[u] <= 1)) ?
            (max(-1, prev[l]), prev[u], max(-1, prev[l]), prev[u]) :
        ((prev[l] >= -1) and (prev[u] > 1)) ?
            (prev[l], min(1, prev[u]), prev[l], min(1, prev[u])) :
        (-1, 1, max(-1, prev[l]), min(1, prev[u]))
    ;
}
