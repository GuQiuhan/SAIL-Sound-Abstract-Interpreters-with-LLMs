transformer deeppoly{
    HardTanh ->
        ((prev[l]) >= 1) ? (1, 1, 1, 1) :
        ((prev[u]) <= -1) ? (-1, -1, -1, -1) :
        (((prev[l]) >= -1) & ((prev[u]) <= 1)) ? (prev[l], prev[u], prev, prev) :
        ((prev[l]) < -1 & prev[u] > 1) ? (-1, 1, prev, prev) :
        ((prev[l]) < -1) ? (-1, prev[u], -1, prev) :
        ((prev[u]) > 1) ? (prev[l], 1, prev, 1) :
        (prev[l], prev[u], prev, prev);
}
