transformer deeppoly{
    HardSigmoid ->
        // Case 1: prev[u] <= -2.5, output constant 0
        (prev[u] <= -2.5) ? (
            0,
            0,
            0,
            0
        ) :
        // Case 2: prev[l] >= 2.5, output constant 1
        (prev[l] >= 2.5) ? (
            1,
            1,
            1,
            1
        ) :
        // Case 3: entire interval within the central linear region
        ((prev[l] >= -2.5) & (prev[u] <= 2.5)) ? (
            0.2 * prev[l] + 0.5,
            0.2 * prev[u] + 0.5,
            0.2 * prev + 0.5,
            0.2 * prev + 0.5
        ) :
        // Case 4: Mixed regions
        (
            max(0, 0.2 * prev[l] + 0.5),
            min(1, 0.2 * prev[u] + 0.5),
            max(0, min(1, 0.2 * prev + 0.5)),
            max(0, min(1, 0.2 * prev + 0.5))
        );
}